(()=>{var we={72278:y=>{(function(){function T(l){return l[0]}var g={Lexer:void 0,ParserRules:[{name:"main$ebnf$1",symbols:["messagePath"],postprocess:T},{name:"main$ebnf$1",symbols:[],postprocess:function(l){return null}},{name:"main$ebnf$2",symbols:["modifier"],postprocess:T},{name:"main$ebnf$2",symbols:[],postprocess:function(l){return null}},{name:"main",symbols:["topicName","main$ebnf$1","main$ebnf$2"],postprocess:l=>({topicName:l[0].value,topicNameRepr:l[0].repr,messagePath:l[1]||[],modifier:l[2]})},{name:"id$ebnf$1",symbols:[/[a-zA-Z0-9_-]/]},{name:"id$ebnf$1",symbols:["id$ebnf$1",/[a-zA-Z0-9_-]/],postprocess:function(f){return f[0].concat([f[1]])}},{name:"id",symbols:["id$ebnf$1"],postprocess:l=>l[0].join("")},{name:"integer$ebnf$1",symbols:[{literal:"-"}],postprocess:T},{name:"integer$ebnf$1",symbols:[],postprocess:function(l){return null}},{name:"integer$ebnf$2",symbols:[/[0-9]/]},{name:"integer$ebnf$2",symbols:["integer$ebnf$2",/[0-9]/],postprocess:function(f){return f[0].concat([f[1]])}},{name:"integer",symbols:["integer$ebnf$1","integer$ebnf$2"],postprocess:l=>({value:BigInt((l[0]??"")+l[1].join("")),repr:(l[0]??"")+l[1].join("")})},{name:"string$ebnf$1",symbols:[]},{name:"string$ebnf$1",symbols:["string$ebnf$1",/[^']/],postprocess:function(f){return f[0].concat([f[1]])}},{name:"string",symbols:[{literal:"'"},"string$ebnf$1",{literal:"'"}],postprocess:l=>({value:l[1].join(""),repr:`'${l[1].join("")}'`})},{name:"string$ebnf$2",symbols:[]},{name:"string$ebnf$2",symbols:["string$ebnf$2",/[^"]/],postprocess:function(f){return f[0].concat([f[1]])}},{name:"string",symbols:[{literal:'"'},"string$ebnf$2",{literal:'"'}],postprocess:l=>({value:l[1].join(""),repr:`"${l[1].join("")}"`})},{name:"variable$ebnf$1",symbols:["id"],postprocess:T},{name:"variable$ebnf$1",symbols:[],postprocess:function(l){return null}},{name:"variable",symbols:[{literal:"$"},"variable$ebnf$1"],postprocess:(l,f)=>({value:{variableName:l[1]||"",startLoc:f},repr:`$${l[1]||""}`})},{name:"value",symbols:["integer"],postprocess:l=>l[0]},{name:"value",symbols:["string"],postprocess:l=>l[0]},{name:"value$string$1",symbols:[{literal:"t"},{literal:"r"},{literal:"u"},{literal:"e"}],postprocess:function(f){return f.join("")}},{name:"value",symbols:["value$string$1"],postprocess:l=>({value:!0,repr:"true"})},{name:"value$string$2",symbols:[{literal:"f"},{literal:"a"},{literal:"l"},{literal:"s"},{literal:"e"}],postprocess:function(f){return f.join("")}},{name:"value",symbols:["value$string$2"],postprocess:l=>({value:!1,repr:"false"})},{name:"value",symbols:["variable"],postprocess:l=>l[0]},{name:"topicName$ebnf$1",symbols:["slashID"]},{name:"topicName$ebnf$1",symbols:["topicName$ebnf$1","slashID"],postprocess:function(f){return f[0].concat([f[1]])}},{name:"topicName",symbols:["topicName$ebnf$1"],postprocess:l=>({value:l[0].join(""),repr:l[0].join("")})},{name:"topicName$ebnf$2",symbols:[]},{name:"topicName$ebnf$2",symbols:["topicName$ebnf$2","slashID"],postprocess:function(f){return f[0].concat([f[1]])}},{name:"topicName",symbols:["id","topicName$ebnf$2"],postprocess:l=>({value:l[0]+l[1].join(""),repr:l[0]+l[1].join("")})},{name:"topicName",symbols:["quotedString"],postprocess:T},{name:"slashID$ebnf$1",symbols:["id"],postprocess:T},{name:"slashID$ebnf$1",symbols:[],postprocess:function(l){return null}},{name:"slashID",symbols:[{literal:"/"},"slashID$ebnf$1"],postprocess:l=>l.join("")},{name:"quotedString$ebnf$1",symbols:[]},{name:"quotedString$ebnf$1$subexpression$1",symbols:[/[^"\\]/]},{name:"quotedString$ebnf$1$subexpression$1$string$1",symbols:[{literal:"\\"},{literal:"\\"}],postprocess:function(f){return f.join("")}},{name:"quotedString$ebnf$1$subexpression$1",symbols:["quotedString$ebnf$1$subexpression$1$string$1"],postprocess:l=>"\\"},{name:"quotedString$ebnf$1$subexpression$1$string$2",symbols:[{literal:"\\"},{literal:'"'}],postprocess:function(f){return f.join("")}},{name:"quotedString$ebnf$1$subexpression$1",symbols:["quotedString$ebnf$1$subexpression$1$string$2"],postprocess:l=>'"'},{name:"quotedString$ebnf$1",symbols:["quotedString$ebnf$1","quotedString$ebnf$1$subexpression$1"],postprocess:function(f){return f[0].concat([f[1]])}},{name:"quotedString",symbols:[{literal:'"'},"quotedString$ebnf$1",{literal:'"'}],postprocess:l=>({value:l[1].join(""),repr:`"${l[1].join("").replace(/[\\"]/g,f=>`\\${f}`)}"`})},{name:"messagePath$ebnf$1",symbols:[]},{name:"messagePath$ebnf$1",symbols:["messagePath$ebnf$1","messagePathElement"],postprocess:function(f){return f[0].concat([f[1]])}},{name:"messagePath$ebnf$2",symbols:[{literal:"."}],postprocess:T},{name:"messagePath$ebnf$2",symbols:[],postprocess:function(l){return null}},{name:"messagePath",symbols:["messagePath$ebnf$1","messagePath$ebnf$2"],postprocess:l=>l[0].reduce((f,S)=>f.concat(S),[]).concat(l[1]?[{type:"name",name:"",repr:""}]:[])},{name:"messagePathElement$ebnf$1",symbols:["slice"],postprocess:T},{name:"messagePathElement$ebnf$1",symbols:[],postprocess:function(l){return null}},{name:"messagePathElement$ebnf$2",symbols:["filter"],postprocess:T},{name:"messagePathElement$ebnf$2",symbols:[],postprocess:function(l){return null}},{name:"messagePathElement",symbols:[{literal:"."},"name","messagePathElement$ebnf$1","messagePathElement$ebnf$2"],postprocess:l=>[l[1],l[2],l[3]].filter(f=>f!==null)},{name:"messagePathElement",symbols:["filter"],postprocess:T},{name:"name",symbols:["id"],postprocess:l=>({type:"name",name:l[0],repr:l[0]})},{name:"name",symbols:["quotedString"],postprocess:l=>({type:"name",name:l[0].value,repr:l[0].repr})},{name:"sliceVal",symbols:["integer"],postprocess:l=>Number(l[0].value)},{name:"sliceVal",symbols:["variable"],postprocess:l=>l[0].value},{name:"slice",symbols:[{literal:"["},"sliceVal",{literal:"]"}],postprocess:l=>({type:"slice",start:l[1],end:l[1]})},{name:"slice$ebnf$1",symbols:["sliceVal"],postprocess:T},{name:"slice$ebnf$1",symbols:[],postprocess:function(l){return null}},{name:"slice$ebnf$2",symbols:["sliceVal"],postprocess:T},{name:"slice$ebnf$2",symbols:[],postprocess:function(l){return null}},{name:"slice",symbols:[{literal:"["},"slice$ebnf$1",{literal:":"},"slice$ebnf$2",{literal:"]"}],postprocess:l=>({type:"slice",start:l[1]===null?0:l[1],end:l[3]===null?1/0:l[3]})},{name:"simplePath$ebnf$1",symbols:[]},{name:"simplePath$ebnf$1$subexpression$1",symbols:[{literal:"."},"id"]},{name:"simplePath$ebnf$1",symbols:["simplePath$ebnf$1","simplePath$ebnf$1$subexpression$1"],postprocess:function(f){return f[0].concat([f[1]])}},{name:"simplePath",symbols:["id","simplePath$ebnf$1"],postprocess:l=>[l[0]].concat(l[1].map(f=>f[1]))},{name:"filter$ebnf$1",symbols:["simplePath"],postprocess:T},{name:"filter$ebnf$1",symbols:[],postprocess:function(l){return null}},{name:"filter",symbols:[{literal:"{"},"filter$ebnf$1",{literal:"}"}],postprocess:(l,f)=>({type:"filter",path:l[1]||[],value:void 0,nameLoc:f+1,valueLoc:f+1,repr:(l[1]||[]).join(".")})},{name:"filter$ebnf$2",symbols:["simplePath"],postprocess:T},{name:"filter$ebnf$2",symbols:[],postprocess:function(l){return null}},{name:"filter$string$1",symbols:[{literal:"="},{literal:"="}],postprocess:function(f){return f.join("")}},{name:"filter",symbols:[{literal:"{"},"filter$ebnf$2","filter$string$1","value",{literal:"}"}],postprocess:(l,f)=>({type:"filter",path:l[1]||[],value:l[3].value,nameLoc:f+1,valueLoc:f+1+(l[1]||[]).join(".").length+l[2].length,repr:`${(l[1]||[]).join(".")}==${l[3].repr}`})},{name:"modifier$string$1",symbols:[{literal:"."},{literal:"@"}],postprocess:function(f){return f.join("")}},{name:"modifier$ebnf$1",symbols:["id"],postprocess:T},{name:"modifier$ebnf$1",symbols:[],postprocess:function(l){return null}},{name:"modifier",symbols:["modifier$string$1","modifier$ebnf$1"],postprocess:l=>l[1]||""}],ParserStart:"main"};typeof y.exports<"u"?y.exports=g:window.grammar=g})()},59362:(y,T,g)=>{"use strict";var l=g(90758),f=g(96389),S=g(44668);function R(e){return f.zGw(f.UID(t=>t.x.length),f.Smz)(e)}function*O(e){let t=0;for(const n of e){if(n==null){t++;continue}const{x:s,y:r,label:o}=n;yield{index:t,x:s,y:r,label:o},t++}}function*N(e){const t={index:0,label:void 0};let n=0;for(const s of e){const r=f.YMb(f.VO0(s));if(r!=null)for(let o=0;o<r.length;o++){for(const a of f.XPQ(s))t[a]=s[a]?.[o];t.index=n,n++,yield t}}}function V(e,t){let n=t;for(let s=0;s<e.length;s++){const r=e[s];if(r==null)continue;const{x:{length:o}}=r;if(n===o&&s===e.length-1)return[s,n];if(n>=o){n-=o;continue}return[s,n]}}var A=g(76635),Ie=g(43614),dt=g(72278),mt=g.n(dt);const se=Ie.Grammar.fromCompiled(mt());function pt(e){return e.match(/^[a-zA-Z0-9_/-]+$/)?e:`"${e.replace(/[\\"]/g,t=>`\\${t}`)}"`}function Ps(e){return e.match(/^[a-zA-Z0-9_-]+$/)?e:`"${e.replace(/[\\"]/g,t=>`\\${t}`)}"`}const re=(0,A.memoize)(e=>{const t=new Ie.Parser(se);try{return t.feed(e).results[0]}catch{return}});var bt=g(71747);const Ne=(0,bt.Z)({insensitive:!0});function Ms(e){return e==null?Ne:(t,n)=>Ne(t[e],n[e])}const ws=null,gt=Object.keys({bool:void 0,int8:void 0,uint8:void 0,int16:void 0,uint16:void 0,int32:void 0,uint32:void 0,int64:void 0,uint64:void 0,float32:void 0,float64:void 0,string:void 0}),ht=null;function yt(e){return gt.includes(e)}function vt(e){return e.structureType==="primitive"&&ht.includes(e.primitiveType)}function xt(e){const t=(0,A.memoize)((s,r)=>{const o={},a=e.get(s);if(!a){if(s==="time"||s==="duration")return{structureType:"message",nextByName:{sec:{structureType:"primitive",primitiveType:"uint32",datatype:""},nsec:{structureType:"primitive",primitiveType:"uint32",datatype:""}},datatype:s};throw new Error(`datatype not found: "${s}"`)}for(const c of a.definitions){if(c.isConstant===!0||r.includes(c.type))continue;const i=yt(c.type)?{structureType:"primitive",primitiveType:c.type,datatype:s}:t(c.type,[...r,c.type]);c.isArray===!0?o[c.name]={structureType:"array",next:i,datatype:s}:o[c.name]=i}return{structureType:"message",nextByName:o,datatype:s}}),n={};for(const[s]of e)n[s]=t(s,[]);return n}function Tt(e,t){return!!e&&(!t||t.includes(e.structureType)||t.includes(e.datatype)||e.structureType==="primitive"&&t.includes(e.primitiveType))}function Is(e,{validTypes:t,noMultiSlices:n,messagePath:s=[]}={}){let r=[...s];const o=[];function a(c,i){if(Tt(c,t)&&o.push(i),c.structureType==="message")for(const[u,d]of Object.entries(c.nextByName))a(d,`${i}.${quoteFieldNameIfNeeded(u)}`);else if(c.structureType==="array")if(c.next.structureType==="message"){const u=Object.entries(c.next.nextByName).find(([d])=>isTypicalFilterName(d));if(u){const[d,m]=u,p=r.find(b=>b.type==="filter"&&b.path[0]===d);p?(r=r.filter(b=>b!==p),a(c.next,`${i}[:]{${d}==${typeof p.value=="object"?`$${p.value.variableName}`:p.value}}`)):vt(m)?a(c.next,`${i}[:]{${d}==0}`):a(c.next,`${i}[0]`)}else a(c.next,`${i}[0]`)}else n!==!0?a(c.next,`${i}[:]`):a(c.next,`${i}[0]`)}return a(e,""),o.sort(naturalSort())}const Ns=(e,t)=>{let n=e;if(!n)return{valid:!1,msgPathPart:void 0,structureItem:void 0};for(const s of t){if(!n)return{valid:!1,msgPathPart:s,structureItem:n};if(s.type==="name"){if(n.structureType!=="message")return{valid:!1,msgPathPart:s,structureItem:n};n=n.nextByName[s.name]}else if(s.type==="slice"){if(n.structureType!=="array")return{valid:!1,msgPathPart:s,structureItem:n};n=n.next}else if(s.type==="filter"){if(n.structureType!=="message"||s.path.length===0||s.value==null)return{valid:!1,msgPathPart:s,structureItem:n};let r=n;for(const o of s.path){if(r.structureType!=="message")return{valid:!1,msgPathPart:s,structureItem:n};if(r=r.nextByName[o],r==null)return{valid:!1,msgPathPart:s,structureItem:n}}}else assertNever(s,`Invalid msgPathPart.type: ${s.type}`)}return{valid:!0,msgPathPart:void 0,structureItem:n}};var oe=g(2784),Cs=g(88665);function Ds(e,{initiallyTrue:t}){const n=useRef(t?void 0:e),s=!shallowequal(n.current,e);return n.current=e,s}function Rs(e){const t=useRef(e);return isEqual(e,t.current)?t.current:(t.current=e,e)}function Ls(e,t){const n=useContext(e);if(n==null)throw new Error(`useGuaranteedContext got null for contextType${t!=null?`: '${t}'`:""}`);return n}const K=new Map,D=()=>{};class J{static default=new J("");#e;constructor(t){this.#e=t,this.setLevel("debug"),K.set(t,this)}name(){return this.#e}isLevelOn(t){switch(t){case"debug":return this.debug!==D;case"info":return this.info!==D;case"warn":return this.warn!==D;case"error":return this.error!==D}return!1}getLevel(){return this.debug!==D?"debug":this.info!==D?"info":this.warn!==D?"warn":"error"}setLevel(t){switch(this.debug=D,this.info=D,this.warn=D,this.error=D,t){case"debug":this.debug=console.debug.bind(g.g.console),this.info=console.info.bind(g.g.console),this.warn=console.warn.bind(g.g.console),this.error=console.error.bind(g.g.console);break;case"info":this.info=console.info.bind(g.g.console),this.warn=console.warn.bind(g.g.console),this.error=console.error.bind(g.g.console);break;case"warn":this.warn=console.warn.bind(g.g.console),this.error=console.error.bind(g.g.console);break;case"error":this.error=console.error.bind(g.g.console);break}}debug(...t){}info(...t){}warn(...t){}error(...t){}getLogger(t){const n=t.replace(/^.+\.(asar|webpack)[\\/\\]/,"").replace(/^(\.\.\/)+/,""),s=this.#e.length>0?`${this.#e}.${n}`:n,r=K.get(s);if(r)return r;const o=new J(s);return K.set(s,o),o}channels(){return Array.from(K.values())}}function ks(e){switch(e){case"debug":return"debug";case"info":return"info";case"warn":return"warn";case"error":return"error";default:return"warn"}}const L=J.default;var $t="../../packages/hooks/src/useMustNotChange.ts";const Pt=L.getLogger($t),As=e=>{const t=useRef(e);t.current!==e&&Pt.error("Value must not change",t.current),t.current=e},Fs=()=>{},Bs=null,Os=null;function Vs(e){const[t,n]=useState(void 0);return useCallback((...s)=>{try{return e(...s)}catch(r){n(()=>{throw r})}},[e])}function _s(e){const t=useRef(e);return shallowequal(e,t.current)?t.current:(t.current=e,e)}var St="../../packages/hooks/src/useValueChangedDebugLog.ts";const Mt=L.getLogger(St),js=()=>{};function Gs(e,t){const n=useRef(e);n.current!==e&&Mt.debug(`value changed: ${t}`),useLayoutEffect(()=>{n.current=e})}const zs=null,Us=null;function Ws(){const[e,t]=useState(document.visibilityState);return useEffect(()=>{t(document.visibilityState);const n=()=>{t(document.visibilityState)};return document.addEventListener("visibilitychange",n),()=>{document.removeEventListener("visibilitychange",n)}},[]),e}var wt="../../packages/hooks/src/useWarnImmediateReRender.ts";const Hs=L.getLogger(wt),Ys=null,qs=null;var Et="../../packages/hooks/src/useMemoryInfo.ts";const It=L.getLogger(Et);function Xs(e){const{refreshIntervalMs:t}=e,[n,s]=useState(window.performance.memory);return useEffect(()=>{if(!window.performance.memory){It.info("No memory information available");return}const r=setInterval(()=>{s(window.performance.memory)},t);return()=>{clearInterval(r)}},[t]),n}var Nt="../../packages/hooks/src/selectWithUnstableIdentityWarning.ts";const Zs=L.getLogger(Nt);function Ks(e,t){return t(e)}function Ct(e,t){throw t}function Js(){const[e,t]=useReducer(Ct,void 0);return t}function Qs(e){const[t,n]=useState(sessionStorage.getItem(e)??void 0),s=useCallback(o=>{o?(sessionStorage.setItem(e,o),window.dispatchEvent(new StorageEvent("storage",{key:e,newValue:o,storageArea:sessionStorage}))):(sessionStorage.removeItem(e),window.dispatchEvent(new StorageEvent("storage",{key:e,newValue:void 0,storageArea:sessionStorage})))},[e]),r=useCallback(o=>{o.key===e&&n(o.newValue??void 0)},[e]);return useEffect(()=>(window.addEventListener("storage",r),()=>{window.removeEventListener("storage",r)}),[r]),[t??void 0,s]}function er(){const e=useRef(!1),t=useCallback(()=>e.current,[]);return useLayoutEffect(()=>(e.current=!0,()=>{e.current=!1}),[]),t}var tr=g(52322),Ce;(function(e){e.COLOR_SCHEME="colorScheme",e.TIMEZONE="timezone",e.TIME_FORMAT="time.format",e.MESSAGE_RATE="messageRate",e.UPDATES_ENABLED="updates.enabled",e.LANGUAGE="language",e.ROS_PACKAGE_PATH="ros.ros_package_path",e.TELEMETRY_ENABLED="telemetry.telemetryEnabled",e.CRASH_REPORTING_ENABLED="telemetry.crashReportingEnabled",e.SHOW_DEBUG_PANELS="showDebugPanels",e.HIDE_SIGN_IN_PROMPT="hideSignInPrompt",e.LAUNCH_PREFERENCE="launchPreference",e.SHOW_OPEN_DIALOG_ON_STARTUP="ui.open-dialog-startup",e.ENABLE_LAYOUT_DEBUGGING="enableLayoutDebugging",e.ENABLE_MEMORY_USE_INDICATOR="dev.memory-use-indicator"})(Ce||(Ce={}));const De=(0,oe.createContext)(void 0);De.displayName="AppConfigurationContext";function nr(){const e=useContext(De);if(!e)throw new Error("An AppConfigurationContext provider is required to useAppConfiguration");return e}const sr=null;function rr(e){const t=useAppConfiguration(),[n,s]=useState(()=>{const o=t.get(e);if(!(typeof o=="string"&&o.length===0))return o});useEffect(()=>{const o=a=>{s(a)};return t.addChangeListener(e,o),()=>{t.removeChangeListener(e,o)}},[e,t]);const r=useCallback(async o=>{s(o),await t.set(e,o)},[t,e]);return[n,r]}function Dt(e){return e.sec<0||e.nsec<0?(L.error("Times are not allowed to be negative"),"(invalid negative time)"):`${e.sec}.${e.nsec.toFixed().padStart(9,"0")}`}const Rt=null;function or(e){return e.sec>Rt}function ar({sec:e,nsec:t}){return`${e}.${String.prototype.padStart.call(t,9,"0")}`}function ir(e,t){return t==="headerStamp"?Re(e.message):e.receiveTime}function Re(e){if(e.header!=null){const t=e.header?.stamp;if(t!=null&&"sec"in t&&"nsec"in t)return t}else if(e.markers?.[0]?.header!=null){const t=e.markers[0]?.header.stamp;if(t!=null&&"sec"in t&&"nsec"in t)return t}}var Lt="../../packages/studio-base/src/components/MessagePipeline/MessageOrderTracker.ts";const kt=1,At=1,Ft=L.getLogger(Lt);class cr{#e=[];#r;#n;#o;#a;#t;#i=!1;#s=[];update(t){if(!t.activeData)return[];const n=[],{messages:s,currentTime:r,lastSeekTime:o}=t.activeData;let a=!1;if(this.#a!==o&&(this.#a=o,this.#t&&(clearTimeout(this.#t),this.#t=void 0,this.#s=[]),this.#t=this.#n=this.#r=void 0,this.#e=[],a=!0),this.#e!==s||this.#r!==r){this.#e=s,this.#r=r;for(const c of s){const i=c.receiveTime;if(a||Math.abs(toSec(subtractTimes(i,r)))>kt&&(this.#i&&this.#s.push(c),this.#t||(this.#t=setTimeout(()=>{this.#t=void 0;const d={currentTime:r,lastSeekTime:o,messageTime:i,incorrectMessages:this.#i?this.#s:"not being tracked"};this.#s=[],Ft.warn("Message receiveTime very different from player.currentTime; without updating lastSeekTime",d)},At*1e3))),this.#n&&this.#o!=null&&isLessThan(i,this.#n)){const u=formatFrame(i),d=formatFrame(this.#n),m=`Processed a message on ${c.topic} at ${u} which is earlier than last processed message on ${this.#o} at ${d}.`;n.push({severity:"warn",message:"Data went back in time",error:new Error(m)})}this.#o=c.topic,this.#n=i}}return n}}const ur=null;var lr=g(79044);class fr{value;#e=new Mutex;constructor(t){this.value=t}async runExclusive(t){return await this.#e.runExclusive(async()=>await t(this.value))}}const Le=g.g;function Bt(e){Le.foxgloveStudioReportErrorFn?.(e)}function dr(e){Le.foxgloveStudioReportErrorFn=e}class Ot extends Error{details;extraInfo;message;constructor(t,n){if(super(),this.details=t,this.extraInfo=n,this.name="AppError",this.message="",t instanceof Error?this.message=t.stack??t.message:typeof t=="string"&&(this.message=t),n!=null)if(n.componentStack!=null)this.message+=`

${n.componentStack}`;else try{const s=JSON.stringify(n);this.message+=`

${s}`}catch{this.message+=`

[ Either cyclic object or object with BigInt(s) ]`}this.message===""&&(this.message="Unknown Error")}}const Vt=()=>typeof g.g.postMessage<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope,mr=()=>typeof SharedWorkerGlobalScope<"u"&&self instanceof SharedWorkerGlobalScope,pr=e=>{const t=typeof fetch<"u"&&fetch("data:test").then(()=>!0).catch(()=>!1);return async(...n)=>{if(await t)throw new Error("Content security policy too loose.");return e(...n)}},Q=(e,t,n,s)=>{if(Vt()){(s==="error"?console.error:s==="warn"?console.warn:console.info)("Web Worker has uninitialized sendNotification function; this means this error message cannot show up in the UI (so we show it here in the console instead).",e,t,n);return}console.error("Notification before error display is mounted",e,t,n)};let G=Q;function br(e){if(G!==Q)throw new Error("Tried to overwrite existing NotificationHandler");G=e}function gr(){if(G===Q)throw new Error("Tried to unset NotificationHandler but it was already the default");G=Q}function _t(e,t,n,s){n==="app"&&(s==="warn"||s==="error")&&Bt(new Ot(t,e)),G(e,t,n,s)}_t.expectCalledDuringTest=()=>{throw new Error("Should be overriden in setupTestFramework.ts")};const jt=5e3;async function hr(e){try{await promiseTimeout(Promise.all(e.map(async({promise:t})=>{await t})),jt)}catch(t){if(!(t instanceof PromiseTimeoutError)){sendNotification("Player ",t,"app","error");return}}}function yr(){return moize(e=>e,{isDeepEqual:!0,maxSize:1/0})}function vr(e){const t=new Map,n=new Map;for(const s of e){const r=s.preloadType==="full"?t:n,o=r.get(s.topic);if(o){if(o.fields!=null)if(s.fields==null)r.set(s.topic,s);else{const a=filterMap(s.fields,c=>{const i=c.trim();return i.length>0?i:void 0});a.length>0&&r.set(s.topic,{...s,fields:union(o.fields,a)})}}else(s.fields==null||s.fields.some(c=>c.trim().length>0))&&r.set(s.topic,s)}return[...t.values(),...n.values()]}var ke;(function(e){e.NOT_PRESENT="NOT_PRESENT",e.INITIALIZING="INITIALIZING",e.RECONNECTING="RECONNECTING",e.BUFFERING="BUFFERING",e.PRESENT="PRESENT",e.ERROR="ERROR"})(ke||(ke={}));const xr={advertise:"advertise",assets:"assets",callServices:"callServices",setSpeed:"setSpeed",playbackControl:"playbackControl",getParameters:"getParameters",setParameters:"setParameters"};function Ae(){return{presence:PlayerPresence.NOT_PRESENT,progress:{},capabilities:[],profile:void 0,playerId:"",activeData:void 0}}function Tr({promisesToWaitForRef:e,initialPlayer:t}){return createStore((n,s)=>({player:t,publishersById:{},allPublishers:[],subscriptionMemoizer:makeSubscriptionMemoizer(),subscriptionsById:new Map,subscriberIdsByTopic:new Map,newTopicsBySubscriberId:new Map,lastMessageEventByTopic:new Map,lastCapabilities:[],dispatch(r){n(o=>Ut(o,r))},reset(){n(r=>({...r,publishersById:{},allPublishers:[],subscriptionMemoizer:makeSubscriptionMemoizer(),subscriptionsById:new Map,subscriberIdsByTopic:new Map,newTopicsBySubscriberId:new Map,lastMessageEventByTopic:new Map,lastCapabilities:[],public:{...r.public,playerState:Ae(),messageEventsBySubscriberId:new Map,subscriptions:[],sortedTopics:[],datatypes:new Map,startPlayback:void 0,playUntil:void 0,pausePlayback:void 0,setPlaybackSpeed:void 0,seekPlayback:void 0}}))},public:{playerState:Ae(),messageEventsBySubscriberId:new Map,subscriptions:[],sortedTopics:[],datatypes:new Map,setSubscriptions(r,o){s().dispatch({type:"update-subscriber",id:r,payloads:o})},setPublishers(r,o){s().dispatch({type:"set-publishers",id:r,payloads:o}),s().player?.setPublishers(s().allPublishers)},setParameter(r,o){s().player?.setParameter(r,o)},publish(r){s().player?.publish(r)},async callService(r,o){const a=s().player;if(!a)throw new Error("callService called when player is not present");return await a.callService(r,o)},async fetchAsset(r,o){const{protocol:a}=new URL(r),c=s().player;if(c?.fetchAsset&&a==="package:")try{return await c.fetchAsset(r)}catch(u){if(!isDesktopApp())throw u}const i=await fetch(r,o);if(!i.ok){const u=i.statusText;throw new Error(`Error ${i.status}${u?` (${u})`:""}`)}return{uri:r,data:new Uint8Array(await i.arrayBuffer()),mediaType:i.headers.get("content-type")??void 0}},startPlayback:void 0,playUntil:void 0,pausePlayback:void 0,setPlaybackSpeed:void 0,seekPlayback:void 0,pauseFrame(r){const o=new Condvar;return e.current.push({name:r,promise:o.wait()}),()=>{o.notifyAll()}}}}))}function Gt(e,t){const n=e.subscriptionsById,s=new Map(e.newTopicsBySubscriberId),r=s.get(t.id);if(r){const i=n.get(t.id),u=new Set(i?.map(d=>d.topic)??[]);for(const{topic:d}of t.payloads)u.has(d)||r.add(d)}else{const i=t.payloads.map(u=>u.topic);s.set(t.id,new Set(i))}const o=new Map(n);t.payloads.length===0?o.delete(t.id):o.set(t.id,t.payloads);const a=new Map;for(const[i,u]of o)for(const d of u){const m=d.topic,p=a.get(m)??[];p.push(i),a.set(m,p)}const c=mergeSubscriptions(Array.from(o.values()).flat());return{...e,subscriptionsById:o,subscriberIdsByTopic:a,newTopicsBySubscriberId:s,public:{...e.public,subscriptions:c}}}function zt(e,t){const n=t.playerState.activeData?.messages,s=new Set,r=new Map,o=e.subscriptionsById,a=e.subscriberIdsByTopic,c=e.lastMessageEventByTopic,i=new Map(e.newTopicsBySubscriberId);if(n&&n!==e.public.playerState.activeData?.messages)for(const b of n){c.set(b.topic,b),s.add(b.topic);const x=a.get(b.topic);if(x)for(const h of x){let v=r.get(h);v||(v=[],r.set(h,v)),v.push(b)}}for(const b of o.keys()){const x=i.get(b);if(x){for(const h of x){if(s.has(h))continue;const v=c.get(h);if(v){const $=r.get(b)??[];$.unshift(v),r.set(b,$)}}x.clear()}}const u={...e.public,playerState:t.playerState,messageEventsBySubscriberId:r},d=t.playerState.activeData?.topics;d!==e.public.playerState.activeData?.topics&&(u.sortedTopics=d?[...d].sort((b,x)=>b.name.localeCompare(x.name)):[]),t.playerState.activeData?.datatypes!==e.public.playerState.activeData?.datatypes&&(u.datatypes=t.playerState.activeData?.datatypes??new Map);const m=t.playerState.capabilities,p=e.player;return p&&!shallowequal(m,e.lastCapabilities)&&(u.startPlayback=m.includes(PlayerCapabilities.playbackControl)?p.startPlayback?.bind(p):void 0,u.playUntil=m.includes(PlayerCapabilities.playbackControl)?p.playUntil?.bind(p):void 0,u.pausePlayback=m.includes(PlayerCapabilities.playbackControl)?p.pausePlayback?.bind(p):void 0,u.setPlaybackSpeed=m.includes(PlayerCapabilities.setSpeed)?p.setPlaybackSpeed?.bind(p):void 0,u.seekPlayback=m.includes(PlayerCapabilities.playbackControl)?p.seekPlayback?.bind(p):void 0),{...e,newTopicsBySubscriberId:i,renderDone:t.renderDone,public:u,lastCapabilities:m,lastMessageEventByTopic:c}}function Ut(e,t){switch(t.type){case"update-player-state":return zt(e,t);case"update-subscriber":return Gt(e,t);case"set-publishers":{const n={...e.publishersById,[t.id]:t.payloads};return{...e,publishersById:n,allPublishers:flatten(Object.values(n))}}}assertNever(t,`Unhandled message pipeline action type ${t.type}`)}const ae=(0,oe.createContext)(void 0);function $r(){const e=useGuaranteedContext(ae);return useCallback(()=>e.getState().public,[e])}function Pr(e){const t=useGuaranteedContext(ae);return useStore(t,useCallback(n=>e(n.public),[e]))}const Wt=e=>e.renderDone,Ht=e=>e.public.subscriptions;function Sr({children:e,player:t,globalVariables:n}){const s=useRef([]),r=useMemo(()=>createMessagePipelineStore({promisesToWaitForRef:s,initialPlayer:t}),[t]),o=useStore(r,Ht),a=useMemo(()=>debounce(d=>{t?.setSubscriptions(d)}),[t]);useEffect(()=>()=>{a.cancel()},[a]),useEffect(()=>a(o),[a,o]);const[c]=useAppConfigurationValue(AppSetting.MESSAGE_RATE),i=useStore(r,Wt);useLayoutEffect(()=>{i?.()},[i]);const u=useRef(16);return u.current=1e3/(c??60),useEffect(()=>{const d=r.getState().dispatch;if(!t){d({type:"update-player-state",playerState:defaultPlayerState(),renderDone:void 0});return}const{listener:m,cleanupListener:p}=qt({msPerFrameRef:u,promisesToWaitForRef:s,store:r});return t.setListener(m),()=>{p(),t.close(),d({type:"update-player-state",playerState:defaultPlayerState(),renderDone:void 0})}},[t,r]),useEffect(()=>{t?.setGlobalVariables(n)},[t,n]),_jsx(ae.Provider,{value:r,children:e})}function Yt(e,t){return t.length===0?e:{...e,problems:t.concat(e.problems??[])}}function qt(e){const{msPerFrameRef:t,promisesToWaitForRef:n,store:s}=e,r=s.getState().dispatch,o=new MessageOrderTracker;let a=!1,c,i;return{listener:async d=>{if(a)return;if(i)throw new Error("New playerState was emitted before last playerState was rendered.");const m=o.update(d),p=Yt(d,m),b=new Promise($=>{i=()=>{i=void 0,$()}}),x=Date.now();let h=!1;function v(){if(h)return;h=!0;const $=Date.now()-x,w=Math.max(0,t.current-$);setTimeout(async()=>{if(a)return;const E=n.current;E.length>0&&(n.current=[],await pauseFrameForPromises(E)),i&&i()},w)}c!=null&&d.playerId!==c&&s.getState().reset(),c=d.playerId,r({type:"update-player-state",playerState:p,renderDone:v}),await b},cleanupListener(){a=!0,i=void 0}}}function Xt(e){return e.datatypes}function Zt(e){return e.sortedTopics}function Kt(e){return e.playerState.activeData?.startTime}function Jt(e){return e.playerState.capabilities}function Qt(e){return e.playerState.playerId}function Mr(){const e=useMessagePipeline(Xt),t=useMessagePipeline(Zt),n=useMessagePipeline(Kt),s=useMessagePipeline(Jt),r=useMessagePipeline(Qt);return useMemo(()=>({topics:t,datatypes:e,capabilities:s,startTime:n,playerId:r}),[s,e,r,n,t])}function wr(e,t){const n=useRef(e),s=useRef(e),r=useRef(Date.now());return e!==n.current&&n.current!==s.current&&Date.now()-r.current<200&&t(),s.current=n.current,n.current=e,r.current=Date.now(),e}var en="../../packages/studio-base/src/PanelAPI/useMessageReducer.ts";const ie=L.getLogger(en);function tn(e){return e.setSubscriptions}function Er(e){const[t]=useState(()=>uuidv4()),{restore:n,addMessage:s,addMessages:r,preloadType:o="partial"}=e;if([e.addMessage,e.addMessages].filter(Boolean).length!==1)throw new Error("useMessageReducer must be provided with exactly one of addMessage or addMessages");useShouldNotChangeOften(e.restore,()=>{ie.warn("useMessageReducer restore() is changing frequently. restore() will be called each time it changes, so a new function shouldn't be created on each render. (If you're using Hooks, try useCallback.)")}),useShouldNotChangeOften(e.addMessage,()=>{ie.warn("useMessageReducer addMessage() is changing frequently. addMessage() will be called each time it changes, so a new function shouldn't be created on each render. (If you're using Hooks, try useCallback.)")}),useShouldNotChangeOften(e.addMessages,()=>{ie.warn("useMessageReducer addMessages() is changing frequently. addMessages() will be called each time it changes, so a new function shouldn't be created on each render. (If you're using Hooks, try useCallback.)")});const a=useShallowMemo(e.topics),c=useMemo(()=>a.map(d=>typeof d=="string"?{topic:d,preloadType:o}:d),[o,a]),i=useMessagePipeline(tn);useEffect(()=>{i(t,c)},[t,i,c]),useEffect(()=>()=>{i(t,[])},[t,i]);const u=useRef();return useMessagePipeline(useCallback(function(m){const p=m.messageEventsBySubscriberId.get(t),b=m.playerState.activeData?.lastSeekTime;let x;if(!u.current||b!==u.current.lastSeekTime?x=n(void 0):n!==u.current.restore||s!==u.current.addMessage||r!==u.current.addMessages?x=n(u.current.reducedValue):x=u.current.reducedValue,p&&p.length>0&&p!==u.current?.messageEvents){if(r)p.length>0&&(x=r(x,p));else if(s)for(const h of p)x=s(x,h)}return u.current={messageEvents:p,lastSeekTime:b,reducedValue:x,restore:n,addMessage:s,addMessages:r},u.current.reducedValue},[t,s,r,n]))}function Ir(e){const{historySize:t,topics:n}=e,s=useDeepMemo(n),r=useCallback((a,c)=>{const i=groupBy(c,"topic"),u={...a};return Object.entries(i).forEach(([d,m])=>{const p=u[d];p&&(u[d]=concatAndTruncate(p,m,t))}),u},[t]),o=useCallback(a=>{const c={};for(const i of s){const u=typeof i=="string"?i:i.topic,d=a?.[u];c[u]=d?.slice(-t)??[]}return c},[s,t]);return useMessageReducer({topics:s,restore:o,addMessages:r})}var nn=g(5817),sn=g.n(nn);const rn=sn()((e,t)=>{if(!e)return{};const n={};for(const s of t){const r=typeof s=="string"?s:s.topic,o=e.messagesByTopic[r];o&&(n[r]=o)}return n}),on=e=>{const[t]=useState(()=>uuidv4()),n=useMessagePipeline(useCallback(({setSubscriptions:s})=>s,[]));useEffect(()=>{n(t,e)},[t,n,e]),useEffect(()=>()=>{n(t,[])},[t,n])};function Nr(e){const t=useMemo(()=>e.map(r=>r.topic),[e]);on(e);const n=useMessagePipeline(useCallback(r=>r.playerState.progress.messageCache?.blocks,[]));return useMemo(()=>n?n.map(r=>rn(r,t)):[],[n,t])}var an="../../packages/studio-base/src/util/layout.ts";const Fe=L.getLogger(an),Cr="foxglovePanelTitle";function Be(e){const n=Math.round(Math.random()*1e10).toString(36);return`${e}!${n}`}function ce(e){return e.split("!")[0]??""}function ee(e){return ce(e)===TAB_PANEL_TYPE}function Dr(e){return e!=null&&"tabs"in e&&"activeTabIdx"in e}function ue(e,t,n=[]){if(t===e)return n;if(t!=null&&isParent(t)){const s=ue(e,t.first,[...n,"first"]);if(s.length>0)return s;const r=ue(e,t.second,[...n,"second"]);if(r.length>0)return r}return[]}function cn(e){const t={};for(const n of e)t[n]=Be(ce(n));return t}function Oe(e,t){if(typeof e=="string")return t[e]??Be(ce(e));if(e==null)return;const n={};for(const s in e)typeof e[s]=="object"&&!Array.isArray(e[s])?n[s]=Oe(e[s],t):typeof e[s]=="string"&&t[e[s]]!=null?n[s]=t[e[s]]:n[s]=e[s];return n}function Ve(e){if(typeof e=="string")return e;const t=[e.first,e.second].filter(Boolean).map(Ve),[n,s]=t;return n==null&&s==null?"":n!=null&&s!=null?{...e,first:n,second:s}:{...e,first:n??s??"",second:""}}function le(e,t){return typeof e=="string"?t(e):{...e,first:le(e.first,t),second:le(e.second,t)}}function un(e,t,n){const s=le(e,r=>{if(typeof r=="string"&&ee(r)&&!n.includes(r)){const o=z(r,t),a=o.tabs[o.activeTabIdx]?.layout;if(a!=null)return un(a,t,n)}return r});return Ve(s)}const Rr=e=>Object.entries(e).reduce((t,[n,s])=>(ee(n)&&s!=null&&s.tabs?.forEach(o=>{getLeaves(o.layout??null).forEach(c=>t[c]=n)}),t),{}),ln=e=>({id:t,config:n})=>n.tabs?{id:t,config:{...n,tabs:n.tabs.map(s=>({...s,layout:Oe(s.layout,e)}))}}:{id:t,config:n},Lr=({id:e,config:t,relatedConfigs:n})=>{if(!n)return{configs:[{id:e,config:t}]};const s=fe([e],{[e]:t}),r=cn(s);return{configs:[...filterMap(s,c=>{const i=r[c],u=n[c];if(!(i==null||u==null))return{id:i,config:u}}),{id:e,config:t}].map(ln(r))}};function fe(e,t){const n=e.filter(ee),s=[];return n.forEach(r=>{const o=t[r];o?.tabs&&o.tabs.forEach(a=>{s.push(a.layout,...fe(getLeaves(a.layout??null),t))})}),flatMap(s,getLeaves)}const de={activeTabIdx:0,tabs:[{title:"1",layout:void 0}]};function kr(e,t){const n=getLeaves(e),s=fe(n,t);return[...n,...s]}const me=e=>{if(!e)return!1;if(!Array.isArray(e.tabs)||typeof e.activeTabIdx!="number"){const t=new Error("A non-Tab panel config is being operated on as if it were a Tab panel.");return Fe.info(`Invalid Tab panel config: ${t.message}`,e),reportError(t),!1}if(e.activeTabIdx>=e.tabs.length){const t=new Error("A Tab panel has an activeTabIdx for a nonexistent tab.");return Fe.info(`Invalid Tab panel config: ${t.message}`,e),reportError(t),!1}return!0},pe=(e,t)=>{const n=t.tabs.map((s,r)=>r===t.activeTabIdx?{...s,layout:e}:s);return t.activeTabIdx===-1&&n.push({layout:e,title:"1"}),{...t,tabs:n,activeTabIdx:Math.max(0,t.activeTabIdx)}},Ar=(e=[],t,n)=>{if(!me(t))return{configs:[]};const s=t.tabs[t.activeTabIdx]?.layout;let r;if(e.length===0)r=void 0;else{const a=createRemoveUpdate(s??null,e);r=updateTree(s,[a])}return{configs:[{id:n,config:pe(r,t)}]}},fn=(e,t,n,s)=>{if(e==null)return[];const r=getNodeAtPath(e,n),o=s==="left"||s==="top",[a,c]=o?[t,r]:[r,t];return[{path:n,spec:{$set:{first:a,second:c,direction:s==="left"||s==="right"?"row":"column"}}}]},Fr=(e,t,n,s,r)=>{const o=me(s)?s:de,a=o.tabs[o.activeTabIdx]?.layout,c=a!=null&&t&&n!=null?updateTree(a,fn(a,e,t,n)):e;return{configs:[{id:r,config:pe(c,o)}]}};function z(e,t){const n=t[e];return n&&me(n)?n:de}const Br=({source:e,target:t,savedProps:n})=>{const{tabs:s,activeTabIdx:r}=z(e.panelId,n),o=e.tabIndex??s.length-1,a=t.tabIndex??s.length-1,c=[...s.slice(0,o),...s.slice(o+1)];c.splice(a,0,s[o]);const i=r===e.tabIndex,u=a<=r&&o>=r,d=o<=r&&a>=r;let m=r;return i?m=a:u?m++:d&&m--,{configs:[{id:e.panelId,config:{tabs:c,activeTabIdx:m}}]}},Or=({source:e,target:t,savedProps:n})=>{const s=z(e.panelId,n),r=z(t.panelId,n),o=e.tabIndex??s.tabs.length,a=t.tabIndex??r.tabs.length,c=[...s.tabs.slice(0,o),...s.tabs.slice(o+1)],i=r.tabs.slice();i.splice(a,0,s.tabs[o]);const d=o<=s.activeTabIdx?Math.max(0,s.activeTabIdx-1):s.activeTabIdx,p=a<=r.activeTabIdx?r.activeTabIdx+1:r.activeTabIdx;return{configs:[{id:e.panelId,config:{tabs:c,activeTabIdx:d}},{id:t.panelId,config:{tabs:i,activeTabIdx:p}}]}},dn=(e,t)=>{const{originalId:n,newId:s,idsToRemove:r=[]}=e,o=getLeaves(t);return xor(o,r).length===0?s:uniq(compact([...r,n])).reduce((a,c)=>{if(o.includes(c)){if(a===n)return s;if(a==null||a===c)return}else return a;const i=ue(c,a),u=c===n?{path:i,spec:{$set:s}}:createRemoveUpdate(a,i);return updateTree(a,[u])},t)};function Vr(e,t,n,s){const r=[];return Object.keys(s).filter(ee).forEach(a=>{const{tabs:c,activeTabIdx:i}=z(a,s),u=c[i]?.layout;if(u!=null&&getLeaves(u).some(d=>n.includes(d))){const d=dn({originalId:e,newId:t,idsToRemove:n},u),m=pe(d,s[a]);r.push({id:a,config:m})}}),r}function _r(e,t,n,s){const r=[],o=n[e];if(isTabPanel(e)&&o){const{activeTabIdx:m,tabs:p}=o,b=p[m]?.layout;if(b!=null){const x=getAllPanelIds(b,n);r.push(...x)}}const a=getParentTabPanelByPanelId(n);let c=t;const i=[];for(;c!=null;)i.push(c),c=a[c];r.push(...i);const u=xor(s,[e]);return without(u,...r)}var mn="../../packages/studio-base/src/context/CurrentLayoutContext/index.ts";const pn=L.getLogger(mn),F=(0,oe.createContext)(void 0);F.displayName="CurrentLayoutContext";function jr(){return useGuaranteedContext(F).mosaicId}function bn(){return useGuaranteedContext(F).actions}function Gr(e){const t=useGuaranteedContext(F),[n,s]=useReducer(o=>o+1,0);useShouldNotChangeOften(e,()=>{pn.warn("useCurrentLayoutSelector is changing frequently. Rewrite your selector as a stable function.")});const r=useRef(void 0);return(!r.current||e!==r.current.selector)&&(r.current={value:selectWithUnstableIdentityWarning(t.actions.getCurrentLayoutState(),e),selector:e}),useLayoutEffect(()=>{let o=!0;const a=c=>{if(!o)return;const i=selectWithUnstableIdentityWarning(c,e);i!==r.current?.value&&(r.current={value:i,selector:e},s())};return a(t.actions.getCurrentLayoutState()),t.addLayoutStateListener(a),()=>{o=!1,t.removeLayoutStateListener(a)}},[t,e]),r.current.value}function zr(){const e=useGuaranteedContext(F),[t,n]=useState(()=>e.getSelectedPanelIds());useLayoutEffect(()=>{const i=u=>{n(u)};return e.addSelectedPanelIdsListener(i),()=>{e.removeSelectedPanelIdsListener(i)}},[e]);const s=useGuaranteedContext(F).setSelectedPanelIds,r=useGuaranteedContext(F).getSelectedPanelIds,{getCurrentLayoutState:o}=bn(),a=useCallback(()=>{const i=getLeaves(o().selectedLayout?.data?.layout??null);s(i)},[o,s]),c=useCallback((i,u)=>{s(d=>{const{selectedLayout:m}=o();return m?.data?toggleSelectedPanel(i,u,m.data.configById,d):d})},[s,o]);return useShallowMemo({getSelectedPanelIds:r,selectedPanelIds:t,setSelectedPanelIds:s,selectAllPanels:a,togglePanelSelected:c})}const Ur=null;function Wr(e){const{getCurrentLayoutState:t,savePanelConfigs:n}=useCurrentLayoutActions(),s=useCallback(a=>{if(e!=null)return maybeCast(a.selectedLayout?.data?.configById?.[e])},[e]),r=useCurrentLayoutSelector(s),o=useCallback(a=>{if(e!=null)if(typeof a=="function"){const c=t().selectedLayout?.data?.configById[e];c&&n({configs:[{id:e,config:a(c)}]})}else n({configs:[{id:e,config:a}]})},[t,e,n]);return[r,o]}const gn=Object.freeze({}),hn=e=>e.selectedLayout?.data?.globalVariables??gn;function Hr(){const{setGlobalVariables:e,overwriteGlobalVariables:t}=useCurrentLayoutActions(),n=useCurrentLayoutSelector(hn);return{setGlobalVariables:e,overwriteGlobalVariables:t,globalVariables:n}}function _e(e,t){if(typeof e.value=="object")throw new Error("filterMatches only works on paths where global variables have been filled in");if(e.value==null)return!1;let n=t;for(const s of e.path)if(typeof n!="object"||n==null||(n=n[s],n==null))return!1;return n!=null&&n==e.value}const yn=["id","_id","ID","Id","key"],vn=/^id$|_id$|I[dD]$|^key$/;function Yr(e){return vn.test(e)}function xn(e){const{topics:t,datatypes:n}=PanelAPI.useDataSourceInfo(),{globalVariables:s}=useGlobalVariables(),r=useShallowMemo(e),o=useMemo(()=>filterMap(r,h=>{const v=parseRosPath(h);return v?[h,v]:void 0}),[r]),a=useMemo(()=>{const h={};for(const[v,$]of o)h[v]=be($,s);return h},[s,o]),c=useDeepMemo(a),i=useMemo(()=>keyBy(t,({name:h})=>h),[t]),u=useMemo(()=>{const h=new Set,v=[];for(const[$,w]of o){if(h.has(w.topicName))continue;h.add(w.topicName);const E=i[w.topicName];E&&v.push(E)}return v},[i,o]),d=useDeepMemo(u),m=useMemo(()=>{const h=new Map;function v($,w){if(w.includes($))return;const E=n.get($);if(E){h.set($,E);for(const M of E.definitions)(M.isComplex===!0||extractTypeFromStudioEnumAnnotation(M.name)!=null)&&v(M.type,[...w,$])}}for(const{schemaName:$}of d.values())$!=null&&v($,[]);return h},[n,d]),p=useDeepMemo(m),b=useMemo(()=>messagePathStructures(p),[p]),x=useMemo(()=>enumValuesByDatatypeAndField(p),[p]);return useCallback((h,v)=>{if(!r.includes(h))throw new Error(`path (${h}) was not in the list of cached paths`);const $=c[h];return $?je(v,$,i,b,x):void 0},[r,c,i,b,x])}function be(e,t){return{...e,messagePath:e.messagePath.map(n=>{if(n.type==="slice"){const s=typeof n.start=="object"?Number(t[n.start.variableName]):n.start,r=typeof n.end=="object"?Number(t[n.end.variableName]):n.end;return{...n,start:isNaN(s)?0:s,end:isNaN(r)?1/0:r}}else if(n.type==="filter"&&typeof n.value=="object"){let s;const r=t[n.value.variableName];return(typeof r=="number"||typeof r=="string")&&(s=r),{...n,value:s}}return n})}}function je(e,t,n,s,r){const o=n[t.topicName];if(!o||e.topic!==t.topicName)return;for(const u of t.messagePath)if(u.type==="filter"){if(!_e(u,e.message))return[]}else break;const a=[];function c(u,d,m,p){if(u==null||p==null)return;const b=t.messagePath[d],x=t.messagePath[d+1];if(b)if(b.type==="name"&&p.structureType==="message"){const h=p.nextByName[b.name];c(u[b.name],d+1,`${m}.${b.repr}`,h)}else if(b.type==="slice"&&p.structureType==="array"){const{start:h,end:v}=b;if(typeof h=="object"||typeof v=="object")throw new Error("getMessagePathDataItems only works on paths where global variables have been filled in");const $=h,w=v;if(typeof $!="number"||typeof w!="number")return;const E=u.length;for(let M=$;M<=Math.min(w,E-1);M++){const xs=M>=0?M:E+M,X=u[xs];if(X==null)continue;let Z;if(x&&x.type==="filter")Z=`${m}[:]`;else if(typeof X=="object"){const Me=yn.find(Ts=>Ts in X);Me!=null?Z=`${m}[:]{${Me}==${X[Me]}}`:Z=`${m}[${M}]`}else Z=`${m}[${M}]`;c(X,d+1,Z,p.next)}}else b.type==="filter"?_e(b,u)&&c(u,d+1,`${m}{${b.repr}}`,p):console.warn(`Unknown pathItem.type ${b.type} for structureType: ${p.structureType}`);else{let h;const v=t.messagePath[d-1];if(v&&v.type==="name"){const $=v.name;h=r[p.datatype]?.[$]?.[u]}a.push({value:u,path:m,constantName:h})}}const i=o.schemaName==null?{structureType:"message",datatype:"",nextByName:{}}:s[o.schemaName];return i&&c(e.message,0,pt(t.topicName),i),a}function qr(e){const t=useShallowMemo(e),n=xn(t);return useCallback(s=>{const r={};for(const o of t){const a=parseRosPath(o);if(!a){r[o]=[];continue}const c=s[a.topicName];if(!c)continue;const i=[];r[o]=i;for(const u of c){const d=n(o,u);d&&i.push({messageEvent:u,queriedData:d})}}return r},[t,n])}function Tn(e,t){const{bounds:n,width:s,height:r}=t,o=s/(n.x.max-n.x.min),a=r/(n.y.max-n.y.min),c=[];let i,u,d,m;const p=n.x.max-n.x.min,b=n.x.min-p*.5,x=n.x.max+p*.5;let h;for(const v of e){const{index:$,label:w}=v;if(v.x<b){c.length===0?c.push($):c[0]=$;continue}if(v.x>x){h=$;continue}const E=Math.trunc(v.x*o),M=Math.trunc(v.y*a);if(i?.xPixel!==E||u?.label!=null&&u.label!==v.label){d&&d.yPixel!==i?.yPixel&&d.yPixel!==u?.yPixel&&c.push(d.index),m&&m.yPixel!==i?.yPixel&&m.yPixel!==u?.yPixel&&c.push(m.index),u&&i?.yPixel!==u.yPixel&&c.push(u.index),c.push($),i={xPixel:E,yPixel:M,index:$,label:w},u={xPixel:E,yPixel:M,index:$,label:w},d={xPixel:E,yPixel:M,index:$,label:w},m={xPixel:E,yPixel:M,index:$,label:w};continue}u??={xPixel:E,yPixel:M,index:$,label:w},u.xPixel=E,u.yPixel=M,u.index=$,u.label=w,d&&M<d.yPixel&&(d.yPixel=M,d.index=$,d.label=w),m&&M>m.yPixel&&(m.yPixel=M,m.index=$,m.label=w)}return d&&d.yPixel!==i?.yPixel&&d.yPixel!==u?.yPixel&&c.push(d.index),m&&m.yPixel!==i?.yPixel&&m.yPixel!==u?.yPixel&&c.push(m.index),u&&i?.yPixel!==u.yPixel&&c.push(u.index),h!=null&&c.push(h),c}function $n(e,t){const{bounds:n,width:s,height:r}=t,o=s/(n.x.max-n.x.min),a=r/(n.y.max-n.y.min),c=s,i=[],u=[];for(const d of e){if(d.x>n.x.max||d.x<n.x.min)continue;const m=Math.round(d.x*o),b=Math.round(d.y*a)*c+m;u[b]!==!0&&(u[b]=!0,i.push(d.index))}return i}function Pn(e,t,n){return e.showLine!==!0?$n(t,n):Tn(t,n)}const Sn=e=>{const t={};for(const[n,s]of e){const r=t[n]={};for(const o of s.definitions)o.isConstant===!0&&o.value!=null&&typeof o.value!="boolean"&&(r[o.value.toString()]!=null?r[o.value.toString()]="<multiple constants match>":r[o.value.toString()]=o.name)}return t},Mn=/(.*)__(foxglove|webviz)_enum$/;function wn(e){return Mn.exec(e)?.[1]}const En=e=>{const t=Sn(e),n={};for(const[s,r]of e){const o={};let a={},c;for(const i of r.definitions){if(c!=null&&i.type!==c&&(a={},c=void 0),i.isConstant===!0&&i.value!=null&&typeof i.value!="boolean"){c=i.type,a[i.value.toString()]!=null?a[i.value.toString()]="<multiple constants match>":a[i.value.toString()]=i.name;continue}const u=wn(i.name);if(u!=null){const d=t[i.type];d&&(o[u]=d);continue}o[i.name]||(Object.keys(a).length>0&&(o[i.name]=a),a={})}Object.keys(o).length>0&&(n[s]=o)}return n};var In=g(98321),Nn=g.n(In),Cn=g(54764),U=g.n(Cn);const Dn=/^\d+$/,Rn=/^(?!\.$)(\d*)\.(\d*)$/,Ln=1000n*365n*24n*60n*60n*BigInt(1e9);function Xr(e){const t=e.trim();if(Dn.test(t)){let s=BigInt(t)*BigInt(1e9);for(;s>Ln;)s/=1000n;return{sec:Number(s/BigInt(1e9)),nsec:Number(s%BigInt(1e9))}}const n=Rn.exec(t);if(n?.[1]!=null&&n[2]!=null)return{sec:Number(n[1]),nsec:Number(n[2].substr(0,9).padEnd(9,"0"))}}Nn()(U());function kn(e,t){return`${An(e,t)} ${Fn(e,t)}`}function An(e,t){return e.sec<0||e.nsec<0?(console.error("Times are not allowed to be negative"),"(invalid negative time)"):U().tz((0,S.toDate)(e),t??U().tz.guess()).format("YYYY-MM-DD")}function Fn(e,t){return e.sec<0||e.nsec<0?(console.error("Times are not allowed to be negative"),"(invalid negative time)"):U().tz((0,S.toDate)(e),t??U().tz.guess()).format("h:mm:ss.SSS A z")}function Zr(e){return moment.duration(Math.round(e.sec*1e3+e.nsec/1e6)).format("h:mm:ss.SSS",{trim:!1})}function Ge(e,t){const n=t!=null?moment.tz(e,"YYYY-MM-DD h:mm:ss.SSS A z",t):moment(e,"YYYY-MM-DD h:mm:ss.SSS A z"),s=n.toDate(),r=n.isValid()?fromDate(s):void 0;if(!(!r||r.sec<=0||r.nsec<0))return r}const Bn=/^\d+-\d+-\d+\s+\d+:\d+:\d+.\d+\s[PpAa][Mm]\s[A-Za-z$]+/,Kr=({text:e,timezone:t})=>{if(e==null||e==="")return;const n=isNaN(+e),s=!(Bn.test(e)&&Ge(e,t));if(!(n&&s))return{time:n?Ge(e,t):parseFuzzyRosTime(e),method:n?"TOD":"SEC"}};var te=g(1547);const B={base:{dark:"#1F1E27",medium:"#8B8B8D",light:"#F7F7F3"},red:{dark:"#F24366",medium:"#ff7c96",light:"#FFAABB"},blue:{dark:"#1b83ec",medium:"#4e98e2",light:"#77AADD"},paleGreen:{dark:"#B4CC00",medium:"#cad660",light:"#CDD67E"},orange:{dark:"#ea531f",medium:"#f5774d",light:"#faa487"},cyan:{dark:"#22b5ff",medium:"#61cbff",light:"#99DDFF"},green:{dark:"#05d27d",medium:"#5cd6a9",light:"#8de0c9"},purple:{dark:"#6E51EE",medium:"#a395e2",light:"#c7c0e7"},yellow:{dark:"#EDCC28",medium:"#f7df71",light:"#f1e4aa"}},Jr=(0,te.Z)("hsv(0, 0%, 75%)").toHexString(),ge=[B.blue.medium,B.orange.medium,B.yellow.medium,B.green.medium,B.cyan.medium,B.purple.medium,B.paleGreen.medium],ze=ge.map(e=>[e,...(0,te.Z)(e).tetrad().map(t=>t.toHexString())]),Qr=(0,A.uniq)((0,A.range)(0,ze[0].length).map(e=>ze.map(t=>t[e])).flat()),On=(0,A.memoize)(e=>(0,te.Z)(e).brighten(15).toString()),Vn=(0,A.memoize)(e=>(0,te.Z)(e).darken(30).toString());function _n(e,t){return e??ge[t%ge.length]}function Ue(e){return!isNaN(Number.parseFloat(e.value))}const We={abs:Math.abs,acos:Math.acos,asin:Math.asin,atan:Math.atan,ceil:Math.ceil,cos:Math.cos,log:Math.log,log1p:Math.log1p,log2:Math.log2,log10:Math.log10,round:Math.round,sign:Math.sign,sin:Math.sin,sqrt:Math.sqrt,tan:Math.tan,trunc:Math.trunc,negative:e=>-e,deg2rad:e=>e*(Math.PI/180),rad2deg:e=>e*(180/Math.PI)};function jn(e,t){let{y:n}=e;const s=Number(n);return isNaN(s)||(n=t(s)),{...e,y:n,value:n}}const W=Object.freeze({sec:0,nsec:0}),he=e=>e==="custom"||e==="currentCustom";function He(e,t,n,s,r,o){if(he(e)&&o){if(Ue(o))return Number.parseFloat(o.value);if(s){if(!r)return NaN;const a=r.queriedData[n]?.value;return(0,S.isTime)(a)?(0,S.toSec)(a):typeof a=="bigint"?a:Number(a)}}return e==="timestamp"?t:n}function ye(e){const t=[],n=[],s=[],r=[],o=new Float32Array(e.length),a=new Float32Array(e.length);for(let c=0;c<e.length;c++){const i=e[c];i!=null&&(t.push(i.receiveTime),i.headerStamp!=null&&n.push(i.headerStamp),i.constantName!=null&&s.push(i.constantName),r.push(i.value),o[c]=i.x,a[c]=i.y)}return{receiveTime:t,...s.length>0?{constantName:s}:{},...n.length>0?{headerStamp:n}:{},value:r,x:o,y:a}}function Gn(e,t){return e.concat(...t)}function zn(e,t,n,s,r,o,a){const c=s==="headerStamp"?e.headerStamp:e.receiveTime;if(!c)return{data:[],hasMismatchedData:!1};const i=[],u=(0,S.toSec)((0,S.subtract)(c,n));for(const m of e.queriedData.entries()){const[p,{value:b,constantName:x}]=m;if(typeof b=="number"||typeof b=="boolean"||typeof b=="string"||typeof b=="bigint"){const h=typeof b=="bigint"?b:Number(b);if(typeof h=="bigint"||!isNaN(h)){const v=He(r,u,p,a,t,o),$=h;i.push({x:Number(v),y:Number($),value:b,constantName:x,receiveTime:e.receiveTime,headerStamp:e.headerStamp})}}else if((0,S.isTime)(b)){const h=He(r,u,p,a,t,o),v=(0,S.toSec)(b);i.push({x:Number(h),y:v,receiveTime:e.receiveTime,headerStamp:e.headerStamp,value:`${kn(b)} (${Dt(b)})`,constantName:x})}}const d=he(r)&&(!t||e.queriedData.length!==t.queriedData.length);return{data:i,hasMismatchedData:d}}function Un({path:e,yAxisRanges:t,index:n,startTime:s,xAxisVal:r,xAxisRanges:o,xAxisPath:a,invertedTheme:c=!1}){let i=e.showLine!==!1,u=he(r)&&o!=null&&t.length!==o.length;const d=[];let m;for(const h of Object.keys(We))if(e.value.endsWith(`.@${h}`)&&(m=We[h],m))break;const p=[];for(const[h,v]of t.entries()){const $=o?.[h],{data:w,hasMismatchedData:E}=zn(v,$,s,e.timestampMethod,r,a,o);for(const M of w)m?p.push(jn(M,m)):p.push(M);u=u||E,v.queriedData.length>1&&r!=="index"&&(i=!1)}for(const h of p)d.push(h);const b=_n(e.color,n);return{dataset:{borderColor:b,label:e.label!=null&&e.label!==""?e.label:e.value,showLine:i,fill:!1,borderWidth:1,pointRadius:1,pointHoverRadius:3,pointBackgroundColor:c?On(b):Vn(b),pointBorderColor:"transparent",data:[ye(d)]},hasMismatchedData:u}}function ve(e,t){if(e.length===0||t.length===0)return;const n=[],s=[],r=[],o=[],a=new Float32Array(t.length),c=new Float32Array(t.length);for(let i=0;i<t.length;i++){const u=V(e,t[i]??-1);if(u==null)return;const[d,m]=u,p=e[d];if(p==null)return;n.push(p.receiveTime[m]??W),p.headerStamp!=null&&s.push(p.headerStamp[m]??W),p.constantName!=null&&r.push(p.constantName[m]??""),o.push(p.value[m]);const b=p.x[m],x=p.y[m];if(b==null||x==null)return;a[i]=b,c[i]=x}return[{receiveTime:n,...r.length>0?{constantName:r}:{},...s.length>0?{headerStamp:s}:{},value:o,x:a,y:c}]}function Ye(e,t,n){let s=f.uZ5(0,e,t<0?e+t:t),r=n??e;if(r=f.uZ5(0,e,r<0?e+r:r),s>r){const o=s;s=r,r=o}return[s,r]}function xe(e,t,n){const[s,r]=Ye(e.x.length,t,n),o=r-s,a=[],c=[],i=[],u=[],d=new Float32Array(o),m=new Float32Array(o);for(let p=s;p<r;p++){a.push(e.receiveTime[p]??W),e.headerStamp!=null&&c.push(e.headerStamp[p]??W),e.constantName!=null&&i.push(e.constantName[p]??""),u.push(e.value[p]);const b=e.x[p],x=e.y[p];b==null||x==null||(d[p]=b,m[p]=x)}return{receiveTime:a,headerStamp:c.length>0?c:void 0,constantName:i.length>0?i:void 0,value:u,x:d,y:m}}function Wn(e,t,n){const s=R(e),[r,o]=Ye(s,t,n);if(r===o)return[];const a=V(e,r),c=V(e,o);if(a==null||c==null)return[];const[i,u]=a,[d,m]=c;if(i===d){const h=e[i];return h==null?[]:[xe(h,u,m)]}const p=e[i],b=e[d];if(p==null||b==null)return[];const x=e.slice(i+1,d);return[xe(p,u),...x,xe(b,0,m)]}function Hn(e){const t=e.at(0)?.x.at(0),n=e.at(-1)?.x.at(-1);if(!(t==null||n==null))return[t,n]}function Yn(e,t){const n=Hn(e)?.[1]??Number.MIN_SAFE_INTEGER;let s=-1;for(const o of N(t))if(o.x>n){s=o.index;break}if(s===-1)return e;const r=Wn(t,s);return r.length===0?e:e.concat(ye([{x:NaN,receiveTime:W,y:NaN}]),r)}function qn(e){const t=[];let n=0,s=0;for(const r of N(e)){if(r.index===0){n=r.x,s=r.y;continue}const o=r.x-n,a=(r.y-s)/o;t.push({...r,y:a,value:a}),n=r.x,s=r.y}return[ye(t)]}var qe=g(2784);function eo(e){let t,n,s,r;for(const o of e)for(const a of iterateObjects(o.data))isNaN(a.x)||(t=Math.min(t??a.x,a.x),n=Math.max(n??a.x,a.x)),isNaN(a.x)||(s=Math.min(s??a.y,a.y),r=Math.max(r??a.y,a.y));if(!(t==null||n==null||s==null||r==null))return{x:{min:t,max:n},y:{min:s,max:r}}}function Xn(e){let t,n,s,r;for(const o of e)for(const a of N(o.data)){const{x:c,y:i}=a;isNaN(c)||(t=Math.min(t??c,c),n=Math.max(n??c,c)),isNaN(i)||(s=Math.min(s??i,i),r=Math.max(r??i,i))}if(!(t==null||n==null||s==null||r==null))return{x:{min:t,max:n},y:{min:s,max:r}}}function Zn(e,t){return{x:{min:f.VV$(e.x.min,t.x.min),max:f.Fp7(e.x.max,t.x.max)},y:{min:f.VV$(e.y.min,t.y.min),max:f.Fp7(e.y.max,t.y.max)}}}const Xe=e=>(t,n)=>({bounds:Zn(t.bounds,n.bounds),data:{datasets:f.UID(([s,r])=>({...s,data:e(s.data,r.data)}),f.$Re(t.data.datasets,n.data.datasets))}}),to=Xe((e,t)=>[...e,...t]),no=Xe((e,t)=>e.concat(t));function so(e,t,n,s,r){const[o,a]=qe.useState(),c=qe.useCallback(u=>{a({full:u,partial:void 0})},[]),i=useCallback(u=>{a(d=>{if(d==null)return{full:void 0,partial:u};const{partial:m}=d;return{...d,partial:m!=null?n(m,u):u}})},[n]);return useEffect(()=>{r?.register(c,i)},[r,i,c]),useEffect(()=>{r?.setView(e)},[r,e]),useMemo(()=>{if(s==null){if(o==null)return;const{full:d,partial:m}=o;return m==null?d:d==null?void 0:n(d,m)}const u=t(s.datasets);if(u!=null)return{bounds:u,data:s}},[s,o,t,n])}function Ze(){return{x:{min:Number.MAX_SAFE_INTEGER,max:Number.MIN_SAFE_INTEGER},y:{min:Number.MAX_SAFE_INTEGER,max:Number.MIN_SAFE_INTEGER}}}function Ke(e,t){return{x:{min:Math.min(e.x.min,t.x.min),max:Math.max(e.x.max,t.x.max)},y:{min:Math.min(e.y.min,t.y.min),max:Math.max(e.y.max,t.y.max)}}}function Je(e,t,n){const s=new Map;for(const[r,o]of e){const a=t.get(r);a==null?s.set(r,o):s.set(r,n(o,a,r))}for(const[r,o]of t){if(s.has(r))continue;const a=e.get(r);a==null?s.set(r,o):s.set(r,n(a,o,r))}return s}function ro(e,t){const n=[];for(const[s,r]of e)t.includes(s)&&n.push([s,r]);return new Map(n)}const oo=Object.freeze({receiveTime:[],value:[],x:new Float32Array(0),y:new Float32Array(0)}),_=Object.freeze({bounds:Ze(),datasets:new Map,pathsWithMismatchedDataLengths:[]});function Qe(e){const t={};let n=Number.MAX_SAFE_INTEGER,s=Number.MIN_SAFE_INTEGER;for(const[r,o]of e.datasets){const a=t[r.value]={start:Number.MAX_SAFE_INTEGER,end:Number.MIN_SAFE_INTEGER},{data:c}=o,i=ve(c,[0,R(c)-1])?.[0];a.start=Math.min(a.start,i?.x[0]??Number.MAX_SAFE_INTEGER),a.end=Math.max(a.end,i?.x[i.x.length-1]??Number.MIN_SAFE_INTEGER),n=Math.min(n,a.start),s=Math.max(s,a.end)}return{all:{start:n,end:s},byPath:t}}function et(e,t){const n=new Map;for(const[s,r]of t.entries())n.set(s,e(r,s));return n}function tt(e,t){return e===_?t:t===_?e:{...e,bounds:Ke(e.bounds,t.bounds),datasets:Je(e.datasets,t.datasets,(n,s)=>({...n,data:Gn(n.data,s.data)}))}}function Kn(e,t){return e===_?t:t===_?e:{...e,bounds:Ke(e.bounds,t.bounds),datasets:Je(e.datasets,t.datasets,(n,s)=>({...n,data:Yn(n.data,s.data)}))}}function Jn(e,t){const n=Qe(e).all,s=Qe(t).all,r=n.start-s.start;return r!==0?r:n.end-s.end}function Qn(e){return e.slice().sort(Jn).reduce((s,r)=>(0,A.isEmpty)(s)?r:Kn(s,r),_)}function es(e,t){return f.tSV(n=>n==null?[]:[n.value],[t,...e])}function ts(e){const{paths:t,startTime:n,xAxisVal:s,xAxisPath:r,xAxisData:o,invertedTheme:a}=e,c=Ze(),i=[],u=new Map;for(const[d,[m,p]]of t.entries()){const b=o,x=p??[];if(m.enabled){if(!Ue(m)){const h=Un({path:m,yAxisRanges:x,index:d,startTime:n,xAxisVal:s,xAxisRanges:b,xAxisPath:r,invertedTheme:a});h.hasMismatchedData&&i.push(m.value);const v=Xn([h.dataset]);if(v==null)continue;c.x.min=Math.min(c.x.min,v.x.min),c.x.max=Math.max(c.x.max,v.x.max),c.y.min=Math.min(c.y.min,v.y.min),c.y.max=Math.max(c.y.max,v.y.max),u.set(m,h.dataset)}}else continue}return{bounds:c,datasets:u,pathsWithMismatchedDataLengths:i}}function ns(e,t,n){const{structures:s,enumValues:r}=e,o=f.HK3(a=>a.name,e.topics);return f.tSV(a=>{const c=je(a,n,o,s,r);return c==null?[]:[{queriedData:c,receiveTime:a.receiveTime,headerStamp:Re(a.message)}]},t)}const nt=e=>t=>({...t,datasets:et(e,t.datasets)}),ss=nt((e,t)=>t.value.endsWith(".@derivative")?{...e,data:qn(e.data)}:e),rs=nt((e,t)=>{if(t.timestampMethod!=="headerStamp")return e;const n=[];for(const r of N(e.data))n.push([r.index,r.x]);n.sort(([,r],[,o])=>r-o);const s=ve(e.data,f.UID(([r])=>r,n));return s==null?e:{...e,data:s}});let Te=!1,I={},st={},j={},C={},rt={topics:[],datatypes:new Map,enumValues:{},structures:{}};function H(e){const t={};for(const n of e)t[n]=0;return{cursors:t,data:_}}function ot(e,t){const n={},s={};for(const[r,o]of Object.entries(e))n[r]=t[r]?.length??o,s[r]=t[r]?.slice(o)??[];return[n,s]}function at(e){return es(e.paths,e.xAxisPath)}function it(e){return f.zGw(f.tSV(t=>{const n=re(t);return n==null?[]:[{parsed:n,value:t}]}),f.UID(t=>t.parsed.topicName),f.jj$)(at(e))}function ne(e){const{xAxisVal:t}=e;return t==="currentCustom"||t==="index"}function ct(e,t){const n=re(t.value);return n==null?[]:ns(rt,e[n.topicName]??[],be(n,st))}function Y(e,t){const{paths:n,invertedTheme:s,startTime:r,xAxisPath:o,xAxisVal:a}=e;return ts({invertedTheme:s,paths:f.UID(c=>[c,ct(t,c)],n),startTime:r,xAxisPath:o,xAxisData:o!=null?ct(t,o):void 0,xAxisVal:a})}function q(e,t,n){const{cursors:s,data:r}=e,[o,a]=ot(s,n);return f.xbD(a)?e:{cursors:o,data:tt(r,Y(t,a))}}function os(e){let t=!1,n;const s=()=>{as(e)},r=()=>{n=setTimeout(()=>{n=void 0,t&&(t=!1,s(),r())},100)};return()=>{if(n==null){s(),r();return}t=!0}}function k(e,t){I={...I,[e]:t}}function ut(e){const{params:t,view:n,blocks:{data:s},current:{data:r}}=e;if(!(t==null||n==null))return f.zGw(Qn,ss,rs)([s,r])}function $e(e){const{bounds:t}=e,n=[];for(const s of e.datasets.values())n.push(s);return{bounds:t,data:{datasets:n}}}function Pe(e,t){e.setPanel?.(t),e.setProvided?.($e(t))}function as(e){const t=I[e];if(t==null)return;const n=ut(t);if(n==null)return;const{params:s,view:r}=t;if(s==null||r==null||ne(s))return;const o=et(a=>{const c=Pn(a,N(a.data),r),i=ve(a.data,c);return i==null?a:{...a,data:i}},n.datasets);Pe(t,{...n,datasets:o})}function is(e){Te=e}function cs(e){const{[e]:t,...n}=I;I=n}function us(e,t){rt={topics:e,datatypes:t,enumValues:En(t),structures:xt(t)}}function lt(e){const t=I[e];if(t==null)return;const{params:n}=t;if(n==null)return;const s=it(n),r=H(s);k(e,{...t,topics:s,blocks:q(r,n,j),current:q(r,n,C)}),t.queueRebuild()}function ls(e){st=e;for(const t of Object.values(I)){const{params:n}=t;n==null||f.zGw(f.tSV(r=>{const o=re(r);if(o==null)return[];const a=be(o,e);return f.fS0(o.messagePath,a.messagePath)?[]:[a]}))(at(n)).length===0||lt(t.id)}}function Se(){const e=f.zGw(f.tSV(({topics:t})=>t),f.jj$)(f.VO0(I));j=f.eiS(e,j),C=f.eiS(e,C)}function fs(e){const t=f.XPQ(e);j=f.bTk(f.zoF,j,e);for(const n of f.VO0(I)){const{params:s}=n,r=f.jVA(t,n.topics);s==null||ne(s)||r.length===0||(k(n.id,{...n,blocks:q(n.blocks,s,j)}),n.queueRebuild())}Se()}function ds(){C={};for(const e of f.VO0(I))k(e.id,{...e,current:H(e.topics)}),e.queueRebuild()}function ms(e){for(const t of e){const{topic:n}=t;C[n]==null&&(C[n]=[]),C[n]?.push(t)}if(!Te){for(const t of f.VO0(I)){const{params:n}=t;if(n!=null){if(ne(n)){Pe(t,Y(n,f.UID(s=>s.slice(-1),C)));continue}k(t.id,{...t,current:q(t.current,n,C)}),t.queueRebuild()}}return}for(const t of f.VO0(I)){const{params:n,current:s}=t;if(n==null)continue;const{cursors:r,data:o}=s,[a,c]=ot(r,C);if(ne(n)){Pe(t,Y(n,f.UID(u=>u.slice(-1),C)));continue}if(f.xbD(c))continue;const i=Y(n,c);t.addPartial?.($e(i)),k(t.id,{...t,current:{cursors:a,data:tt(o,i)}})}Se()}function ft(e,t){const n=I[e];n!=null&&(k(e,{...n,params:t,topics:it(t)}),lt(e),Se())}function ps(e,t){const n=I[e];n!=null&&(k(e,{...n,view:t}),n.queueRebuild())}const bs=(0,S.fromSec)(10);function gs(){if(Te){C=f.UID(e=>{if(e.length>1e4)return e.slice(e.length-1e4);const t=e.at(0)?.receiveTime,n=e.at(-1)?.receiveTime;if(n==null||t==null)return e;const s=(0,S.subtract)(n,bs),r=f.cxD(({receiveTime:o})=>(0,S.compare)(o,s)>0,e);return e.slice(r)},C);for(const e of f.VO0(I)){const{params:t}=e;if(t==null)continue;const n=q(H(e.topics),t,C);k(e.id,{...e,current:n}),e.setProvided?.($e(n.data))}}}setInterval(gs,2e3);function hs(e,t,n,s,r){k(e,{id:e,setProvided:t,addPartial:s,setPanel:n,params:r,topics:[],view:void 0,blocks:H([]),current:H([]),queueRebuild:os(e)}),r!=null&&ft(e,r)}function ys(e){const t=I[e];if(t!=null)return ut(t)}const vs={addBlock:fs,addCurrent:ms,buildPlot:Y,clearCurrent:ds,getFullData:ys,receiveMetadata:us,receiveVariables:ls,register:hs,setLive:is,unregister:cs,updateParams:ft,updateView:ps};l.Jj(vs)}},Ee={};function P(y){var T=Ee[y];if(T!==void 0)return T.exports;var g=Ee[y]={id:y,loaded:!1,exports:{}};return we[y].call(g.exports,g,g.exports,P),g.loaded=!0,g.exports}P.m=we,P.x=()=>{var y=P.O(void 0,[7955,2806,57,1547,7140],()=>P(59362));return y=P.O(y),y},(()=>{var y=[];P.O=(T,g,l,f)=>{if(g){f=f||0;for(var S=y.length;S>0&&y[S-1][2]>f;S--)y[S]=y[S-1];y[S]=[g,l,f];return}for(var R=1/0,S=0;S<y.length;S++){for(var[g,l,f]=y[S],O=!0,N=0;N<g.length;N++)(f&!1||R>=f)&&Object.keys(P.O).every(se=>P.O[se](g[N]))?g.splice(N--,1):(O=!1,f<R&&(R=f));if(O){y.splice(S--,1);var V=l();V!==void 0&&(T=V)}}return T}})(),P.n=y=>{var T=y&&y.__esModule?()=>y.default:()=>y;return P.d(T,{a:T}),T},P.d=(y,T)=>{for(var g in T)P.o(T,g)&&!P.o(y,g)&&Object.defineProperty(y,g,{enumerable:!0,get:T[g]})},P.f={},P.e=y=>Promise.all(Object.keys(P.f).reduce((T,g)=>(P.f[g](y,T),T),[])),P.u=y=>""+y+"."+{57:"b5714ebf55a206af9bff",1547:"8ba446bd308908072dc1",2806:"d81cbac26ac1f461ee21",7140:"db6f51c8c5270151174a",7955:"e48e6f0665bc0be793e7"}[y]+".js",P.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}(),P.o=(y,T)=>Object.prototype.hasOwnProperty.call(y,T),P.nmd=y=>(y.paths=[],y.children||(y.children=[]),y),(()=>{var y;P.g.importScripts&&(y=P.g.location+"");var T=P.g.document;if(!y&&T&&(T.currentScript&&(y=T.currentScript.src),!y)){var g=T.getElementsByTagName("script");if(g.length)for(var l=g.length-1;l>-1&&!y;)y=g[l--].src}if(!y)throw new Error("Automatic publicPath is not supported in this browser");y=y.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),P.p=y})(),(()=>{var y={9362:1},T=f=>{var[S,R,O]=f;for(var N in R)P.o(R,N)&&(P.m[N]=R[N]);for(O&&O(P);S.length;)y[S.pop()]=1;l(f)};P.f.i=(f,S)=>{y[f]||importScripts(P.p+P.u(f))};var g=self.webpackChunk=self.webpackChunk||[],l=g.push.bind(g);g.push=T})(),(()=>{var y=P.x;P.x=()=>Promise.all([7955,2806,57,1547,7140].map(P.e,P)).then(y)})();var $s=P.x()})();

//# sourceMappingURL=9362.ab238192570bc77c024e.js.map