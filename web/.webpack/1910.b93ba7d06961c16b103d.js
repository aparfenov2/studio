(self.webpackChunk=self.webpackChunk||[]).push([[1910],{19596:(ce,K,u)=>{"use strict";u.r(K),u.d(K,{default:()=>le});var Z=u(52322),Q=u(47746),X=u(5603),o=u(86294),Y=u(91922),H=u(21023),i=u(2784);function L(e){return/^\d+$/.test(e)?"".concat(e,"px"):e}function x(){}var P=function(){return P=Object.assign||function(e){for(var t,f=1,r=arguments.length;f<r;f++){t=arguments[f];for(var l in t)Object.prototype.hasOwnProperty.call(t,l)&&(e[l]=t[l])}return e},P.apply(this,arguments)};function G(e){var t=e.width,f=e.height,r=e.value,l=e.defaultValue,v=e.language,E=e.theme,k=e.options,R=e.overrideServices,U=e.editorWillMount,j=e.editorDidMount,w=e.editorWillUnmount,V=e.onChange,M=e.className,C=e.original,b=e.originalUri,d=e.modifiedUri,D=(0,i.useRef)(null),a=(0,i.useRef)(null),n=(0,i.useRef)(null),c=(0,i.useRef)(null),y=L(t),h=L(f),g=(0,i.useMemo)(function(){return{width:y,height:h}},[y,h]),F=function(){var s=U(o);return s||{}},A=function(){j(a.current,o);var s=a.current.getModel().modified;n.current=s.onDidChangeContent(function(m){c.current||V(s.getValue(),m)})},p=function(){w(a.current,o)},$=function(){var s=r??l,m=b?.(o),N=d?.(o),W=m&&o.editor.getModel(m),T=N&&o.editor.getModel(N);W?(W.setValue(C),o.editor.setModelLanguage(W,v)):W=o.editor.createModel(s,v,m),T?(W.setValue(s),o.editor.setModelLanguage(T,v)):T=o.editor.createModel(s,v,N),a.current.setModel({original:W,modified:T})};return(0,i.useEffect)(function(){D.current&&(F(),a.current=o.editor.createDiffEditor(D.current,P(P(P({},M?{extraEditorClassName:M}:{}),k),E?{theme:E}:{}),R),$(),A())},[]),(0,i.useEffect)(function(){a.current&&a.current.updateOptions(P(P({},M?{extraEditorClassName:M}:{}),k))},[M,k]),(0,i.useEffect)(function(){a.current&&a.current.layout()},[t,f]),(0,i.useEffect)(function(){if(a.current){var s=a.current.getModel(),m=s.original,N=s.modified;o.editor.setModelLanguage(m,v),o.editor.setModelLanguage(N,v)}},[v]),(0,i.useEffect)(function(){if(a.current){var s=a.current.getModel().modified;c.current=!0,a.current.getModifiedEditor().pushUndoStop(),s.pushEditOperations([],[{range:s.getFullModelRange(),text:r}]),a.current.getModifiedEditor().pushUndoStop(),c.current=!1}},[r]),(0,i.useEffect)(function(){o.editor.setTheme(E)},[E]),(0,i.useEffect)(function(){if(a.current){var s=a.current.getModel().original;C!==s.getValue()&&s.setValue(C)}},[C]),(0,i.useEffect)(function(){return function(){if(a.current){p(),a.current.dispose();var s=a.current.getModel(),m=s.original,N=s.modified;m&&m.dispose(),N&&N.dispose()}n.current&&n.current.dispose()}},[]),i.createElement("div",{ref:D,style:g,className:"react-monaco-editor-container"})}G.defaultProps={width:"100%",height:"100%",original:null,value:null,defaultValue:"",language:"javascript",theme:null,options:{},overrideServices:{},editorWillMount:x,editorDidMount:x,editorWillUnmount:x,onChange:x,className:null},G.displayName="MonacoDiffEditor";const ge=null;var S=function(){return S=Object.assign||function(e){for(var t,f=1,r=arguments.length;f<r;f++){t=arguments[f];for(var l in t)Object.prototype.hasOwnProperty.call(t,l)&&(e[l]=t[l])}return e},S.apply(this,arguments)},q=function(e,t){var f={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(f[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var l=0,r=Object.getOwnPropertySymbols(e);l<r.length;l++)t.indexOf(r[l])<0&&Object.prototype.propertyIsEnumerable.call(e,r[l])&&(f[r[l]]=e[r[l]]);return f};function z(e){var t=e.width,f=e.height,r=e.value,l=e.defaultValue,v=e.language,E=e.theme,k=e.options,R=e.overrideServices,U=e.editorWillMount,j=e.editorDidMount,w=e.editorWillUnmount,V=e.onChange,M=e.className,C=e.uri,b=(0,i.useRef)(null),d=(0,i.useRef)(null),D=(0,i.useRef)(null),a=(0,i.useRef)(null),n=L(t),c=L(f),y=(0,i.useMemo)(function(){return{width:n,height:c}},[n,c]),h=function(){var p=U(o);return p||{}},g=function(){j(d.current,o),D.current=d.current.onDidChangeModelContent(function(p){a.current||V(d.current.getValue(),p)})},F=function(){w(d.current,o)},A=function(){var p=r!==null?r:l;if(b.current){var $=S(S({},k),h()),s=C?.(o),m=s&&o.editor.getModel(s);m?(m.setValue(p),o.editor.setModelLanguage(m,v)):m=o.editor.createModel(p,v,s),d.current=o.editor.create(b.current,S(S(S({model:m},M?{extraEditorClassName:M}:{}),$),E?{theme:E}:{}),R),g()}};return(0,i.useEffect)(A,[]),(0,i.useEffect)(function(){if(d.current){if(r===d.current.getValue())return;var p=d.current.getModel();a.current=!0,d.current.pushUndoStop(),p.pushEditOperations([],[{range:p.getFullModelRange(),text:r}],void 0),d.current.pushUndoStop(),a.current=!1}},[r]),(0,i.useEffect)(function(){if(d.current){var p=d.current.getModel();o.editor.setModelLanguage(p,v)}},[v]),(0,i.useEffect)(function(){if(d.current){var p=k.model,$=q(k,["model"]);d.current.updateOptions(S(S({},M?{extraEditorClassName:M}:{}),$))}},[M,k]),(0,i.useEffect)(function(){d.current&&d.current.layout()},[t,f]),(0,i.useEffect)(function(){o.editor.setTheme(E)},[E]),(0,i.useEffect)(function(){return function(){if(d.current){F(),d.current.dispose();var p=d.current.getModel();p&&p.dispose()}D.current&&D.current.dispose()}},[]),i.createElement("div",{ref:b,style:y,className:"react-monaco-editor-container"})}z.defaultProps={width:"100%",height:"100%",value:null,defaultValue:"",language:"javascript",theme:null,options:{},overrideServices:{},editorWillMount:x,editorDidMount:x,editorWillUnmount:x,onChange:x,className:null},z.displayName="MonacoEditor";const _=z;var ee=u(62515),te=u(16003),ne=u(80144);async function oe(e){const t=await u.e(554).then(u.bind(u,50554)),f=await u.e(311).then(u.bind(u,40311)),r=await u.e(6161).then(u.bind(u,21495));return await t.format(e,{parser:"typescript",plugins:[f,r]})}const re=oe;var ie=u(64942);function ae(e){const t=e||typeof window<"u"&&window;return!!(t&&(t.navigator.userAgent.match(/Chromatic/)||t.location.href.match(/chromatic=true/)))}function ue(){return navigator.userAgent.includes("PuppeteerTestingChrome")||ae()}var B=u(11701),de=u(36537);const fe=[{name:"vs-studio-dark",theme:{base:"vs-dark",inherit:!0,rules:[{foreground:"6c6783",token:"comment"},{foreground:"eba800",token:"string"},{foreground:"9987ff",token:"constant.numeric"},{foreground:"9987ff",token:"constant.language"},{foreground:"9987ff",token:"constant.character"},{foreground:"9987ff",token:"constant.other"},{foreground:"e05ffa",token:"keyword"},{foreground:"e05ffa",token:"storage"},{foreground:"45a5ff",fontStyle:"italic",token:"storage.type"},{foreground:"6bd66f",fontStyle:"underline",token:"entity.name.class"},{foreground:"6bd66f",fontStyle:"italic underline",token:"entity.other.inherited-class"},{foreground:"6bd66f",token:"entity.name.function"},{foreground:"fc8942",fontStyle:"italic",token:"variable.parameter"},{foreground:"db3553",token:"entity.name.tag"},{foreground:"6bd66f",token:"entity.other.attribute-name"},{foreground:"45a5ff",token:"support.function"},{foreground:"45a5ff",token:"support.constant"},{foreground:"45a5ff",fontStyle:"italic",token:"support.type"},{foreground:"45a5ff",fontStyle:"italic",token:"support.class"},{foreground:"f0f0f0",background:"ff6b82",token:"invalid"},{foreground:"f0f0f0",background:"6858f5",token:"invalid.deprecated"}],colors:{"editor.foreground":"#F7F7F3C4","editor.background":"#08080A","editor.selectionBackground":"#F7F7F326","editor.lineHighlightBackground":"#F7F7F31A","editorCursor.foreground":"#F7F7F3C4","editorWhitespace.foreground":"#3B3A32"}}},{name:"vs-studio-light",theme:{base:"vs",inherit:!0,rules:[{foreground:"eefff8",background:"2f8963",token:"markup.inserted.diff"},{foreground:"eefff8",background:"2f8963",token:"meta.diff.header.to-file"},{foreground:"fff3ee",background:"c86a44",token:"markup.deleted.diff"},{foreground:"fff3ee",background:"c86a44",token:"meta.diff.header.from-file"},{foreground:"008000",token:"comment"},{foreground:"000000",token:"variable"},{foreground:"0000ff",token:"keyword"},{foreground:"a31515",token:"constant.numeric"},{foreground:"000000",token:"constant"},{foreground:"000000",token:"constant.language"},{foreground:"0000ff",token:"constant.language.boolean"},{foreground:"a31515",token:"string"},{foreground:"26b31a",token:"constant.character.escape"},{foreground:"26b31a",token:"string source"},{foreground:"0000ff",token:"meta.preprocessor"},{foreground:"0000ff",token:"keyword.control.import"},{foreground:"000000",token:"entity.name.function"},{foreground:"000000",token:"keyword.other.name-of-parameter.objc"},{foreground:"000000",token:"entity.name.type"},{foreground:"0000ff",token:"storage.type"},{foreground:"0000ff",token:"storage.modifier"},{foreground:"70727e",token:"storage.type.method"},{foreground:"000000",token:"support.function"},{foreground:"000000",token:"support.class"},{foreground:"000000",token:"support.type"},{foreground:"000000",token:"support.constant"},{foreground:"000000",token:"support.variable"},{foreground:"687687",token:"keyword.operator.js"},{background:"e1a09f",token:"invalid"},{background:"ffd0d0",token:"invalid.deprecated.trailing-whitespace"},{background:"427ff530",token:"text source"},{background:"427ff530",token:"string.unquoted"},{foreground:"68685b",token:"meta.xml-processing"},{foreground:"68685b",token:"declaration.xml-processing"},{foreground:"a31515",token:"meta.doctype"},{foreground:"a31515",token:"declaration.doctype"},{foreground:"0000ff",token:"meta.tag"},{foreground:"0000ff",token:"declaration.tag"},{foreground:"a31515",token:"entity.name.tag"},{foreground:"ff0000",token:"entity.other.attribute-name"},{foreground:"0000ff",token:"string.quoted.double.xml"},{foreground:"0000ff",token:"string.quoted.double.html"},{foreground:"0c07ff",token:"markup.heading"},{foreground:"000000",token:"markup.quote"},{foreground:"b90690",token:"markup.list"}],colors:{"editor.foreground":"#000000","editor.background":"#FFFFFF","editor.selectionBackground":"#9DA7C3","editor.lineHighlightBackground":"#00000012","editorCursor.foreground":"#000000","editorWhitespace.foreground":"#BFBFBF"}}}];var O=u(2784);const se=Y.IO.get(X.$),J=(e,t)=>{if(t){const f=(0,de.N)(t);if(f.endLineNumber!=null&&f.endColumn!=null)e.setSelection(t),e.revealRangeInCenter(t,1);else{const r={lineNumber:t.startLineNumber,column:t.startColumn};e.setPosition(r),e.revealPositionInCenter(r,1)}}},I=(0,ie.L)(),le=({autoFormatOnSave:e,script:t,setScriptCode:f,save:r,setScriptOverride:l,rosLib:v,typesLib:E})=>{const k=O.useRef(null),R=O.useRef(e);R.current=e;const U=(0,Q.Z)().palette.mode==="dark"?"vs-studio-dark":"vs-studio-light";O.useEffect(()=>{const n=o.languages.typescript.typescriptDefaults.addExtraLib(v,`file:///node_modules/@types/${I.rosLib.fileName}`);return()=>{n.dispose()}},[v]),O.useEffect(()=>{const n=o.Uri.parse(`file://${B.wd}generatedTypes.ts`),c=o.editor.getModel(n)??o.editor.createModel(E,"typescript",n);c.setValue(E),c.updateOptions({tabSize:2})},[E]),(0,i.useEffect)(()=>{const n=se.registerCodeEditorOpenHandler(async(c,y)=>{const h=o.editor.getModel(c.resource);return h?y&&t&&h.uri.path===`${B.wd}${H.basename(t.filePath)}`?(J(y,c.options.selection),null):(l({filePath:h.uri.path,code:h.getValue(),readOnly:!0,selection:c.options?.selection}),y):y});return()=>n.dispose()},[t,l]),O.useEffect(()=>{const n=k.current;if(!n||!t)return;const c=H.basename(t.filePath),y=o.Uri.parse(`file://${B.wd}${c}`),h=o.editor.getModel(y)??o.editor.createModel(t.code,"typescript",y);h.getValue()!==t.code&&h.setValue(t.code),n.setModel(h),J(n,t.selection)},[t]);const j=O.useMemo(()=>({wordWrap:"on",minimap:{enabled:!1},readOnly:t?.readOnly}),[t]),w=O.useCallback(n=>{if(!t)return;for(const g of fe)n.editor.defineTheme(g.name,g.theme);n.languages.typescript.typescriptDefaults.setEagerModelSync(!0),n.languages.typescript.javascriptDefaults.setEagerModelSync(!0),n.languages.registerDocumentFormattingEditProvider("typescript",{provideDocumentFormattingEdits:async g=>{try{return[{range:g.getFullModelRange(),text:await re(g.getValue())}]}catch{return[]}}}),ue()&&n.languages.typescript.typescriptDefaults.setDiagnosticsOptions({noSyntaxValidation:!0,noSemanticValidation:!0}),I.declarations.forEach(g=>{g.fileName.startsWith("@foxglove/schemas")?n.languages.typescript.typescriptDefaults.addExtraLib(g.sourceCode,`file:///node_modules/${g.fileName}`):n.languages.typescript.typescriptDefaults.addExtraLib(g.sourceCode,`file:///node_modules/@types/${g.fileName}`)}),n.languages.typescript.typescriptDefaults.setCompilerOptions({...n.languages.typescript.typescriptDefaults.getCompilerOptions(),moduleResolution:ne.ModuleResolutionKind.NodeNext}),I.utilityFiles.forEach(g=>{const F=o.Uri.parse(`file://${g.filePath}`);(n.editor.getModel(F)??n.editor.createModel(g.sourceCode,"typescript",F)).updateOptions({tabSize:2})});const c=H.basename(t.filePath),y=o.Uri.parse(`file://${B.wd}${c}`),h=n.editor.getModel(y)??n.editor.createModel(t.code,"typescript",y);return h.updateOptions({tabSize:2}),{model:h}},[t]),V=O.useCallback(async()=>{const n=k.current?.getModel();n&&t&&!t.readOnly&&(R.current&&await k.current?.getAction("editor.action.formatDocument")?.run(),r(n.getValue()))},[r,t]),M=(0,i.useRef)(V);M.current=V;const C=O.useCallback(n=>{k.current=n,n.addAction({id:"ctrl-s",label:"Save current node",keybindings:[o.KeyMod.CtrlCmd|o.KeyCode.KeyS],run:async()=>{await M.current()}})},[]),b=(0,te.Z)(f),d=(0,i.useCallback)(n=>{b.current(n)},[b]),D=(0,i.useCallback)((n,c)=>{n!=null&&c!=null&&k.current?.layout({width:n,height:c})},[]),{ref:a}=(0,ee.NB)({refreshRate:0,refreshMode:"debounce",onResize:D});return t?(0,Z.jsx)("div",{ref:a,style:{width:"100%",height:"100%"},children:(0,Z.jsx)(_,{language:"typescript",theme:U,editorWillMount:w,editorDidMount:C,options:j,onChange:d})}):null}},89424:()=>{},9445:()=>{},70546:()=>{},15490:()=>{},80136:()=>{},91389:()=>{},9865:()=>{},73860:()=>{},98752:()=>{}}]);

//# sourceMappingURL=1910.b93ba7d06961c16b103d.js.map