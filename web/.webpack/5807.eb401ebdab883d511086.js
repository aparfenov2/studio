"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[5807],{14571:(D,f,l)=>{l.d(f,{o:()=>h});var d=l(52322),o=l(2784);class h extends o.Component{state={hadError:!1};componentDidCatch(b){this.setState({hadError:!0}),this.props.onError(b)}render(){return this.state.hadError?(0,d.jsx)(d.Fragment,{}):this.props.children}}},96133:(D,f,l)=>{l.d(f,{J:()=>d});function d(o,h){if(typeof o.value=="object")throw new Error("filterMatches only works on paths where global variables have been filled in");if(o.value==null)return!1;let u=h;for(const b of o.path)if(typeof u!="object"||u==null||(u=u[b],u==null))return!1;return u!=null&&u==o.value}},62273:(D,f,l)=>{l.d(f,{T:()=>h});var d=l(49302),o=l(96133);function h(u,b){if(u.topic!==b.topicName)return[];const j=[];function v(p,M){const g=b.messagePath[M];if(g==null){j.push(p);return}if(p!=null)switch(g.type){case"slice":{if(!Array.isArray(p)&&!(0,d.f)(p))return;if(typeof g.start=="object"||typeof g.end=="object")throw new Error("Variables in slices are not supported");const{start:I,end:w}=g;for(let m=I;m<p.length&&m<=w;m++)v(p[m],M+1);return}case"filter":if(!(0,o.J)(g,p))return;v(p,M+1);return;case"name":if(typeof p!="object")return;v(p[g.name],M+1);return}}return v(u.message,0),j}},15807:(D,f,l)=>{l.r(f),l.d(f,{default:()=>_});var d=l(52322),o=l(2784),h=l(28316),u=l(75845),b=l(14571),j=l(75017),v=l(14123),p=l(88724),M=l(68434),g=l(82228),I=l(72970),w=l(1012),m=l(62273),L=l(93812),B=l(77075),V=l(10363);function U(e,a){const t=typeof e=="object"?e.data:e;if(t!=null)for(const r of a){let n;try{if(typeof t=="boolean"||typeof t=="number"){if(n=JSON.parse(r.rawValue),typeof n!="boolean"&&typeof n!="number")continue}else typeof t=="string"?n=r.rawValue:typeof t=="bigint"?n=BigInt(r.rawValue):(0,V.v)(t,"Unsupported rule value")}catch{continue}if(r.operator==="="&&t===n)return r;if(r.operator==="<"&&t<n)return r;if(r.operator==="<="&&t<=n)return r;if(r.operator===">"&&t>n)return r;if(r.operator===">="&&t>=n)return r}}var x=l(67067),R=l(25513),F=l(5817),G=l.n(F);function K(e){return`data ${{"=":"=","<":"<","<=":"\u2264",">":">",">=":"\u2265"}[e.operator]} ${e.rawValue}`}function W(e,a){return(0,x.Uy)(e,t=>{switch(a.action){case"perform-node-action":if(a.payload.path[0]==="rules"){if(a.payload.id==="delete-rule"){const r=+a.payload.path[1];t.rules.splice(r,1)}else if(a.payload.id==="add-rule"||a.payload.id==="add-rule-above"||a.payload.id==="add-rule-below"){let r=t.rules.length;a.payload.id==="add-rule-above"&&a.payload.path[1]!=="default"?r=+a.payload.path[1]:a.payload.id==="add-rule-below"&&(r=+a.payload.path[1]+1),t.rules.splice(r,0,{operator:"=",rawValue:"true",color:`#${Math.floor(Math.random()*16777216).toString(16)}`,label:"Label"})}else if(a.payload.id==="move-up"){const r=+a.payload.path[1],[n]=t.rules.splice(r,1);t.rules.splice(r-1,0,n)}else if(a.payload.id==="move-down"){const r=+a.payload.path[1],[n]=t.rules.splice(r,1);t.rules.splice(r+1,0,n)}}break;case"update":switch(a.payload.path[0]){case"general":R.Z(t,[a.payload.path[1]],a.payload.value);break;case"rules":if(a.payload.path[1]==="default")R.Z(t,[a.payload.path[2]],a.payload.value);else{const r=+a.payload.path[1];R.Z(t.rules[r],[a.payload.path[2]],a.payload.value)}break;default:throw new Error(`Unexpected payload.path[0]: ${a.payload.path[0]}`)}break}})}const $=G()((e,a,t)=>{const r=[{type:"action",id:"delete-rule",label:"Delete rule",icon:"Delete"},a>0&&{type:"action",id:"move-up",label:"Move up",icon:"MoveUp"},a<t.length-1&&{type:"action",id:"move-down",label:"Move down",icon:"MoveDown"},{type:"action",id:"add-rule-above",label:"Add rule above",icon:"Add"},{type:"action",id:"add-rule-below",label:"Add rule below",icon:"Add"}];return{label:K(e),actions:r.filter(n=>n!==!1),fields:{operator:{label:"Comparison",input:"select",value:e.operator,options:[{label:"Equal to",value:"="},{label:"Less than",value:"<"},{label:"Less than or equal to",value:"<="},{label:"Greater than",value:">"},{label:"Greater than or equal to",value:">="}]},rawValue:{label:"Compare with",input:"string",value:e.rawValue},color:{label:"Color",input:"rgb",value:e.color},label:{label:"Label",input:"string",value:e.label}}}});function z(e,a,t){const{path:r,style:n,rules:s}=e,c=(0,o.useMemo)(()=>({error:t,fields:{path:{label:"Message path",input:"messagepath",value:r,error:a},style:{label:"Style",input:"select",value:n,options:[{label:"Bulb",value:"bulb"},{label:"Background",value:"background"}]}}}),[t,r,a,n]),{fallbackColor:i,fallbackLabel:E}=e,A=(0,o.useMemo)(()=>({label:"Rules (first matching rule wins)",actions:[{type:"action",id:"add-rule",label:"Add rule",icon:"Add"}],children:Object.fromEntries(s.map((S,P)=>[P.toString(),$(S,P,s)]).concat([["default",{label:"Otherwise",fields:{fallbackColor:{label:"Color",input:"rgb",value:i,help:"Color to use when no other rules match"},fallbackLabel:{label:"Label",input:"string",value:E,help:"Label to use when no other rules match"}},actions:[{type:"action",id:"add-rule-above",label:"Add rule above",icon:"Add"}]}]]))}),[i,E,s]);return(0,u.O4)({general:c,rules:A})}const H={path:"",style:"bulb",fallbackColor:"#a0a0a0",fallbackLabel:"False",rules:[{operator:"=",rawValue:"true",color:"#68e24a",label:"True"}]},J=(0,I.ZL)()({root:{width:40,height:40,borderRadius:"50%",position:"relative",backgroundImage:["radial-gradient(transparent, transparent 55%, rgba(255,255,255,0.4) 80%, rgba(255,255,255,0.4))","radial-gradient(circle at 38% 35%, rgba(255,255,255,0.8), transparent 30%, transparent)","radial-gradient(circle at 46% 44%, transparent, transparent 61%, rgba(0,0,0,0.7) 74%, rgba(0,0,0,0.7))"].join(",")}});function N(e){if(e.length<=1)return e[0];throw new Error("Message path produced multiple results")}function Y(e,a){try{switch(a.type){case"frame":{if(e.pathParseError!=null)return{...e,latestMessage:g.Z(a.messages),error:void 0};let t=e.latestMatchingQueriedData,r=e.latestMessage;if(e.parsedPath)for(const n of a.messages){if(n.topic!==e.parsedPath.topicName)continue;const s=N((0,m.T)(n,e.parsedPath));s!=null&&(t=s,r=n)}return{...e,latestMessage:r,latestMatchingQueriedData:t,error:void 0}}case"path":{const t=(0,w.ZP)(a.path);let r;t?.messagePath.some(c=>c.type==="filter"&&typeof c.value=="object"||c.type==="slice"&&(typeof c.start=="object"||typeof c.end=="object"))===!0&&(r="Message paths using variables are not currently supported");let n,s;try{n=t&&r==null&&e.latestMessage?N((0,m.T)(e.latestMessage,t)):void 0}catch(c){s=c}return{...e,path:a.path,parsedPath:t,latestMatchingQueriedData:n,error:s,pathParseError:r}}case"seek":return{...e,latestMessage:void 0,latestMatchingQueriedData:void 0,error:void 0}}}catch(t){return{...e,latestMatchingQueriedData:void 0,error:t}}}function X({context:e}){const[a,t]=(0,o.useState)(()=>()=>{}),{classes:r,theme:{palette:{augmentColor:n}}}=J(),[s,c]=(0,o.useState)(()=>({...H,...e.initialState})),[i,E]=(0,o.useReducer)(Y,s,({path:y})=>({path:y,parsedPath:(0,w.ZP)(y),latestMessage:void 0,latestMatchingQueriedData:void 0,pathParseError:void 0,error:void 0}));(0,o.useLayoutEffect)(()=>{E({type:"path",path:s.path})},[s.path]),(0,o.useEffect)(()=>{e.saveState(s),e.setDefaultPanelTitle(s.path===""?void 0:s.path)},[s,e]),(0,o.useEffect)(()=>(e.onRender=(y,k)=>{t(()=>k),y.didSeek===!0&&E({type:"seek"}),y.currentFrame&&E({type:"frame",messages:y.currentFrame})},e.watch("currentFrame"),e.watch("didSeek"),()=>{e.onRender=void 0}),[e]);const A=(0,o.useCallback)(y=>{c(k=>W(k,y))},[c]),S=z(s,i.pathParseError,i.error?.message);(0,o.useEffect)(()=>{e.updatePanelSettingsEditor({actionHandler:A,nodes:S})},[e,A,S]),(0,o.useEffect)(()=>(i.parsedPath?.topicName!=null&&e.subscribe([i.parsedPath.topicName]),()=>{e.unsubscribeAll()}),[e,i.parsedPath?.topicName]),(0,o.useEffect)(()=>{a()},[a]);const P=typeof i.latestMatchingQueriedData=="boolean"||typeof i.latestMatchingQueriedData=="bigint"||typeof i.latestMatchingQueriedData=="string"||typeof i.latestMatchingQueriedData=="number"?i.latestMatchingQueriedData:void 0,{style:Z,rules:Q,fallbackColor:T,fallbackLabel:ee}=s,C=(0,o.useMemo)(()=>U(P,Q),[P,Q]);return(0,d.jsx)(L.Z,{fullHeight:!0,children:(0,d.jsx)(L.Z,{flexGrow:1,justifyContent:"space-around",alignItems:"center",overflow:"hidden",padding:1,style:{backgroundColor:Z==="background"?C?.color??T:void 0},children:(0,d.jsxs)(L.Z,{direction:"row",alignItems:"center",gap:2,children:[Z==="bulb"&&(0,d.jsx)("div",{className:r.root,style:{backgroundColor:C?.color??T}}),(0,d.jsx)(M.Z,{color:Z==="background"?n({color:{main:C?.color??T}}).contrastText:C?.color??T,fontFamily:B.R.MONOSPACE,variant:"h1",whiteSpace:"pre",children:C?.label??ee})]})})})}function q(e,a){return h.render((0,d.jsx)(o.StrictMode,{children:(0,d.jsx)(b.o,{onError:e,children:(0,d.jsx)(p.Z,{isDark:!0,children:(0,d.jsx)(X,{context:a})})})}),a.panelElement),()=>{h.unmountComponentAtNode(a.panelElement)}}function O(e){const a=(0,u.iY)(),t=(0,o.useMemo)(()=>q.bind(void 0,a),[a]);return(0,d.jsx)(v._,{config:e.config,saveConfig:e.saveConfig,initPanel:t,highestSupportedConfigVersion:1})}O.panelType="Indicator",O.defaultConfig={};const _=(0,j.Z)(O)},49302:(D,f,l)=>{l.d(f,{f:()=>o});var d=l(98127);function o(h){return d.Z(h)}}}]);

//# sourceMappingURL=5807.eb401ebdab883d511086.js.map