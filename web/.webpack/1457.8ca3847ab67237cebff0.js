(()=>{var Ee={72278:y=>{(function(){function $(l){return l[0]}var g={Lexer:void 0,ParserRules:[{name:"main$ebnf$1",symbols:["messagePath"],postprocess:$},{name:"main$ebnf$1",symbols:[],postprocess:function(l){return null}},{name:"main$ebnf$2",symbols:["modifier"],postprocess:$},{name:"main$ebnf$2",symbols:[],postprocess:function(l){return null}},{name:"main",symbols:["topicName","main$ebnf$1","main$ebnf$2"],postprocess:l=>({topicName:l[0].value,topicNameRepr:l[0].repr,messagePath:l[1]||[],modifier:l[2]})},{name:"id$ebnf$1",symbols:[/[a-zA-Z0-9_-]/]},{name:"id$ebnf$1",symbols:["id$ebnf$1",/[a-zA-Z0-9_-]/],postprocess:function(f){return f[0].concat([f[1]])}},{name:"id",symbols:["id$ebnf$1"],postprocess:l=>l[0].join("")},{name:"integer$ebnf$1",symbols:[{literal:"-"}],postprocess:$},{name:"integer$ebnf$1",symbols:[],postprocess:function(l){return null}},{name:"integer$ebnf$2",symbols:[/[0-9]/]},{name:"integer$ebnf$2",symbols:["integer$ebnf$2",/[0-9]/],postprocess:function(f){return f[0].concat([f[1]])}},{name:"integer",symbols:["integer$ebnf$1","integer$ebnf$2"],postprocess:l=>({value:BigInt((l[0]??"")+l[1].join("")),repr:(l[0]??"")+l[1].join("")})},{name:"string$ebnf$1",symbols:[]},{name:"string$ebnf$1",symbols:["string$ebnf$1",/[^']/],postprocess:function(f){return f[0].concat([f[1]])}},{name:"string",symbols:[{literal:"'"},"string$ebnf$1",{literal:"'"}],postprocess:l=>({value:l[1].join(""),repr:`'${l[1].join("")}'`})},{name:"string$ebnf$2",symbols:[]},{name:"string$ebnf$2",symbols:["string$ebnf$2",/[^"]/],postprocess:function(f){return f[0].concat([f[1]])}},{name:"string",symbols:[{literal:'"'},"string$ebnf$2",{literal:'"'}],postprocess:l=>({value:l[1].join(""),repr:`"${l[1].join("")}"`})},{name:"variable$ebnf$1",symbols:["id"],postprocess:$},{name:"variable$ebnf$1",symbols:[],postprocess:function(l){return null}},{name:"variable",symbols:[{literal:"$"},"variable$ebnf$1"],postprocess:(l,f)=>({value:{variableName:l[1]||"",startLoc:f},repr:`$${l[1]||""}`})},{name:"value",symbols:["integer"],postprocess:l=>l[0]},{name:"value",symbols:["string"],postprocess:l=>l[0]},{name:"value$string$1",symbols:[{literal:"t"},{literal:"r"},{literal:"u"},{literal:"e"}],postprocess:function(f){return f.join("")}},{name:"value",symbols:["value$string$1"],postprocess:l=>({value:!0,repr:"true"})},{name:"value$string$2",symbols:[{literal:"f"},{literal:"a"},{literal:"l"},{literal:"s"},{literal:"e"}],postprocess:function(f){return f.join("")}},{name:"value",symbols:["value$string$2"],postprocess:l=>({value:!1,repr:"false"})},{name:"value",symbols:["variable"],postprocess:l=>l[0]},{name:"topicName$ebnf$1",symbols:["slashID"]},{name:"topicName$ebnf$1",symbols:["topicName$ebnf$1","slashID"],postprocess:function(f){return f[0].concat([f[1]])}},{name:"topicName",symbols:["topicName$ebnf$1"],postprocess:l=>({value:l[0].join(""),repr:l[0].join("")})},{name:"topicName$ebnf$2",symbols:[]},{name:"topicName$ebnf$2",symbols:["topicName$ebnf$2","slashID"],postprocess:function(f){return f[0].concat([f[1]])}},{name:"topicName",symbols:["id","topicName$ebnf$2"],postprocess:l=>({value:l[0]+l[1].join(""),repr:l[0]+l[1].join("")})},{name:"topicName",symbols:["quotedString"],postprocess:$},{name:"slashID$ebnf$1",symbols:["id"],postprocess:$},{name:"slashID$ebnf$1",symbols:[],postprocess:function(l){return null}},{name:"slashID",symbols:[{literal:"/"},"slashID$ebnf$1"],postprocess:l=>l.join("")},{name:"quotedString$ebnf$1",symbols:[]},{name:"quotedString$ebnf$1$subexpression$1",symbols:[/[^"\\]/]},{name:"quotedString$ebnf$1$subexpression$1$string$1",symbols:[{literal:"\\"},{literal:"\\"}],postprocess:function(f){return f.join("")}},{name:"quotedString$ebnf$1$subexpression$1",symbols:["quotedString$ebnf$1$subexpression$1$string$1"],postprocess:l=>"\\"},{name:"quotedString$ebnf$1$subexpression$1$string$2",symbols:[{literal:"\\"},{literal:'"'}],postprocess:function(f){return f.join("")}},{name:"quotedString$ebnf$1$subexpression$1",symbols:["quotedString$ebnf$1$subexpression$1$string$2"],postprocess:l=>'"'},{name:"quotedString$ebnf$1",symbols:["quotedString$ebnf$1","quotedString$ebnf$1$subexpression$1"],postprocess:function(f){return f[0].concat([f[1]])}},{name:"quotedString",symbols:[{literal:'"'},"quotedString$ebnf$1",{literal:'"'}],postprocess:l=>({value:l[1].join(""),repr:`"${l[1].join("").replace(/[\\"]/g,f=>`\\${f}`)}"`})},{name:"messagePath$ebnf$1",symbols:[]},{name:"messagePath$ebnf$1",symbols:["messagePath$ebnf$1","messagePathElement"],postprocess:function(f){return f[0].concat([f[1]])}},{name:"messagePath$ebnf$2",symbols:[{literal:"."}],postprocess:$},{name:"messagePath$ebnf$2",symbols:[],postprocess:function(l){return null}},{name:"messagePath",symbols:["messagePath$ebnf$1","messagePath$ebnf$2"],postprocess:l=>l[0].reduce((f,S)=>f.concat(S),[]).concat(l[1]?[{type:"name",name:"",repr:""}]:[])},{name:"messagePathElement$ebnf$1",symbols:["slice"],postprocess:$},{name:"messagePathElement$ebnf$1",symbols:[],postprocess:function(l){return null}},{name:"messagePathElement$ebnf$2",symbols:["filter"],postprocess:$},{name:"messagePathElement$ebnf$2",symbols:[],postprocess:function(l){return null}},{name:"messagePathElement",symbols:[{literal:"."},"name","messagePathElement$ebnf$1","messagePathElement$ebnf$2"],postprocess:l=>[l[1],l[2],l[3]].filter(f=>f!==null)},{name:"messagePathElement",symbols:["filter"],postprocess:$},{name:"name",symbols:["id"],postprocess:l=>({type:"name",name:l[0],repr:l[0]})},{name:"name",symbols:["quotedString"],postprocess:l=>({type:"name",name:l[0].value,repr:l[0].repr})},{name:"sliceVal",symbols:["integer"],postprocess:l=>Number(l[0].value)},{name:"sliceVal",symbols:["variable"],postprocess:l=>l[0].value},{name:"slice",symbols:[{literal:"["},"sliceVal",{literal:"]"}],postprocess:l=>({type:"slice",start:l[1],end:l[1]})},{name:"slice$ebnf$1",symbols:["sliceVal"],postprocess:$},{name:"slice$ebnf$1",symbols:[],postprocess:function(l){return null}},{name:"slice$ebnf$2",symbols:["sliceVal"],postprocess:$},{name:"slice$ebnf$2",symbols:[],postprocess:function(l){return null}},{name:"slice",symbols:[{literal:"["},"slice$ebnf$1",{literal:":"},"slice$ebnf$2",{literal:"]"}],postprocess:l=>({type:"slice",start:l[1]===null?0:l[1],end:l[3]===null?1/0:l[3]})},{name:"simplePath$ebnf$1",symbols:[]},{name:"simplePath$ebnf$1$subexpression$1",symbols:[{literal:"."},"id"]},{name:"simplePath$ebnf$1",symbols:["simplePath$ebnf$1","simplePath$ebnf$1$subexpression$1"],postprocess:function(f){return f[0].concat([f[1]])}},{name:"simplePath",symbols:["id","simplePath$ebnf$1"],postprocess:l=>[l[0]].concat(l[1].map(f=>f[1]))},{name:"filter$ebnf$1",symbols:["simplePath"],postprocess:$},{name:"filter$ebnf$1",symbols:[],postprocess:function(l){return null}},{name:"filter",symbols:[{literal:"{"},"filter$ebnf$1",{literal:"}"}],postprocess:(l,f)=>({type:"filter",path:l[1]||[],value:void 0,nameLoc:f+1,valueLoc:f+1,repr:(l[1]||[]).join(".")})},{name:"filter$ebnf$2",symbols:["simplePath"],postprocess:$},{name:"filter$ebnf$2",symbols:[],postprocess:function(l){return null}},{name:"filter$string$1",symbols:[{literal:"="},{literal:"="}],postprocess:function(f){return f.join("")}},{name:"filter",symbols:[{literal:"{"},"filter$ebnf$2","filter$string$1","value",{literal:"}"}],postprocess:(l,f)=>({type:"filter",path:l[1]||[],value:l[3].value,nameLoc:f+1,valueLoc:f+1+(l[1]||[]).join(".").length+l[2].length,repr:`${(l[1]||[]).join(".")}==${l[3].repr}`})},{name:"modifier$string$1",symbols:[{literal:"."},{literal:"@"}],postprocess:function(f){return f.join("")}},{name:"modifier$ebnf$1",symbols:["id"],postprocess:$},{name:"modifier$ebnf$1",symbols:[],postprocess:function(l){return null}},{name:"modifier",symbols:["modifier$string$1","modifier$ebnf$1"],postprocess:l=>l[1]||""}],ParserStart:"main"};typeof y.exports<"u"?y.exports=g:window.grammar=g})()},21457:(y,$,g)=>{"use strict";var l=g(90758),f=g(96389),S=g(44668);function R(e){return f.zGw(f.UID(t=>t.x.length),f.Smz)(e)}function*B(e){let t=0;for(const n of e){if(n==null){t++;continue}const{x:s,y:r,label:a}=n;yield{index:t,x:s,y:r,label:a},t++}}function*N(e){const t={index:0,label:void 0};let n=0;for(const s of e){const r=f.YMb(f.VO0(s));if(r!=null)for(let a=0;a<r.length;a++){for(const o of f.XPQ(s))t[o]=s[o]?.[a];t.index=n,n++,yield t}}}function O(e,t){let n=t;for(let s=0;s<e.length;s++){const r=e[s];if(r==null)continue;const{x:{length:a}}=r;if(n===a&&s===e.length-1)return[s,n];if(n>=a){n-=a;continue}return[s,n]}}var J=g(77068),Ne=g(43614),mt=g(72278),pt=g.n(mt);const re=Ne.Grammar.fromCompiled(pt());function bt(e){return e.match(/^[a-zA-Z0-9_/-]+$/)?e:`"${e.replace(/[\\"]/g,t=>`\\${t}`)}"`}function Is(e){return e.match(/^[a-zA-Z0-9_-]+$/)?e:`"${e.replace(/[\\"]/g,t=>`\\${t}`)}"`}const ae=J.Z(e=>{const t=new Ne.Parser(re);try{return t.feed(e).results[0]}catch{return}});var gt=g(71747);const Ce=(0,gt.Z)({insensitive:!0});function Cs(e){return e==null?Ce:(t,n)=>Ce(t[e],n[e])}const Ds=null,ht=Object.keys({bool:void 0,int8:void 0,uint8:void 0,int16:void 0,uint16:void 0,int32:void 0,uint32:void 0,int64:void 0,uint64:void 0,float32:void 0,float64:void 0,string:void 0}),yt=null;function vt(e){return ht.includes(e)}function xt(e){return e.structureType==="primitive"&&yt.includes(e.primitiveType)}function Tt(e){const t=J.Z((s,r)=>{const a={},o=e.get(s);if(!o){if(s==="time"||s==="duration")return{structureType:"message",nextByName:{sec:{structureType:"primitive",primitiveType:"uint32",datatype:""},nsec:{structureType:"primitive",primitiveType:"uint32",datatype:""}},datatype:s};throw new Error(`datatype not found: "${s}"`)}for(const i of o.definitions){if(i.isConstant===!0||r.includes(i.type))continue;const c=vt(i.type)?{structureType:"primitive",primitiveType:i.type,datatype:s}:t(i.type,[...r,i.type]);i.isArray===!0?a[i.name]={structureType:"array",next:c,datatype:s}:a[i.name]=c}return{structureType:"message",nextByName:a,datatype:s}}),n={};for(const[s]of e)n[s]=t(s,[]);return n}function $t(e,t){return!!e&&(!t||t.includes(e.structureType)||t.includes(e.datatype)||e.structureType==="primitive"&&t.includes(e.primitiveType))}function Ls(e,{validTypes:t,noMultiSlices:n,messagePath:s=[]}={}){let r=[...s];const a=[];function o(i,c){if($t(i,t)&&a.push(c),i.structureType==="message")for(const[u,d]of Object.entries(i.nextByName))o(d,`${c}.${quoteFieldNameIfNeeded(u)}`);else if(i.structureType==="array")if(i.next.structureType==="message"){const u=Object.entries(i.next.nextByName).find(([d])=>isTypicalFilterName(d));if(u){const[d,m]=u,p=r.find(b=>b.type==="filter"&&b.path[0]===d);p?(r=r.filter(b=>b!==p),o(i.next,`${c}[:]{${d}==${typeof p.value=="object"?`$${p.value.variableName}`:p.value}}`)):xt(m)?o(i.next,`${c}[:]{${d}==0}`):o(i.next,`${c}[0]`)}else o(i.next,`${c}[0]`)}else n!==!0?o(i.next,`${c}[:]`):o(i.next,`${c}[0]`)}return o(e,""),a.sort(naturalSort())}const ks=(e,t)=>{let n=e;if(!n)return{valid:!1,msgPathPart:void 0,structureItem:void 0};for(const s of t){if(!n)return{valid:!1,msgPathPart:s,structureItem:n};if(s.type==="name"){if(n.structureType!=="message")return{valid:!1,msgPathPart:s,structureItem:n};n=n.nextByName[s.name]}else if(s.type==="slice"){if(n.structureType!=="array")return{valid:!1,msgPathPart:s,structureItem:n};n=n.next}else if(s.type==="filter"){if(n.structureType!=="message"||s.path.length===0||s.value==null)return{valid:!1,msgPathPart:s,structureItem:n};let r=n;for(const a of s.path){if(r.structureType!=="message")return{valid:!1,msgPathPart:s,structureItem:n};if(r=r.nextByName[a],r==null)return{valid:!1,msgPathPart:s,structureItem:n}}}else assertNever(s,`Invalid msgPathPart.type: ${s.type}`)}return{valid:!0,msgPathPart:void 0,structureItem:n}};var oe=g(2784),As=g(88665);function Fs(e,{initiallyTrue:t}){const n=useRef(t?void 0:e),s=!shallowequal(n.current,e);return n.current=e,s}function Bs(e){const t=useRef(e);return _.isEqual(e,t.current)?t.current:(t.current=e,e)}function Os(e,t){const n=useContext(e);if(n==null)throw new Error(`useGuaranteedContext got null for contextType${t!=null?`: '${t}'`:""}`);return n}const Q=new Map,D=()=>{};class ee{static default=new ee("");#e;constructor(t){this.#e=t,this.setLevel("debug"),Q.set(t,this)}name(){return this.#e}isLevelOn(t){switch(t){case"debug":return this.debug!==D;case"info":return this.info!==D;case"warn":return this.warn!==D;case"error":return this.error!==D}return!1}getLevel(){return this.debug!==D?"debug":this.info!==D?"info":this.warn!==D?"warn":"error"}setLevel(t){switch(this.debug=D,this.info=D,this.warn=D,this.error=D,t){case"debug":this.debug=console.debug.bind(g.g.console),this.info=console.info.bind(g.g.console),this.warn=console.warn.bind(g.g.console),this.error=console.error.bind(g.g.console);break;case"info":this.info=console.info.bind(g.g.console),this.warn=console.warn.bind(g.g.console),this.error=console.error.bind(g.g.console);break;case"warn":this.warn=console.warn.bind(g.g.console),this.error=console.error.bind(g.g.console);break;case"error":this.error=console.error.bind(g.g.console);break}}debug(...t){}info(...t){}warn(...t){}error(...t){}getLogger(t){const n=t.replace(/^.+\.(asar|webpack)[\\/\\]/,"").replace(/^(\.\.\/)+/,""),s=this.#e.length>0?`${this.#e}.${n}`:n,r=Q.get(s);if(r)return r;const a=new ee(s);return Q.set(s,a),a}channels(){return Array.from(Q.values())}}function Vs(e){switch(e){case"debug":return"debug";case"info":return"info";case"warn":return"warn";case"error":return"error";default:return"warn"}}const L=ee.default;var Pt="../../packages/hooks/src/useMustNotChange.ts";const St=L.getLogger(Pt),js=e=>{const t=useRef(e);t.current!==e&&St.error("Value must not change",t.current),t.current=e},_s=()=>{},Gs=null,Ws=null;function Us(e){const[,t]=useState(void 0);return useCallback((...n)=>{try{return e(...n)}catch(s){t(()=>{throw s})}},[e])}function zs(e){const t=useRef(e);return shallowequal(e,t.current)?t.current:(t.current=e,e)}var Mt="../../packages/hooks/src/useValueChangedDebugLog.ts";const wt=L.getLogger(Mt),Hs=()=>{};function Ys(e,t){const n=useRef(e);n.current!==e&&wt.debug(`value changed: ${t}`),useLayoutEffect(()=>{n.current=e})}const Zs=null,qs=null;function Xs(){const[e,t]=useState(document.visibilityState);return useEffect(()=>{t(document.visibilityState);const n=()=>{t(document.visibilityState)};return document.addEventListener("visibilitychange",n),()=>{document.removeEventListener("visibilitychange",n)}},[]),e}var Et="../../packages/hooks/src/useWarnImmediateReRender.ts";const Ks=L.getLogger(Et),Js=null,Qs=null;var It="../../packages/hooks/src/useMemoryInfo.ts";const Nt=L.getLogger(It);function er(e){const{refreshIntervalMs:t}=e,[n,s]=useState(window.performance.memory);return useEffect(()=>{if(!window.performance.memory){Nt.info("No memory information available");return}const r=setInterval(()=>{s(window.performance.memory)},t);return()=>{clearInterval(r)}},[t]),n}var Ct="../../packages/hooks/src/selectWithUnstableIdentityWarning.ts";const tr=L.getLogger(Ct);function nr(e,t){return t(e)}function Dt(e,t){throw t}function sr(){const[,e]=useReducer(Dt,void 0);return e}function rr(e){const[t,n]=useState(sessionStorage.getItem(e)??void 0),s=useCallback(a=>{a?(sessionStorage.setItem(e,a),window.dispatchEvent(new StorageEvent("storage",{key:e,newValue:a,storageArea:sessionStorage}))):(sessionStorage.removeItem(e),window.dispatchEvent(new StorageEvent("storage",{key:e,newValue:void 0,storageArea:sessionStorage})))},[e]),r=useCallback(a=>{a.key===e&&n(a.newValue??void 0)},[e]);return useEffect(()=>(window.addEventListener("storage",r),()=>{window.removeEventListener("storage",r)}),[r]),[t??void 0,s]}function ar(){const e=useRef(!1),t=useCallback(()=>e.current,[]);return useLayoutEffect(()=>(e.current=!0,()=>{e.current=!1}),[]),t}var or=g(52322),De;(function(e){e.COLOR_SCHEME="colorScheme",e.TIMEZONE="timezone",e.TIME_FORMAT="time.format",e.MESSAGE_RATE="messageRate",e.UPDATES_ENABLED="updates.enabled",e.LANGUAGE="language",e.ROS_PACKAGE_PATH="ros.ros_package_path",e.TELEMETRY_ENABLED="telemetry.telemetryEnabled",e.CRASH_REPORTING_ENABLED="telemetry.crashReportingEnabled",e.SHOW_DEBUG_PANELS="showDebugPanels",e.HIDE_SIGN_IN_PROMPT="hideSignInPrompt",e.LAUNCH_PREFERENCE="launchPreference",e.SHOW_OPEN_DIALOG_ON_STARTUP="ui.open-dialog-startup",e.ENABLE_LAYOUT_DEBUGGING="enableLayoutDebugging",e.ENABLE_MEMORY_USE_INDICATOR="dev.memory-use-indicator"})(De||(De={}));const Re=(0,oe.createContext)(void 0);Re.displayName="AppConfigurationContext";function ir(){const e=useContext(Re);if(!e)throw new Error("An AppConfigurationContext provider is required to useAppConfiguration");return e}const cr=null;function ur(e){const t=useAppConfiguration(),[n,s]=useState(()=>{const a=t.get(e);if(!(typeof a=="string"&&a.length===0))return a});useEffect(()=>{const a=o=>{s(o)};return t.addChangeListener(e,a),()=>{t.removeChangeListener(e,a)}},[e,t]);const r=useCallback(async a=>{s(a),await t.set(e,a)},[t,e]);return[n,r]}function Rt(e){return e.sec<0||e.nsec<0?(L.error("Times are not allowed to be negative"),"(invalid negative time)"):`${e.sec}.${e.nsec.toFixed().padStart(9,"0")}`}const Lt=null;function lr(e){return e.sec>Lt}function fr({sec:e,nsec:t}){return`${e}.${String.prototype.padStart.call(t,9,"0")}`}function dr(e,t){return t==="headerStamp"?Le(e.message):e.receiveTime}function Le(e){if(e.header!=null){const t=e.header?.stamp;if(t!=null&&"sec"in t&&"nsec"in t)return t}else if(e.markers?.[0]?.header!=null){const t=e.markers[0]?.header.stamp;if(t!=null&&"sec"in t&&"nsec"in t)return t}}var kt="../../packages/studio-base/src/components/MessagePipeline/MessageOrderTracker.ts";const At=1,Ft=1,Bt=L.getLogger(kt);class mr{#e=[];#r;#n;#a;#o;#t;#i=!1;#s=[];update(t){if(!t.activeData)return[];const n=[],{messages:s,currentTime:r,lastSeekTime:a}=t.activeData;let o=!1;if(this.#o!==a&&(this.#o=a,this.#t&&(clearTimeout(this.#t),this.#t=void 0,this.#s=[]),this.#t=this.#n=this.#r=void 0,this.#e=[],o=!0),this.#e!==s||this.#r!==r){this.#e=s,this.#r=r;for(const i of s){const c=i.receiveTime;if(o||Math.abs(toSec(subtractTimes(c,r)))>At&&(this.#i&&this.#s.push(i),this.#t||(this.#t=setTimeout(()=>{this.#t=void 0;const d={currentTime:r,lastSeekTime:a,messageTime:c,incorrectMessages:this.#i?this.#s:"not being tracked"};this.#s=[],Bt.warn("Message receiveTime very different from player.currentTime; without updating lastSeekTime",d)},Ft*1e3))),this.#n&&this.#a!=null&&isLessThan(c,this.#n)){const u=formatFrame(c),d=formatFrame(this.#n),m=`Processed a message on ${i.topic} at ${u} which is earlier than last processed message on ${this.#a} at ${d}.`;n.push({severity:"warn",message:"Data went back in time",error:new Error(m)})}this.#a=i.topic,this.#n=c}}return n}}const pr=null;var br=g(79044);class gr{value;#e=new Mutex;constructor(t){this.value=t}async runExclusive(t){return await this.#e.runExclusive(async()=>await t(this.value))}}const ke=g.g;function Ot(e){ke.foxgloveStudioReportErrorFn?.(e)}function hr(e){ke.foxgloveStudioReportErrorFn=e}class Vt extends Error{details;extraInfo;message;constructor(t,n){if(super(),this.details=t,this.extraInfo=n,this.name="AppError",this.message="",t instanceof Error?this.message=t.stack??t.message:typeof t=="string"&&(this.message=t),n!=null)if(n.componentStack!=null)this.message+=`

${n.componentStack}`;else try{const s=JSON.stringify(n);this.message+=`

${s}`}catch{this.message+=`

[ Either cyclic object or object with BigInt(s) ]`}this.message===""&&(this.message="Unknown Error")}}const jt=()=>typeof g.g.postMessage<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope,yr=()=>typeof SharedWorkerGlobalScope<"u"&&self instanceof SharedWorkerGlobalScope,vr=e=>{const t=typeof fetch<"u"&&fetch("data:test").then(()=>!0).catch(()=>!1);return async(...n)=>{if(await t)throw new Error("Content security policy too loose.");return e(...n)}},te=(e,t,n,s)=>{if(jt()){(s==="error"?console.error:s==="warn"?console.warn:console.info)("Web Worker has uninitialized sendNotification function; this means this error message cannot show up in the UI (so we show it here in the console instead).",e,t,n);return}console.error("Notification before error display is mounted",e,t,n)};let G=te;function xr(e){if(G!==te)throw new Error("Tried to overwrite existing NotificationHandler");G=e}function Tr(){if(G===te)throw new Error("Tried to unset NotificationHandler but it was already the default");G=te}function _t(e,t,n,s){n==="app"&&(s==="warn"||s==="error")&&Ot(new Vt(t,e)),G(e,t,n,s)}_t.expectCalledDuringTest=()=>{throw new Error("Should be overriden in setupTestFramework.ts")};const Gt=5e3;async function $r(e){try{await promiseTimeout(Promise.all(e.map(async({promise:t})=>{await t})),Gt)}catch(t){if(!(t instanceof PromiseTimeoutError)){sendNotification("Player ",t,"app","error");return}}}var Ae;(function(e){e.NOT_PRESENT="NOT_PRESENT",e.INITIALIZING="INITIALIZING",e.RECONNECTING="RECONNECTING",e.BUFFERING="BUFFERING",e.PRESENT="PRESENT",e.ERROR="ERROR"})(Ae||(Ae={}));const Pr={advertise:"advertise",assets:"assets",callServices:"callServices",setSpeed:"setSpeed",playbackControl:"playbackControl",getParameters:"getParameters",setParameters:"setParameters"};function Fe(){return{presence:PlayerPresence.NOT_PRESENT,progress:{},capabilities:[],profile:void 0,playerId:"",activeData:void 0}}function Sr({promisesToWaitForRef:e,initialPlayer:t}){return createStore((n,s)=>({player:t,publishersById:{},allPublishers:[],subscriptionMemoizer:makeSubscriptionMemoizer(),subscriptionsById:new Map,subscriberIdsByTopic:new Map,newTopicsBySubscriberId:new Map,lastMessageEventByTopic:new Map,lastCapabilities:[],dispatch(r){n(a=>zt(a,r))},reset(){n(r=>({...r,publishersById:{},allPublishers:[],subscriptionMemoizer:makeSubscriptionMemoizer(),subscriptionsById:new Map,subscriberIdsByTopic:new Map,newTopicsBySubscriberId:new Map,lastMessageEventByTopic:new Map,lastCapabilities:[],public:{...r.public,playerState:Fe(),messageEventsBySubscriberId:new Map,subscriptions:[],sortedTopics:[],datatypes:new Map,startPlayback:void 0,playUntil:void 0,pausePlayback:void 0,setPlaybackSpeed:void 0,seekPlayback:void 0}}))},public:{playerState:Fe(),messageEventsBySubscriberId:new Map,subscriptions:[],sortedTopics:[],datatypes:new Map,setSubscriptions(r,a){s().dispatch({type:"update-subscriber",id:r,payloads:a})},setPublishers(r,a){s().dispatch({type:"set-publishers",id:r,payloads:a}),s().player?.setPublishers(s().allPublishers)},setParameter(r,a){s().player?.setParameter(r,a)},publish(r){s().player?.publish(r)},async callService(r,a){const o=s().player;if(!o)throw new Error("callService called when player is not present");return await o.callService(r,a)},async fetchAsset(r,a){const{protocol:o}=new URL(r),i=s().player;if(i?.fetchAsset&&o==="package:")try{return await i.fetchAsset(r)}catch(u){if(!isDesktopApp())throw u}const c=await fetch(r,a);if(!c.ok){const u=c.statusText;throw new Error(`Error ${c.status}${u?` (${u})`:""}`)}return{uri:r,data:new Uint8Array(await c.arrayBuffer()),mediaType:c.headers.get("content-type")??void 0}},startPlayback:void 0,playUntil:void 0,pausePlayback:void 0,setPlaybackSpeed:void 0,seekPlayback:void 0,pauseFrame(r){const a=new Condvar;return e.current.push({name:r,promise:a.wait()}),()=>{a.notifyAll()}}}}))}function Wt(e,t){const n=e.subscriptionsById,s=new Map(e.newTopicsBySubscriberId),r=s.get(t.id);if(r){const c=n.get(t.id),u=new Set(c?.map(d=>d.topic)??[]);for(const{topic:d}of t.payloads)u.has(d)||r.add(d)}else{const c=t.payloads.map(u=>u.topic);s.set(t.id,new Set(c))}const a=new Map(n);t.payloads.length===0?a.delete(t.id):a.set(t.id,t.payloads);const o=new Map;for(const[c,u]of a)for(const d of u){const m=d.topic,p=o.get(m)??[];p.push(c),o.set(m,p)}const i=mergeSubscriptions(Array.from(a.values()).flat());return{...e,subscriptionsById:a,subscriberIdsByTopic:o,newTopicsBySubscriberId:s,public:{...e.public,subscriptions:i}}}function Ut(e,t){const n=t.playerState.activeData?.messages,s=new Set,r=new Map,a=e.subscriptionsById,o=e.subscriberIdsByTopic,i=e.lastMessageEventByTopic,c=new Map(e.newTopicsBySubscriberId);if(n&&n!==e.public.playerState.activeData?.messages)for(const b of n){i.set(b.topic,b),s.add(b.topic);const T=o.get(b.topic);if(T)for(const h of T){let v=r.get(h);v||(v=[],r.set(h,v)),v.push(b)}}for(const b of a.keys()){const T=c.get(b);if(T){for(const h of T){if(s.has(h))continue;const v=i.get(h);if(v){const x=r.get(b)??[];x.unshift(v),r.set(b,x)}}T.clear()}}const u={...e.public,playerState:t.playerState,messageEventsBySubscriberId:r},d=t.playerState.activeData?.topics;d!==e.public.playerState.activeData?.topics&&(u.sortedTopics=d?[...d].sort((b,T)=>b.name.localeCompare(T.name)):[]),t.playerState.activeData?.datatypes!==e.public.playerState.activeData?.datatypes&&(u.datatypes=t.playerState.activeData?.datatypes??new Map);const m=t.playerState.capabilities,p=e.player;return p&&!shallowequal(m,e.lastCapabilities)&&(u.startPlayback=m.includes(PlayerCapabilities.playbackControl)?p.startPlayback?.bind(p):void 0,u.playUntil=m.includes(PlayerCapabilities.playbackControl)?p.playUntil?.bind(p):void 0,u.pausePlayback=m.includes(PlayerCapabilities.playbackControl)?p.pausePlayback?.bind(p):void 0,u.setPlaybackSpeed=m.includes(PlayerCapabilities.setSpeed)?p.setPlaybackSpeed?.bind(p):void 0,u.seekPlayback=m.includes(PlayerCapabilities.playbackControl)?p.seekPlayback?.bind(p):void 0),{...e,newTopicsBySubscriberId:c,renderDone:t.renderDone,public:u,lastCapabilities:m,lastMessageEventByTopic:i}}function zt(e,t){switch(t.type){case"update-player-state":return Ut(e,t);case"update-subscriber":return Wt(e,t);case"set-publishers":{const n={...e.publishersById,[t.id]:t.payloads};return{...e,publishersById:n,allPublishers:_.flatten(Object.values(n))}}}assertNever(t,`Unhandled message pipeline action type ${t.type}`)}const ie=(0,oe.createContext)(void 0);function Mr(){const e=useGuaranteedContext(ie);return useCallback(()=>e.getState().public,[e])}function wr(e){const t=useGuaranteedContext(ie);return useStore(t,useCallback(n=>e(n.public),[e]))}const Ht=e=>e.renderDone,Yt=e=>e.public.subscriptions;function Er({children:e,player:t,globalVariables:n}){const s=useRef([]),r=useMemo(()=>createMessagePipelineStore({promisesToWaitForRef:s,initialPlayer:t}),[t]),a=useStore(r,Yt),o=useMemo(()=>_.debounce(d=>{t?.setSubscriptions(d)}),[t]);useEffect(()=>()=>{o.cancel()},[o]),useEffect(()=>o(a),[o,a]);const[i]=useAppConfigurationValue(AppSetting.MESSAGE_RATE),c=useStore(r,Ht);useLayoutEffect(()=>{c?.()},[c]);const u=useRef(16);return u.current=1e3/(i??60),useEffect(()=>{const d=r.getState().dispatch;if(!t){d({type:"update-player-state",playerState:defaultPlayerState(),renderDone:void 0});return}const{listener:m,cleanupListener:p}=qt({msPerFrameRef:u,promisesToWaitForRef:s,store:r});return t.setListener(m),()=>{p(),t.close(),d({type:"update-player-state",playerState:defaultPlayerState(),renderDone:void 0})}},[t,r]),useEffect(()=>{t?.setGlobalVariables(n)},[t,n]),_jsx(ie.Provider,{value:r,children:e})}function Zt(e,t){return t.length===0?e:{...e,problems:t.concat(e.problems??[])}}function qt(e){const{msPerFrameRef:t,promisesToWaitForRef:n,store:s}=e,r=s.getState().dispatch,a=new MessageOrderTracker;let o=!1,i,c;return{listener:async d=>{if(o)return;if(c)throw new Error("New playerState was emitted before last playerState was rendered.");const m=a.update(d),p=Zt(d,m),b=new Promise(x=>{c=()=>{c=void 0,x()}}),T=Date.now();let h=!1;function v(){if(h)return;h=!0;const x=Date.now()-T,w=Math.max(0,t.current-x);setTimeout(async()=>{if(o)return;const E=n.current;E.length>0&&(n.current=[],await pauseFrameForPromises(E)),c&&c()},w)}i!=null&&d.playerId!==i&&s.getState().reset(),i=d.playerId,r({type:"update-player-state",playerState:p,renderDone:v}),await b},cleanupListener(){o=!0,c=void 0}}}function Xt(e){return e.datatypes}function Kt(e){return e.sortedTopics}function Jt(e){return e.playerState.activeData?.startTime}function Qt(e){return e.playerState.capabilities}function en(e){return e.playerState.playerId}function Ir(){const e=useMessagePipeline(Xt),t=useMessagePipeline(Kt),n=useMessagePipeline(Jt),s=useMessagePipeline(Qt),r=useMessagePipeline(en);return useMemo(()=>({topics:t,datatypes:e,capabilities:s,startTime:n,playerId:r}),[s,e,r,n,t])}function Nr(e,t){const n=useRef(e),s=useRef(e),r=useRef(Date.now());return e!==n.current&&n.current!==s.current&&Date.now()-r.current<200&&t(),s.current=n.current,n.current=e,r.current=Date.now(),e}var tn="../../packages/studio-base/src/PanelAPI/useMessageReducer.ts";const ce=L.getLogger(tn);function nn(e){return e.setSubscriptions}function Cr(e){const[t]=useState(()=>uuidv4()),{restore:n,addMessage:s,addMessages:r,preloadType:a="partial"}=e;if([e.addMessage,e.addMessages].filter(Boolean).length!==1)throw new Error("useMessageReducer must be provided with exactly one of addMessage or addMessages");useShouldNotChangeOften(e.restore,()=>{ce.warn("useMessageReducer restore() is changing frequently. restore() will be called each time it changes, so a new function shouldn't be created on each render. (If you're using Hooks, try useCallback.)")}),useShouldNotChangeOften(e.addMessage,()=>{ce.warn("useMessageReducer addMessage() is changing frequently. addMessage() will be called each time it changes, so a new function shouldn't be created on each render. (If you're using Hooks, try useCallback.)")}),useShouldNotChangeOften(e.addMessages,()=>{ce.warn("useMessageReducer addMessages() is changing frequently. addMessages() will be called each time it changes, so a new function shouldn't be created on each render. (If you're using Hooks, try useCallback.)")});const o=useShallowMemo(e.topics),i=useMemo(()=>o.map(d=>typeof d=="string"?{topic:d,preloadType:a}:d),[a,o]),c=useMessagePipeline(nn);useEffect(()=>{c(t,i)},[t,c,i]),useEffect(()=>()=>{c(t,[])},[t,c]);const u=useRef();return useMessagePipeline(useCallback(function(m){const p=m.messageEventsBySubscriberId.get(t),b=m.playerState.activeData?.lastSeekTime;let T;if(!u.current||b!==u.current.lastSeekTime?T=n(void 0):n!==u.current.restore||s!==u.current.addMessage||r!==u.current.addMessages?T=n(u.current.reducedValue):T=u.current.reducedValue,p&&p.length>0&&p!==u.current?.messageEvents){if(r)p.length>0&&(T=r(T,p));else if(s)for(const h of p)T=s(T,h)}return u.current={messageEvents:p,lastSeekTime:b,reducedValue:T,restore:n,addMessage:s,addMessages:r},u.current.reducedValue},[t,s,r,n]))}function Dr(e){const{historySize:t,topics:n}=e,s=useDeepMemo(n),r=useCallback((o,i)=>{const c=_.groupBy(i,"topic"),u={...o};return Object.entries(c).forEach(([d,m])=>{const p=u[d];p&&(u[d]=concatAndTruncate(p,m,t))}),u},[t]),a=useCallback(o=>{const i={};for(const c of s){const u=typeof c=="string"?c:c.topic,d=o?.[u];i[u]=d?.slice(-t)??[]}return i},[s,t]);return useMessageReducer({topics:s,restore:a,addMessages:r})}var sn=g(5817),rn=g.n(sn);const an=rn()((e,t)=>{if(!e)return{};const n={};for(const s of t){const r=typeof s=="string"?s:s.topic,a=e.messagesByTopic[r];a&&(n[r]=a)}return n}),on=e=>{const[t]=useState(()=>uuidv4()),n=useMessagePipeline(useCallback(({setSubscriptions:s})=>s,[]));useEffect(()=>{n(t,e)},[t,n,e]),useEffect(()=>()=>{n(t,[])},[t,n])};function Rr(e){const t=useMemo(()=>e.map(r=>r.topic),[e]);on(e);const n=useMessagePipeline(useCallback(r=>r.playerState.progress.messageCache?.blocks,[]));return useMemo(()=>n?n.map(r=>an(r,t)):[],[n,t])}var cn="../../packages/studio-base/src/util/layout.ts";const Be=L.getLogger(cn),Lr="foxglovePanelTitle";function Oe(e){const n=Math.round(Math.random()*1e10).toString(36);return`${e}!${n}`}function ue(e){return e.split("!")[0]??""}function ne(e){return ue(e)===TAB_PANEL_TYPE}function kr(e){return e!=null&&"tabs"in e&&"activeTabIdx"in e}function le(e,t,n=[]){if(t===e)return n;if(t!=null&&isParent(t)){const s=le(e,t.first,[...n,"first"]);if(s.length>0)return s;const r=le(e,t.second,[...n,"second"]);if(r.length>0)return r}return[]}function un(e){const t={};for(const n of e)t[n]=Oe(ue(n));return t}function Ve(e,t){if(typeof e=="string")return t[e]??Oe(ue(e));if(e==null)return;const n={};for(const s in e)typeof e[s]=="object"&&!Array.isArray(e[s])?n[s]=Ve(e[s],t):typeof e[s]=="string"&&t[e[s]]!=null?n[s]=t[e[s]]:n[s]=e[s];return n}function je(e){if(typeof e=="string")return e;const t=[e.first,e.second].filter(Boolean).map(je),[n,s]=t;return n==null&&s==null?"":n!=null&&s!=null?{...e,first:n,second:s}:{...e,first:n??s??"",second:""}}function fe(e,t){return typeof e=="string"?t(e):{...e,first:fe(e.first,t),second:fe(e.second,t)}}function ln(e,t,n){const s=fe(e,r=>{if(typeof r=="string"&&ne(r)&&!n.includes(r)){const a=W(r,t),o=a.tabs[a.activeTabIdx]?.layout;if(o!=null)return ln(o,t,n)}return r});return je(s)}const Ar=e=>Object.entries(e).reduce((t,[n,s])=>(ne(n)&&s!=null&&s.tabs?.forEach(a=>{getLeaves(a.layout??null).forEach(i=>t[i]=n)}),t),{}),fn=e=>({id:t,config:n})=>n.tabs?{id:t,config:{...n,tabs:n.tabs.map(s=>({...s,layout:Ve(s.layout,e)}))}}:{id:t,config:n},Fr=({id:e,config:t,relatedConfigs:n})=>{if(!n)return{configs:[{id:e,config:t}]};const s=de([e],{[e]:t}),r=un(s);return{configs:[...filterMap(s,i=>{const c=r[i],u=n[i];if(!(c==null||u==null))return{id:c,config:u}}),{id:e,config:t}].map(fn(r))}};function de(e,t){const n=e.filter(ne),s=[];return n.forEach(r=>{const a=t[r];a?.tabs&&a.tabs.forEach(o=>{s.push(o.layout,...de(getLeaves(o.layout??null),t))})}),_.flatMap(s,getLeaves)}const me={activeTabIdx:0,tabs:[{title:"1",layout:void 0}]};function Br(e,t){const n=getLeaves(e),s=de(n,t);return[...n,...s]}const pe=e=>{if(!e)return!1;if(!Array.isArray(e.tabs)||typeof e.activeTabIdx!="number"){const t=new Error("A non-Tab panel config is being operated on as if it were a Tab panel.");return Be.info(`Invalid Tab panel config: ${t.message}`,e),reportError(t),!1}if(e.activeTabIdx>=e.tabs.length){const t=new Error("A Tab panel has an activeTabIdx for a nonexistent tab.");return Be.info(`Invalid Tab panel config: ${t.message}`,e),reportError(t),!1}return!0},be=(e,t)=>{const n=t.tabs.map((s,r)=>r===t.activeTabIdx?{...s,layout:e}:s);return t.activeTabIdx===-1&&n.push({layout:e,title:"1"}),{...t,tabs:n,activeTabIdx:Math.max(0,t.activeTabIdx)}},Or=(e=[],t,n)=>{if(!pe(t))return{configs:[]};const s=t.tabs[t.activeTabIdx]?.layout;let r;if(e.length===0)r=void 0;else{const o=createRemoveUpdate(s??null,e);r=updateTree(s,[o])}return{configs:[{id:n,config:be(r,t)}]}},dn=(e,t,n,s)=>{if(e==null)return[];const r=getNodeAtPath(e,n),a=s==="left"||s==="top",[o,i]=a?[t,r]:[r,t];return[{path:n,spec:{$set:{first:o,second:i,direction:s==="left"||s==="right"?"row":"column"}}}]},Vr=(e,t,n,s,r)=>{const a=pe(s)?s:me,o=a.tabs[a.activeTabIdx]?.layout,i=o!=null&&t&&n!=null?updateTree(o,dn(o,e,t,n)):e;return{configs:[{id:r,config:be(i,a)}]}};function W(e,t){const n=t[e];return n&&pe(n)?n:me}const jr=({source:e,target:t,savedProps:n})=>{const{tabs:s,activeTabIdx:r}=W(e.panelId,n),a=e.tabIndex??s.length-1,o=t.tabIndex??s.length-1,i=[...s.slice(0,a),...s.slice(a+1)];i.splice(o,0,s[a]);const c=r===e.tabIndex,u=o<=r&&a>=r,d=a<=r&&o>=r;let m=r;return c?m=o:u?m++:d&&m--,{configs:[{id:e.panelId,config:{tabs:i,activeTabIdx:m}}]}},_r=({source:e,target:t,savedProps:n})=>{const s=W(e.panelId,n),r=W(t.panelId,n),a=e.tabIndex??s.tabs.length,o=t.tabIndex??r.tabs.length,i=[...s.tabs.slice(0,a),...s.tabs.slice(a+1)],c=r.tabs.slice();c.splice(o,0,s.tabs[a]);const d=a<=s.activeTabIdx?Math.max(0,s.activeTabIdx-1):s.activeTabIdx,p=o<=r.activeTabIdx?r.activeTabIdx+1:r.activeTabIdx;return{configs:[{id:e.panelId,config:{tabs:i,activeTabIdx:d}},{id:t.panelId,config:{tabs:c,activeTabIdx:p}}]}},mn=(e,t)=>{const{originalId:n,newId:s,idsToRemove:r=[]}=e,a=getLeaves(t);return _.xor(a,r).length===0?s:_.uniq(_.compact([...r,n])).reduce((o,i)=>{if(a.includes(i)){if(o===n)return s;if(o==null||o===i)return}else return o;const c=le(i,o),u=i===n?{path:c,spec:{$set:s}}:createRemoveUpdate(o,c);return updateTree(o,[u])},t)};function Gr(e,t,n,s){const r=[];return Object.keys(s).filter(ne).forEach(o=>{const{tabs:i,activeTabIdx:c}=W(o,s),u=i[c]?.layout;if(u!=null&&getLeaves(u).some(d=>n.includes(d))){const d=mn({originalId:e,newId:t,idsToRemove:n},u),m=be(d,s[o]);r.push({id:o,config:m})}}),r}function Wr(e,t,n,s){const r=[],a=n[e];if(isTabPanel(e)&&a){const{activeTabIdx:m,tabs:p}=a,b=p[m]?.layout;if(b!=null){const T=getAllPanelIds(b,n);r.push(...T)}}const o=getParentTabPanelByPanelId(n);let i=t;const c=[];for(;i!=null;)c.push(i),i=o[i];r.push(...c);const u=_.xor(s,[e]);return _.without(u,...r)}var pn="../../packages/studio-base/src/context/CurrentLayoutContext/index.ts";const bn=L.getLogger(pn),A=(0,oe.createContext)(void 0);A.displayName="CurrentLayoutContext";function Ur(){return useGuaranteedContext(A).mosaicId}function gn(){return useGuaranteedContext(A).actions}function zr(e){const t=useGuaranteedContext(A),[,n]=useReducer(r=>r+1,0);useShouldNotChangeOften(e,()=>{bn.warn("useCurrentLayoutSelector is changing frequently. Rewrite your selector as a stable function.")});const s=useRef(void 0);return(!s.current||e!==s.current.selector)&&(s.current={value:selectWithUnstableIdentityWarning(t.actions.getCurrentLayoutState(),e),selector:e}),useLayoutEffect(()=>{let r=!0;const a=o=>{if(!r)return;const i=selectWithUnstableIdentityWarning(o,e);i!==s.current?.value&&(s.current={value:i,selector:e},n())};return a(t.actions.getCurrentLayoutState()),t.addLayoutStateListener(a),()=>{r=!1,t.removeLayoutStateListener(a)}},[t,e]),s.current.value}function Hr(){const e=useGuaranteedContext(A),[t,n]=useState(()=>e.getSelectedPanelIds());useLayoutEffect(()=>{const c=u=>{n(u)};return e.addSelectedPanelIdsListener(c),()=>{e.removeSelectedPanelIdsListener(c)}},[e]);const s=useGuaranteedContext(A).setSelectedPanelIds,r=useGuaranteedContext(A).getSelectedPanelIds,{getCurrentLayoutState:a}=gn(),o=useCallback(()=>{const c=getLeaves(a().selectedLayout?.data?.layout??null);s(c)},[a,s]),i=useCallback((c,u)=>{s(d=>{const{selectedLayout:m}=a();return m?.data?toggleSelectedPanel(c,u,m.data.configById,d):d})},[s,a]);return useShallowMemo({getSelectedPanelIds:r,selectedPanelIds:t,setSelectedPanelIds:s,selectAllPanels:o,togglePanelSelected:i})}const Yr=null;function Zr(e){const{getCurrentLayoutState:t,savePanelConfigs:n}=useCurrentLayoutActions(),s=useCallback(o=>{if(e!=null)return maybeCast(o.selectedLayout?.data?.configById?.[e])},[e]),r=useCurrentLayoutSelector(s),a=useCallback(o=>{if(e!=null)if(typeof o=="function"){const i=t().selectedLayout?.data?.configById[e];i&&n({configs:[{id:e,config:o(i)}]})}else n({configs:[{id:e,config:o}]})},[t,e,n]);return[r,a]}const hn=Object.freeze({}),yn=e=>e.selectedLayout?.data?.globalVariables??hn;function qr(){const{setGlobalVariables:e,overwriteGlobalVariables:t}=useCurrentLayoutActions(),n=useCurrentLayoutSelector(yn);return{setGlobalVariables:e,overwriteGlobalVariables:t,globalVariables:n}}function _e(e,t){if(typeof e.value=="object")throw new Error("filterMatches only works on paths where global variables have been filled in");if(e.value==null)return!1;let n=t;for(const s of e.path)if(typeof n!="object"||n==null||(n=n[s],n==null))return!1;return n!=null&&n==e.value}const vn=["id","_id","ID","Id","key"],xn=/^id$|_id$|I[dD]$|^key$/;function Xr(e){return xn.test(e)}function Tn(e){const{topics:t,datatypes:n}=PanelAPI.useDataSourceInfo(),{globalVariables:s}=useGlobalVariables(),r=useShallowMemo(e),a=useMemo(()=>filterMap(r,h=>{const v=parseRosPath(h);return v?[h,v]:void 0}),[r]),o=useMemo(()=>{const h={};for(const[v,x]of a)h[v]=ge(x,s);return h},[s,a]),i=useDeepMemo(o),c=useMemo(()=>_.keyBy(t,({name:h})=>h),[t]),u=useMemo(()=>{const h=new Set,v=[];for(const[,x]of a){if(h.has(x.topicName))continue;h.add(x.topicName);const w=c[x.topicName];w&&v.push(w)}return v},[c,a]),d=useDeepMemo(u),m=useMemo(()=>{const h=new Map;function v(x,w){if(w.includes(x))return;const E=n.get(x);if(E){h.set(x,E);for(const M of E.definitions)(M.isComplex===!0||extractTypeFromStudioEnumAnnotation(M.name)!=null)&&v(M.type,[...w,x])}}for(const{schemaName:x}of d.values())x!=null&&v(x,[]);return h},[n,d]),p=useDeepMemo(m),b=useMemo(()=>messagePathStructures(p),[p]),T=useMemo(()=>enumValuesByDatatypeAndField(p),[p]);return useCallback((h,v)=>{if(!r.includes(h))throw new Error(`path (${h}) was not in the list of cached paths`);const x=i[h];return x?Ge(v,x,c,b,T):void 0},[r,i,c,b,T])}function ge(e,t){return{...e,messagePath:e.messagePath.map(n=>{if(n.type==="slice"){const s=typeof n.start=="object"?Number(t[n.start.variableName]):n.start,r=typeof n.end=="object"?Number(t[n.end.variableName]):n.end;return{...n,start:isNaN(s)?0:s,end:isNaN(r)?1/0:r}}else if(n.type==="filter"&&typeof n.value=="object"){let s;const r=t[n.value.variableName];return(typeof r=="number"||typeof r=="string")&&(s=r),{...n,value:s}}return n})}}function Ge(e,t,n,s,r){const a=n[t.topicName];if(!a||e.topic!==t.topicName)return;for(const u of t.messagePath)if(u.type==="filter"){if(!_e(u,e.message))return[]}else break;const o=[];function i(u,d,m,p){if(u==null||p==null)return;const b=t.messagePath[d],T=t.messagePath[d+1];if(b)if(b.type==="name"&&p.structureType==="message"){const h=p.nextByName[b.name];i(u[b.name],d+1,`${m}.${b.repr}`,h)}else if(b.type==="slice"&&p.structureType==="array"){const{start:h,end:v}=b;if(typeof h=="object"||typeof v=="object")throw new Error("getMessagePathDataItems only works on paths where global variables have been filled in");const x=h,w=v;if(typeof x!="number"||typeof w!="number")return;const E=u.length;for(let M=x;M<=Math.min(w,E-1);M++){const Ms=M>=0?M:E+M,X=u[Ms];if(X==null)continue;let K;if(T&&T.type==="filter")K=`${m}[:]`;else if(typeof X=="object"){const we=vn.find(ws=>ws in X);we!=null?K=`${m}[:]{${we}==${X[we]}}`:K=`${m}[${M}]`}else K=`${m}[${M}]`;i(X,d+1,K,p.next)}}else b.type==="filter"?_e(b,u)&&i(u,d+1,`${m}{${b.repr}}`,p):console.warn(`Unknown pathItem.type ${b.type} for structureType: ${p.structureType}`);else{let h;const v=t.messagePath[d-1];if(v&&v.type==="name"){const x=v.name;h=r[p.datatype]?.[x]?.[u]}o.push({value:u,path:m,constantName:h})}}const c=a.schemaName==null?{structureType:"message",datatype:"",nextByName:{}}:s[a.schemaName];return c&&i(e.message,0,bt(t.topicName),c),o}function Kr(e){const t=useShallowMemo(e),n=Tn(t);return useCallback(s=>{const r={};for(const a of t){const o=parseRosPath(a);if(!o){r[a]=[];continue}const i=s[o.topicName];if(!i)continue;const c=[];r[a]=c;for(const u of i){const d=n(a,u);d&&c.push({messageEvent:u,queriedData:d})}}return r},[t,n])}function $n(e,t){const{bounds:n,width:s,height:r}=t,a=s/(n.x.max-n.x.min),o=r/(n.y.max-n.y.min),i=[];let c,u,d,m;const p=n.x.max-n.x.min,b=n.x.min-p*.5,T=n.x.max+p*.5;let h;for(const v of e){const{index:x,label:w}=v;if(v.x<b){i.length===0?i.push(x):i[0]=x;continue}if(v.x>T){h=x;continue}const E=Math.trunc(v.x*a),M=Math.trunc(v.y*o);if(c?.xPixel!==E||u?.label!=null&&u.label!==v.label){d&&d.yPixel!==c?.yPixel&&d.yPixel!==u?.yPixel&&i.push(d.index),m&&m.yPixel!==c?.yPixel&&m.yPixel!==u?.yPixel&&i.push(m.index),u&&c?.yPixel!==u.yPixel&&i.push(u.index),i.push(x),c={xPixel:E,yPixel:M,index:x,label:w},u={xPixel:E,yPixel:M,index:x,label:w},d={xPixel:E,yPixel:M,index:x,label:w},m={xPixel:E,yPixel:M,index:x,label:w};continue}u??={xPixel:E,yPixel:M,index:x,label:w},u.xPixel=E,u.yPixel=M,u.index=x,u.label=w,d&&M<d.yPixel&&(d.yPixel=M,d.index=x,d.label=w),m&&M>m.yPixel&&(m.yPixel=M,m.index=x,m.label=w)}return d&&d.yPixel!==c?.yPixel&&d.yPixel!==u?.yPixel&&i.push(d.index),m&&m.yPixel!==c?.yPixel&&m.yPixel!==u?.yPixel&&i.push(m.index),u&&c?.yPixel!==u.yPixel&&i.push(u.index),h!=null&&i.push(h),i}function Pn(e,t){const{bounds:n,width:s,height:r}=t,a=s/(n.x.max-n.x.min),o=r/(n.y.max-n.y.min),i=s,c=[],u=[];for(const d of e){if(d.x>n.x.max||d.x<n.x.min)continue;const m=Math.round(d.x*a),b=Math.round(d.y*o)*i+m;u[b]!==!0&&(u[b]=!0,c.push(d.index))}return c}function Sn(e,t,n){return e.showLine!==!0?Pn(t,n):$n(t,n)}const Mn=e=>{const t={};for(const[n,s]of e){const r=t[n]={};for(const a of s.definitions)a.isConstant===!0&&a.value!=null&&typeof a.value!="boolean"&&(r[a.value.toString()]!=null?r[a.value.toString()]="<multiple constants match>":r[a.value.toString()]=a.name)}return t},wn=/(.*)__(foxglove|webviz)_enum$/;function En(e){return wn.exec(e)?.[1]}const In=e=>{const t=Mn(e),n={};for(const[s,r]of e){const a={};let o={},i;for(const c of r.definitions){if(i!=null&&c.type!==i&&(o={},i=void 0),c.isConstant===!0&&c.value!=null&&typeof c.value!="boolean"){i=c.type,o[c.value.toString()]!=null?o[c.value.toString()]="<multiple constants match>":o[c.value.toString()]=c.name;continue}const u=En(c.name);if(u!=null){const d=t[c.type];d&&(a[u]=d);continue}a[c.name]||(Object.keys(o).length>0&&(a[c.name]=o),o={})}Object.keys(a).length>0&&(n[s]=a)}return n};var Nn=g(98321),Cn=g.n(Nn),Dn=g(54764),U=g.n(Dn);const Rn=/^\d+$/,Ln=/^(?!\.$)(\d*)\.(\d*)$/,kn=1000n*365n*24n*60n*60n*BigInt(1e9);function Jr(e){const t=e.trim();if(Rn.test(t)){let s=BigInt(t)*BigInt(1e9);for(;s>kn;)s/=1000n;return{sec:Number(s/BigInt(1e9)),nsec:Number(s%BigInt(1e9))}}const n=Ln.exec(t);if(n?.[1]!=null&&n[2]!=null)return{sec:Number(n[1]),nsec:Number(n[2].substr(0,9).padEnd(9,"0"))}}Cn()(U());function An(e,t){return`${Fn(e,t)} ${Bn(e,t)}`}function Fn(e,t){return e.sec<0||e.nsec<0?(console.error("Times are not allowed to be negative"),"(invalid negative time)"):U().tz((0,S.toDate)(e),t??U().tz.guess()).format("YYYY-MM-DD")}function Bn(e,t){return e.sec<0||e.nsec<0?(console.error("Times are not allowed to be negative"),"(invalid negative time)"):U().tz((0,S.toDate)(e),t??U().tz.guess()).format("h:mm:ss.SSS A z")}function Qr(e){return moment.duration(Math.round(e.sec*1e3+e.nsec/1e6)).format("h:mm:ss.SSS",{trim:!1})}function We(e,t){const n=t!=null?moment.tz(e,"YYYY-MM-DD h:mm:ss.SSS A z",t):moment(e,"YYYY-MM-DD h:mm:ss.SSS A z"),s=n.toDate(),r=n.isValid()?fromDate(s):void 0;if(!(!r||r.sec<=0||r.nsec<0))return r}const On=/^\d+-\d+-\d+\s+\d+:\d+:\d+.\d+\s[PpAa][Mm]\s[A-Za-z$]+/,ea=({text:e,timezone:t})=>{if(e==null||e==="")return;const n=isNaN(+e),s=!(On.test(e)&&We(e,t));if(!(n&&s))return{time:n?We(e,t):parseFuzzyRosTime(e),method:n?"TOD":"SEC"}};var Vn=g(4e4),jn=g(63852),se=g(1547);const F={base:{dark:"#1F1E27",medium:"#8B8B8D",light:"#F7F7F3"},red:{dark:"#F24366",medium:"#ff7c96",light:"#FFAABB"},blue:{dark:"#1b83ec",medium:"#4e98e2",light:"#77AADD"},paleGreen:{dark:"#B4CC00",medium:"#cad660",light:"#CDD67E"},orange:{dark:"#ea531f",medium:"#f5774d",light:"#faa487"},cyan:{dark:"#22b5ff",medium:"#61cbff",light:"#99DDFF"},green:{dark:"#05d27d",medium:"#5cd6a9",light:"#8de0c9"},purple:{dark:"#6E51EE",medium:"#a395e2",light:"#c7c0e7"},yellow:{dark:"#EDCC28",medium:"#f7df71",light:"#f1e4aa"}},ta=(0,se.Z)("hsv(0, 0%, 75%)").toHexString(),he=[F.blue.medium,F.orange.medium,F.yellow.medium,F.green.medium,F.cyan.medium,F.purple.medium,F.paleGreen.medium],Ue=he.map(e=>[e,...(0,se.Z)(e).tetrad().map(t=>t.toHexString())]),na=Vn.Z(jn.Z(0,Ue[0].length).map(e=>Ue.map(t=>t[e])).flat()),_n=J.Z(e=>(0,se.Z)(e).brighten(15).toString()),Gn=J.Z(e=>(0,se.Z)(e).darken(30).toString());function Wn(e,t){return e??he[t%he.length]}function ze(e){return!isNaN(Number.parseFloat(e.value))}const He={abs:Math.abs,acos:Math.acos,asin:Math.asin,atan:Math.atan,ceil:Math.ceil,cos:Math.cos,log:Math.log,log1p:Math.log1p,log2:Math.log2,log10:Math.log10,round:Math.round,sign:Math.sign,sin:Math.sin,sqrt:Math.sqrt,tan:Math.tan,trunc:Math.trunc,negative:e=>-e,deg2rad:e=>e*(Math.PI/180),rad2deg:e=>e*(180/Math.PI)};function Un(e,t){let{y:n}=e;const s=Number(n);return isNaN(s)||(n=t(s)),{...e,y:n,value:n}}const z=Object.freeze({sec:0,nsec:0}),ye=e=>e==="custom"||e==="currentCustom";function Ye(e,t,n,s,r,a){if(ye(e)&&a){if(ze(a))return Number.parseFloat(a.value);if(s){if(!r)return NaN;const o=r.queriedData[n]?.value;return(0,S.isTime)(o)?(0,S.toSec)(o):typeof o=="bigint"?o:Number(o)}}return e==="timestamp"?t:n}function ve(e){const t=[],n=[],s=[],r=[],a=new Float32Array(e.length),o=new Float32Array(e.length);for(let i=0;i<e.length;i++){const c=e[i];c!=null&&(t.push(c.receiveTime),c.headerStamp!=null&&n.push(c.headerStamp),c.constantName!=null&&s.push(c.constantName),r.push(c.value),a[i]=c.x,o[i]=c.y)}return{receiveTime:t,...s.length>0?{constantName:s}:{},...n.length>0?{headerStamp:n}:{},value:r,x:a,y:o}}function zn(e,t){return e.concat(...t)}function Hn(e,t,n,s,r,a,o){const i=s==="headerStamp"?e.headerStamp:e.receiveTime;if(!i)return{data:[],hasMismatchedData:!1};const c=[],u=(0,S.toSec)((0,S.subtract)(i,n));for(const m of e.queriedData.entries()){const[p,{value:b,constantName:T}]=m;if(typeof b=="number"||typeof b=="boolean"||typeof b=="string"||typeof b=="bigint"){const h=typeof b=="bigint"?b:Number(b);if(typeof h=="bigint"||!isNaN(h)){const v=Ye(r,u,p,o,t,a),x=h;c.push({x:Number(v),y:Number(x),value:b,constantName:T,receiveTime:e.receiveTime,headerStamp:e.headerStamp})}}else if((0,S.isTime)(b)){const h=Ye(r,u,p,o,t,a),v=(0,S.toSec)(b);c.push({x:Number(h),y:v,receiveTime:e.receiveTime,headerStamp:e.headerStamp,value:`${An(b)} (${Rt(b)})`,constantName:T})}}const d=ye(r)&&(!t||e.queriedData.length!==t.queriedData.length);return{data:c,hasMismatchedData:d}}function Yn({path:e,yAxisRanges:t,index:n,startTime:s,xAxisVal:r,xAxisRanges:a,xAxisPath:o,invertedTheme:i=!1}){let c=e.showLine!==!1,u=ye(r)&&a!=null&&t.length!==a.length;const d=[];let m;for(const h of Object.keys(He))if(e.value.endsWith(`.@${h}`)&&(m=He[h],m))break;const p=[];for(const[h,v]of t.entries()){const x=a?.[h],{data:w,hasMismatchedData:E}=Hn(v,x,s,e.timestampMethod,r,o,a);for(const M of w)m?p.push(Un(M,m)):p.push(M);u=u||E,v.queriedData.length>1&&r!=="index"&&(c=!1)}for(const h of p)d.push(h);const b=Wn(e.color,n);return{dataset:{borderColor:b,label:e.label!=null&&e.label!==""?e.label:e.value,showLine:c,fill:!1,borderWidth:1,pointRadius:1,pointHoverRadius:3,pointBackgroundColor:i?_n(b):Gn(b),pointBorderColor:"transparent",data:[ve(d)]},hasMismatchedData:u}}function xe(e,t){if(e.length===0||t.length===0)return;const n=[],s=[],r=[],a=[],o=new Float32Array(t.length),i=new Float32Array(t.length);for(let c=0;c<t.length;c++){const u=O(e,t[c]??-1);if(u==null)return;const[d,m]=u,p=e[d];if(p==null)return;n.push(p.receiveTime[m]??z),p.headerStamp!=null&&s.push(p.headerStamp[m]??z),p.constantName!=null&&r.push(p.constantName[m]??""),a.push(p.value[m]);const b=p.x[m],T=p.y[m];if(b==null||T==null)return;o[c]=b,i[c]=T}return[{receiveTime:n,...r.length>0?{constantName:r}:{},...s.length>0?{headerStamp:s}:{},value:a,x:o,y:i}]}function Ze(e,t,n){let s=f.uZ5(0,e,t<0?e+t:t),r=n??e;if(r=f.uZ5(0,e,r<0?e+r:r),s>r){const a=s;s=r,r=a}return[s,r]}function Te(e,t,n){const[s,r]=Ze(e.x.length,t,n),a=r-s,o=[],i=[],c=[],u=[],d=new Float32Array(a),m=new Float32Array(a);for(let p=s;p<r;p++){o.push(e.receiveTime[p]??z),e.headerStamp!=null&&i.push(e.headerStamp[p]??z),e.constantName!=null&&c.push(e.constantName[p]??""),u.push(e.value[p]);const b=e.x[p],T=e.y[p];b==null||T==null||(d[p-s]=b,m[p-s]=T)}return{receiveTime:o,headerStamp:i.length>0?i:void 0,constantName:c.length>0?c:void 0,value:u,x:d,y:m}}function Zn(e,t,n){const s=R(e),[r,a]=Ze(s,t,n);if(r===a)return[];const o=O(e,r),i=O(e,a);if(o==null||i==null)return[];const[c,u]=o,[d,m]=i;if(c===d){const h=e[c];return h==null?[]:[Te(h,u,m)]}const p=e[c],b=e[d];if(p==null||b==null)return[];const T=e.slice(c+1,d);return[Te(p,u),...T,Te(b,0,m)]}function qn(e){const t=e.at(0)?.x.at(0),n=e.at(-1)?.x.at(-1);if(!(t==null||n==null))return[t,n]}function Xn(e,t){const n=qn(e)?.[1]??Number.MIN_SAFE_INTEGER;let s=-1;for(const a of N(t))if(a.x>n){s=a.index;break}if(s===-1)return e;const r=Zn(t,s);return r.length===0?e:e.concat(ve([{x:NaN,receiveTime:z,y:NaN}]),r)}function Kn(e){const t=[];let n=0,s=0;for(const r of N(e)){if(r.index===0){n=r.x,s=r.y;continue}const a=r.x-n,o=(r.y-s)/a;t.push({...r,y:o,value:o}),n=r.x,s=r.y}return[ve(t)]}var Jn=g(7279),qe=g(2784);function sa(e){let t,n,s,r;for(const a of e)for(const o of iterateObjects(a.data))isNaN(o.x)||(t=Math.min(t??o.x,o.x),n=Math.max(n??o.x,o.x)),isNaN(o.x)||(s=Math.min(s??o.y,o.y),r=Math.max(r??o.y,o.y));if(!(t==null||n==null||s==null||r==null))return{x:{min:t,max:n},y:{min:s,max:r}}}function Qn(e){let t,n,s,r;for(const a of e)for(const o of N(a.data)){const{x:i,y:c}=o;isNaN(i)||(t=Math.min(t??i,i),n=Math.max(n??i,i)),isNaN(c)||(s=Math.min(s??c,c),r=Math.max(r??c,c))}if(!(t==null||n==null||s==null||r==null))return{x:{min:t,max:n},y:{min:s,max:r}}}function es(e,t){return{x:{min:f.VV$(e.x.min,t.x.min),max:f.Fp7(e.x.max,t.x.max)},y:{min:f.VV$(e.y.min,t.y.min),max:f.Fp7(e.y.max,t.y.max)}}}const Xe=e=>(t,n)=>({bounds:es(t.bounds,n.bounds),data:{datasets:f.UID(([s,r])=>({...s,data:e(s.data,r.data)}),f.$Re(t.data.datasets,n.data.datasets))}}),ra=Xe((e,t)=>[...e,...t]),aa=Xe((e,t)=>e.concat(t));function oa(e,t,n,s,r){const[a,o]=qe.useState(),i=qe.useCallback(u=>{o({full:u,partial:void 0})},[]),c=useCallback(u=>{o(d=>{if(d==null)return{full:void 0,partial:u};const{partial:m}=d;return{...d,partial:m!=null?n(m,u):u}})},[n]);return useEffect(()=>{r?.register(i,c)},[r,c,i]),useEffect(()=>{r?.setView(e)},[r,e]),useMemo(()=>{if(s==null){if(a==null)return;const{full:d,partial:m}=a;return m==null?d:d==null?void 0:n(d,m)}const u=t(s.datasets);if(u!=null)return{bounds:u,data:s}},[s,a,t,n])}function Ke(){return{x:{min:Number.MAX_SAFE_INTEGER,max:Number.MIN_SAFE_INTEGER},y:{min:Number.MAX_SAFE_INTEGER,max:Number.MIN_SAFE_INTEGER}}}function Je(e,t){return{x:{min:Math.min(e.x.min,t.x.min),max:Math.max(e.x.max,t.x.max)},y:{min:Math.min(e.y.min,t.y.min),max:Math.max(e.y.max,t.y.max)}}}function Qe(e,t,n){const s=new Map;for(const[r,a]of e){const o=t.get(r);o==null?s.set(r,a):s.set(r,n(a,o,r))}for(const[r,a]of t){if(s.has(r))continue;const o=e.get(r);o==null?s.set(r,a):s.set(r,n(o,a,r))}return s}function ia(e,t){const n=[];for(const[s,r]of e)t.includes(s)&&n.push([s,r]);return new Map(n)}const ca=Object.freeze({receiveTime:[],value:[],x:new Float32Array(0),y:new Float32Array(0)}),V=Object.freeze({bounds:Ke(),datasets:new Map,pathsWithMismatchedDataLengths:[]});function et(e){const t={};let n=Number.MAX_SAFE_INTEGER,s=Number.MIN_SAFE_INTEGER;for(const[r,a]of e.datasets){const o=t[r.value]={start:Number.MAX_SAFE_INTEGER,end:Number.MIN_SAFE_INTEGER},{data:i}=a,c=xe(i,[0,R(i)-1])?.[0];o.start=Math.min(o.start,c?.x[0]??Number.MAX_SAFE_INTEGER),o.end=Math.max(o.end,c?.x[c.x.length-1]??Number.MIN_SAFE_INTEGER),n=Math.min(n,o.start),s=Math.max(s,o.end)}return{all:{start:n,end:s},byPath:t}}function tt(e,t){const n=new Map;for(const[s,r]of t.entries())n.set(s,e(r,s));return n}function nt(e,t){return e===V?t:t===V?e:{...e,bounds:Je(e.bounds,t.bounds),datasets:Qe(e.datasets,t.datasets,(n,s)=>({...n,data:zn(n.data,s.data)}))}}function ts(e,t){return e===V?t:t===V?e:{...e,bounds:Je(e.bounds,t.bounds),datasets:Qe(e.datasets,t.datasets,(n,s)=>({...n,data:Xn(n.data,s.data)}))}}function ns(e,t){const n=et(e).all,s=et(t).all,r=n.start-s.start;return r!==0?r:n.end-s.end}function ss(e){return e.slice().sort(ns).reduce((s,r)=>Jn.Z(s)?r:ts(s,r),V)}function rs(e,t){return f.tSV(n=>n==null?[]:[n.value],[t,...e])}function as(e){const{paths:t,startTime:n,xAxisVal:s,xAxisPath:r,xAxisData:a,invertedTheme:o}=e,i=Ke(),c=[],u=new Map;for(const[d,[m,p]]of t.entries()){const b=a,T=p??[];if(m.enabled){if(!ze(m)){const h=Yn({path:m,yAxisRanges:T,index:d,startTime:n,xAxisVal:s,xAxisRanges:b,xAxisPath:r,invertedTheme:o});h.hasMismatchedData&&c.push(m.value);const v=Qn([h.dataset]);if(v==null)continue;i.x.min=Math.min(i.x.min,v.x.min),i.x.max=Math.max(i.x.max,v.x.max),i.y.min=Math.min(i.y.min,v.y.min),i.y.max=Math.max(i.y.max,v.y.max),u.set(m,h.dataset)}}else continue}return{bounds:i,datasets:u,pathsWithMismatchedDataLengths:c}}function os(e,t,n){const{structures:s,enumValues:r}=e,a=f.HK3(o=>o.name,e.topics);return f.tSV(o=>{const i=Ge(o,n,a,s,r);return i==null?[]:[{queriedData:i,receiveTime:o.receiveTime,headerStamp:Le(o.message)}]},t)}const st=e=>t=>({...t,datasets:tt(e,t.datasets)}),is=st((e,t)=>t.value.endsWith(".@derivative")?{...e,data:Kn(e.data)}:e),cs=st((e,t)=>{if(t.timestampMethod!=="headerStamp")return e;const n=[];for(const r of N(e.data))n.push([r.index,r.x]);n.sort(([,r],[,a])=>r-a);const s=xe(e.data,f.UID(([r])=>r,n));return s==null?e:{...e,data:s}});let $e=!1,I={},rt={},j={},C={},at={topics:[],datatypes:new Map,enumValues:{},structures:{}};function H(e){const t={};for(const n of e)t[n]=0;return{cursors:t,data:V}}function ot(e,t){const n={},s={};for(const[r,a]of Object.entries(e))n[r]=t[r]?.length??a,s[r]=t[r]?.slice(a)??[];return[n,s]}function it(e){return rs(e.paths,e.xAxisPath)}function ct(e){return f.zGw(f.tSV(t=>{const n=ae(t);return n==null?[]:[{parsed:n,value:t}]}),f.UID(t=>t.parsed.topicName),f.jj$)(it(e))}function Y(e){const{xAxisVal:t}=e;return t==="currentCustom"||t==="index"}function us(e){const{followingViewWidth:t}=e;return t!=null&&t>0}function ut(e,t){const n=ae(t.value);return n==null?[]:os(at,e[n.topicName]??[],ge(n,rt))}function Z(e,t){const{paths:n,invertedTheme:s,startTime:r,xAxisPath:a,xAxisVal:o}=e;return as({invertedTheme:s,paths:f.UID(i=>[i,ut(t,i)],n),startTime:r,xAxisPath:a,xAxisData:a!=null?ut(t,a):void 0,xAxisVal:o})}function q(e,t,n){const{cursors:s,data:r}=e,[a,o]=ot(s,n);return f.xbD(o)?e:{cursors:a,data:nt(r,Z(t,o))}}function ls(e){let t=!1,n;const s=()=>{fs(e)},r=()=>{n=setTimeout(()=>{n=void 0,t&&(t=!1,s(),r())},100)};return()=>{if(n==null){s(),r();return}t=!0}}function k(e,t){I={...I,[e]:t}}function lt(e){const{params:t,view:n,blocks:{data:s},current:{data:r}}=e;if(t==null||n==null)return;const{bounds:a}=s,{bounds:o}=r;let i=[];return Y(t)||us(t)?i=[r]:a.x.min<=o.x.min&&a.x.max>o.x.max?i=[s]:i=[s,r],f.zGw(ss,is,cs)(i)}function Pe(e){const{bounds:t}=e,n=[];for(const s of e.datasets.values())n.push(s);return{bounds:t,data:{datasets:n}}}function Se(e,t){e.setPanel?.(t),e.setProvided?.(Pe(t))}function fs(e){const t=I[e];if(t==null)return;const n=lt(t);if(n==null)return;const{params:s,view:r}=t;if(s==null||r==null||Y(s))return;const a=tt(o=>{const i=Sn(o,N(o.data),r),c=xe(o.data,i);return c==null?o:{...o,data:c}},n.datasets);Se(t,{...n,datasets:a})}function ds(e){$e=e}function ms(e){const{[e]:t,...n}=I;I=n}function ps(e,t){at={topics:e,datatypes:t,enumValues:In(t),structures:Tt(t)}}function ft(e){const t=I[e];if(t==null)return;const{params:n}=t;if(n==null)return;const s=ct(n),r=H(s);k(e,{...t,topics:s,blocks:q(r,n,j),current:q(r,n,C)}),t.queueRebuild()}function bs(e){rt=e;for(const t of Object.values(I)){const{params:n}=t;n==null||f.zGw(f.tSV(r=>{const a=ae(r);if(a==null)return[];const o=ge(a,e);return f.fS0(a.messagePath,o.messagePath)?[]:[o]}))(it(n)).length===0||ft(t.id)}}function Me(){const e=f.zGw(f.tSV(({topics:t})=>t),f.jj$)(f.VO0(I));j=f.eiS(e,j),C=f.eiS(e,C)}function gs(e){const t=f.XPQ(e);j=f.bTk(f.zoF,j,e);for(const n of f.VO0(I)){const{params:s}=n,r=f.jVA(t,n.topics);s==null||Y(s)||r.length===0||(k(n.id,{...n,blocks:q(n.blocks,s,j)}),n.queueRebuild())}Me()}function hs(){C={};for(const e of f.VO0(I))k(e.id,{...e,current:H(e.topics)}),e.queueRebuild()}function ys(e){for(const t of e){const{topic:n}=t;C[n]==null&&(C[n]=[]),C[n]?.push(t)}if(!$e){for(const t of f.VO0(I)){const{params:n}=t;if(n!=null){if(Y(n)){Se(t,Z(n,f.UID(s=>s.slice(-1),C)));continue}k(t.id,{...t,current:q(t.current,n,C)}),t.queueRebuild()}}return}for(const t of f.VO0(I)){const{params:n,current:s}=t;if(n==null)continue;const{cursors:r,data:a}=s,[o,i]=ot(r,C);if(Y(n)){Se(t,Z(n,f.UID(u=>u.slice(-1),C)));continue}if(f.xbD(i))continue;const c=Z(n,i);t.addPartial?.(Pe(c)),k(t.id,{...t,current:{cursors:o,data:nt(a,c)}})}Me()}function dt(e,t){const n=I[e];n!=null&&(k(e,{...n,params:t,topics:ct(t)}),ft(e),Me())}function vs(e,t){const n=I[e];n!=null&&(k(e,{...n,view:t}),n.queueRebuild())}const xs=(0,S.fromSec)(10);function Ts(){if($e){C=f.UID(e=>{if(e.length>1e4)return e.slice(e.length-1e4);const t=e.at(0)?.receiveTime,n=e.at(-1)?.receiveTime;if(n==null||t==null)return e;const s=(0,S.subtract)(n,xs),r=f.cxD(({receiveTime:a})=>(0,S.compare)(a,s)>0,e);return e.slice(r)},C);for(const e of f.VO0(I)){const{params:t}=e;if(t==null)continue;const n=q(H(e.topics),t,C);k(e.id,{...e,current:n}),e.setProvided?.(Pe(n.data))}}}setInterval(Ts,2e3);function $s(e,t,n,s,r){k(e,{id:e,setProvided:t,addPartial:s,setPanel:n,params:r,topics:[],view:void 0,blocks:H([]),current:H([]),queueRebuild:ls(e)}),r!=null&&dt(e,r)}function Ps(e){const t=I[e];if(t!=null)return lt(t)}const Ss={addBlock:gs,addCurrent:ys,buildPlot:Z,clearCurrent:hs,getFullData:Ps,receiveMetadata:ps,receiveVariables:bs,register:$s,setLive:ds,unregister:ms,updateParams:dt,updateView:vs};l.Jj(Ss)}},Ie={};function P(y){var $=Ie[y];if($!==void 0)return $.exports;var g=Ie[y]={id:y,loaded:!1,exports:{}};return Ee[y].call(g.exports,g,g.exports,P),g.loaded=!0,g.exports}P.m=Ee,P.x=()=>{var y=P.O(void 0,[1084,7955,5836,9078,1547,4798],()=>P(21457));return y=P.O(y),y},(()=>{var y=[];P.O=($,g,l,f)=>{if(g){f=f||0;for(var S=y.length;S>0&&y[S-1][2]>f;S--)y[S]=y[S-1];y[S]=[g,l,f];return}for(var R=1/0,S=0;S<y.length;S++){for(var[g,l,f]=y[S],B=!0,N=0;N<g.length;N++)(f&!1||R>=f)&&Object.keys(P.O).every(re=>P.O[re](g[N]))?g.splice(N--,1):(B=!1,f<R&&(R=f));if(B){y.splice(S--,1);var O=l();O!==void 0&&($=O)}}return $}})(),P.n=y=>{var $=y&&y.__esModule?()=>y.default:()=>y;return P.d($,{a:$}),$},P.d=(y,$)=>{for(var g in $)P.o($,g)&&!P.o(y,g)&&Object.defineProperty(y,g,{enumerable:!0,get:$[g]})},P.f={},P.e=y=>Promise.all(Object.keys(P.f).reduce(($,g)=>(P.f[g](y,$),$),[])),P.u=y=>""+y+"."+{1084:"bb60996131e2a2cf072e",1547:"8ba446bd308908072dc1",4798:"facd81b4b966f0a8143f",5836:"291da953db51a54da26b",7955:"e48e6f0665bc0be793e7",9078:"9d39e7e1be4d78d123d9"}[y]+".js",P.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}(),P.o=(y,$)=>Object.prototype.hasOwnProperty.call(y,$),P.nmd=y=>(y.paths=[],y.children||(y.children=[]),y),(()=>{var y;P.g.importScripts&&(y=P.g.location+"");var $=P.g.document;if(!y&&$&&($.currentScript&&(y=$.currentScript.src),!y)){var g=$.getElementsByTagName("script");if(g.length)for(var l=g.length-1;l>-1&&!y;)y=g[l--].src}if(!y)throw new Error("Automatic publicPath is not supported in this browser");y=y.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),P.p=y})(),(()=>{var y={1457:1},$=f=>{var[S,R,B]=f;for(var N in R)P.o(R,N)&&(P.m[N]=R[N]);for(B&&B(P);S.length;)y[S.pop()]=1;l(f)};P.f.i=(f,S)=>{y[f]||importScripts(P.p+P.u(f))};var g=self.webpackChunk=self.webpackChunk||[],l=g.push.bind(g);g.push=$})(),(()=>{var y=P.x;P.x=()=>Promise.all([1084,7955,5836,9078,1547,4798].map(P.e,P)).then(y)})();var Es=P.x()})();

//# sourceMappingURL=1457.8ca3847ab67237cebff0.js.map