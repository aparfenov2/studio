"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[1234],{11234:(ae,R,t)=>{t.r(R),t.d(R,{default:()=>Ye,openSiblingStateTransitionsPanel:()=>Ze,transitionableRosTypes:()=>Ce});var h=t(52322),j=t(52498),z=t(38677),I=t(68434),u=t(76635),o=t(2784),W=t(62515),ie=t(1547),oe=t(72970),$=t(8220),U=t(75845),y=t(44668),F=t(75785),X=t(36922),K=t(4750);function le(e,n=1/0){const s=(0,U.O4)(e),c=(0,o.useMemo)(()=>(0,$.Z)(s,d=>(0,K.V)(d)),[s]),r=F.V7({topics:c,historySize:n}),f=(0,X.wm)(s);return(0,o.useMemo)(()=>f(r),[f,r])}var Z=t(85026),re=t(75017),de=t(82044),ue=t(76479),L=t(93812),ce=t(24243),me=t(98043),pe=t(26775),he=t(77075),fe=t(9839),xe=t.n(fe),ve=t(68071),ge=t(27999),ye=t(25302);function Me(e,n){return(e%n+n)%n}const J=[ye.B,...ve.A2];function Se(){const e=new Map;return n=>{const s=e.get(n);return s??(e.set(n,e.size),e.size-1)}}function Q(e){const{path:n,pathIndex:s,startTime:c,y:r,blocks:f}=e,d={borderWidth:10,data:[],label:s.toString(),pointBackgroundColor:"rgba(0, 0, 0, 0.4)",pointBorderColor:"transparent",pointHoverRadius:3,pointRadius:1.25,pointStyle:"circle",showLine:!0};let x;const m=Se();let M;for(const v of f)if(v)for(const E of v){const A=(0,ge.w0)(E.messageEvent,n.timestampMethod);if(!A)continue;const p=E.queriedData[0];if(E.queriedData.length!==1||!p)continue;const{constantName:S,value:l}=p,T=m(l);if(x&&(0,y.toSec)((0,y.subtract)(x,A))===0&&T===M||(x=A,Number.isNaN(l)&&typeof l!="string")||typeof l!="number"&&typeof l!="bigint"&&typeof l!="boolean"&&typeof l!="string")continue;const N=typeof l=="string"?xe()(l):Math.round(Number(l)),C=J[Me(N,Object.values(J).length)]??"grey",B=(0,y.toSec)((0,y.subtract)(A,c)),O=S!=null?`${S} (${String(l)})`:String(l),P={x:B,y:r,label:T!==M?O:"",labelColor:C,value:l,constantName:S};d.data.push(P),M=T}return[d]}var V=t(67067),Te=t(5817),k=t.n(Te),be=t(68588),Ae=t(62421),Pe=t(39367);function w(e){if(e!=="")return e??void 0}function q(e,n){return w(e.label)??w(e.value)??`Series ${n+1}`}const Ee=k()((e,n)=>({actions:[{type:"action",id:"delete-series",label:"Delete series",display:"inline",icon:"Clear"}],label:q(e,n),fields:{value:{label:"Message path",input:"messagepath",value:e.value,validTypes:Ae.plotableRosTypes},label:{input:"string",label:"Label",value:e.label},timestampMethod:{input:"select",label:"Timestamp",value:e.timestampMethod,options:[{label:"Receive Time",value:"receiveTime"},{label:"Header Stamp",value:"headerStamp"}]}}})),Ne=k()(e=>({label:"Series",children:Object.fromEntries(e.map((s,c)=>[`${c}`,Ee(s,c)])),actions:[{type:"action",id:"add-series",label:"Add series",display:"inline",icon:"Addchart"}]}));function Re(e,n){const s=(0,u.isNumber)(e.xAxisMinValue)&&(0,u.isNumber)(e.xAxisMaxValue)&&e.xAxisMinValue>=e.xAxisMaxValue?n("maxXError"):void 0;return{general:{label:"General",fields:{isSynced:{label:"Sync with other plots",input:"boolean",value:e.isSynced}}},xAxis:{label:n("xAxis"),fields:{xAxisMinValue:{label:n("min"),input:"number",value:e.xAxisMinValue!=null?Number(e.xAxisMinValue):void 0,placeholder:"auto"},xAxisMaxValue:{label:n("max"),input:"number",error:s,value:e.xAxisMaxValue!=null?Number(e.xAxisMaxValue):void 0,placeholder:"auto"},xAxisRange:{label:n("secondsRange"),input:"number",placeholder:"auto",value:e.xAxisRange}}},paths:Ne(e.paths)}}function Ie(e,n,s){const c=(0,Pe.W0)(),{t:r}=(0,be.$G)("stateTransitions"),f=(0,o.useCallback)(d=>{if(d.action==="update"){const{input:x,path:m,value:M}=d.payload;x==="boolean"&&(0,u.isEqual)(m,["general","isSynced"])?n({isSynced:M}):m[0]==="xAxis"?n((0,V.Uy)(v=>{(0,u.set)(v,m.slice(1),M),m[1]==="xAxisRange"?(v.xAxisMinValue=void 0,v.xAxisMaxValue=void 0):(m[1]==="xAxisMinValue"||m[1]==="xAxisMaxValue")&&(v.xAxisRange=void 0)})):n((0,V.Uy)(v=>{(0,u.set)(v,m,M)}))}if(d.action==="perform-node-action"){if(d.payload.id==="add-series")n((0,V.Uy)(x=>{x.paths.push({timestampMethod:"receiveTime",value:"",enabled:!0})}));else if(d.payload.id==="delete-series"){const x=d.payload.path[1];n((0,V.Uy)(m=>{m.paths.splice(Number(x),1)}))}}},[n]);(0,o.useEffect)(()=>{c({actionHandler:f,focusedPath:s,nodes:Re(e,r)})},[f,e,s,r,c])}var Ve=t(2784);const Ce=["bool","int8","uint8","int16","uint16","int32","uint32","int64","uint64","string","json"],Be=he.R.MONOSPACE,De=10,je="bold",ze={},We=(0,oe.ZL)()(e=>({chartWrapper:{position:"relative",marginTop:e.spacing(.5)},chartOverlay:{top:0,left:0,right:0,pointerEvents:"none"},row:{paddingInline:e.spacing(.5),pointerEvents:"none"},button:{minWidth:"auto",textAlign:"left",pointerEvents:"auto",fontWeight:"normal",padding:e.spacing(0,1),maxWidth:"100%","&:hover":{backgroundColor:(0,ie.Z)(e.palette.background.paper).setAlpha(.67).toString(),backgroundImage:`linear-gradient(to right, ${e.palette.action.focus}, ${e.palette.action.focus})`},".MuiButton-endIcon":{opacity:.8,fontSize:14,marginLeft:e.spacing(.5),svg:{fontSize:"1em",height:"1em",width:"1em"}},":not(:hover) .MuiButton-endIcon":{display:"none"}}})),Fe={datalabels:{display:"auto",anchor:"center",align:-45,offset:0,clip:!0,font:{family:Be,size:De,weight:je}},zoom:{zoom:{enabled:!0,mode:"x",sensitivity:3,speed:.1},pan:{mode:"x",enabled:!0,speed:20,threshold:10}}};function Ze(e,n){e({panelType:"StateTransitions",updateIfExists:!0,siblingConfigCreator:s=>({...s,paths:(0,u.uniq)(s.paths.concat([{value:n,timestampMethod:"receiveTime"}]))})})}function Le(e){return e.playerState.activeData?.currentTime}function Oe(e){return e.playerState.activeData?.endTime}const Ge=Ve.memo(function(n){const{config:s,saveConfig:c}=n,{paths:r}=s,{classes:f}=We(),d=(0,o.useMemo)(()=>r.map(({value:a})=>a),[r]),{openPanelSettings:x}=(0,pe.W)(),{id:m,setMessagePathDropConfig:M}=(0,de.R)(),{setSelectedPanelIds:v}=(0,me.iy)(),[E,A]=(0,o.useState)(void 0);(0,o.useEffect)(()=>{M({getDropStatus(a){return a.isLeaf?{canDrop:!0,effect:"add"}:{canDrop:!1}},handleDrop(a){c(i=>({...i,paths:[...i.paths.length===1&&i.paths[0]?.value===""?[]:i.paths,{value:a.path,enabled:!0,timestampMethod:"receiveTime"}]}))}})},[c,M]);const{startTime:p}=F.Ui(),S=(0,Z.An)(Le),l=(0,o.useMemo)(()=>S&&p?(0,y.toSec)((0,y.subtract)(S,p)):void 0,[S,p]),T=(0,Z.An)(Oe),N=(0,o.useMemo)(()=>T&&p?(0,y.toSec)((0,y.subtract)(T,p)):void 0,[T,p]),C=le(d),B=(0,X.wm)(d),O=(0,o.useMemo)(()=>(0,$.Z)(r,a=>{const i=(0,K.V)(a.value,"full");return a.timestampMethod==="headerStamp"&&i?.fields!=null&&i.fields.push("header"),i}),[r]),G=F.PR(O),P=(0,o.useMemo)(()=>G.map(B),[G,B]),{height:_,heightPerTopic:$e}=(0,o.useMemo)(()=>{const a=r.length*64;return{height:Math.max(80,a+30),heightPerTopic:a/r.length}},[r.length]),ee=(0,o.useMemo)(()=>{const a=(0,u.pickBy)(C,(i,g)=>!P.some(b=>b[g]));return(0,u.isEmpty)(a)?ze:a},[P,C]),{datasets:Ue,minY:te}=(0,o.useMemo)(()=>{if(!p)return{datasets:[],minY:void 0};let a,i=[];return r.forEach((g,b)=>{const D=(b+1)*6*-1;a=Math.min(a??D,D-3);const qe=P.map(Y=>Y[g.value]),_e=Q({blocks:qe,path:g,pathIndex:b,startTime:p,y:D});i=i.concat(_e);const se=ee[g.value];if(se){const Y=Q({blocks:[se],path:g,pathIndex:b,startTime:p,y:D});i=i.concat(Y)}}),{datasets:i,minY:a}},[P,ee,r,p]),Xe=(0,o.useMemo)(()=>({ticks:{display:!1},grid:{display:!1},type:"linear",min:te,max:-3}),[te]),Ke=(0,o.useMemo)(()=>({type:"linear",border:{display:!1}}),[]),Je=(0,o.useMemo)(()=>(s.xAxisMinValue!=null||s.xAxisMaxValue!=null)&&N!=null?{x:{min:s.xAxisMinValue??0,max:s.xAxisMaxValue??N},y:{min:Number.MIN_SAFE_INTEGER,max:Number.MAX_SAFE_INTEGER}}:s.xAxisRange!=null&&l!=null?{x:{min:l-s.xAxisRange,max:l},y:{min:Number.MIN_SAFE_INTEGER,max:Number.MAX_SAFE_INTEGER}}:void 0,[s.xAxisMaxValue,s.xAxisMinValue,s.xAxisRange,l,N]),{width:Qe,ref:H}=(0,W.NB)({handleHeight:!1,refreshRate:0,refreshMode:"debounce"});(0,o.useEffect)(()=>{const a=H.current,i=g=>{g.preventDefault()};return a?.addEventListener("wheel",i),()=>{a?.removeEventListener("wheel",i)}},[H]);const ne=(0,Z.m7)(),ke=(0,o.useCallback)(({x:a})=>{const{seekPlayback:i,playerState:{activeData:{startTime:g}={}}}=ne();if(!i||a==null||g==null)return;const b=(0,y.add)(g,(0,y.fromSec)(a));i(b)},[ne]),we=(0,U.O4)({datasets:Ue});return Ie(s,c,E),(0,h.jsxs)(L.Z,{flexGrow:1,overflow:"hidden",style:{zIndex:0},children:[(0,h.jsx)(ue.Z,{}),(0,h.jsx)(L.Z,{fullWidth:!0,flex:"auto",overflowX:"hidden",overflowY:"auto",children:(0,h.jsxs)("div",{className:f.chartWrapper,style:{height:_},ref:H,children:[(0,h.jsx)(ce.Z,{zoom:!0,isSynced:s.isSynced,showXAxisLabels:!0,width:Qe??0,height:_,data:we,dataBounds:Je,type:"scatter",xAxes:Ke,xAxisIsPlaybackTime:!0,yAxes:Xe,plugins:Fe,onClick:ke,currentTime:l}),(0,h.jsx)(L.Z,{className:f.chartOverlay,position:"absolute",paddingTop:.5,children:r.map((a,i)=>(0,h.jsx)("div",{className:f.row,style:{height:$e},children:(0,h.jsx)(z.Z,{size:"small",color:"inherit","data-testid":"edit-topic-button",className:f.button,endIcon:(0,h.jsx)(j.An,{}),onClick:()=>{v([m]),x(),A(["paths",String(i)])},children:(0,h.jsx)(I.Z,{variant:"inherit",noWrap:!0,children:q(a,i)})})},i))})]})})]})}),He={paths:[{value:"",timestampMethod:"receiveTime"}],isSynced:!0},Ye=(0,re.Z)(Object.assign(Ge,{panelType:"StateTransitions",defaultConfig:He}))},4750:(ae,R,t)=>{t.d(R,{V:()=>j});var h=t(1012);function j(z,I){const u=(0,h.ZP)(z);if(!u)return;const o=u.messagePath.find(W=>W.type==="name");return o?{topic:u.topicName,preloadType:I??"partial",fields:[o.name]}:{topic:u.topicName,preloadType:I??"partial"}}}}]);

//# sourceMappingURL=1234.8d59bc2e7bffe6c7d8f3.js.map