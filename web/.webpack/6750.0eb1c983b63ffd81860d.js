"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[6750],{16750:(Q,E,d)=>{d.d(E,{Z:()=>Y});var c=d(24468),M=d(16846),L=d(94858),R=d(27788),D=d(42146),I=d(64578);function F(i){(0,D.tm)((e,t,n,s)=>{t instanceof Error||typeof t=="string"||console.warn("Invalid Error type",t),i.send("sendNotification",{message:e,details:t instanceof Error?t.toString():t,type:n,severity:s})})}function A(i){F(i),(0,I.Z)()}var N=d(6881),y=d(30686),g=d(22354),B=d(23503),p=d(23571),$=d(77075);function k(i){return"raw"in i}function C(i){if(k(i.p0))return i.p0.raw.labelColor}var x=d(96389),z=d(10742);function P(i){const{data:e}=i,t=x.zGw(x.UID(n=>n.x.length),x.Smz)(e);return{...i,data:new Proxy(Object.seal([]),{isExtensible(){return!1},get(n,s,r){if(s==="_chartjs")return;if(s==="length")return t;if(typeof s!="string")return n[s];const l=parseInt(s);if(l<0||l>=t)return;const o=(0,z.Hu)(e,l);if(o==null)return;const[a,f]=o,u=e[a];if(u==null)return;const m={};for(const[v,h]of Object.entries(u))m[v]=h[f];return m}})}}function Z(i){return{...i,datasets:x.UID(P,i.datasets)}}var j="../../packages/studio-base/src/components/Chart/worker/ChartJSManager.ts";const S=B.ZP.getLogger(j);function w(i){return(e,t)=>{const n=i.listeners(e);!t||n.includes(t)||i.on(e,t)}}function b(i){return(e,t)=>{t&&i.off(e,t)}}class O{#t;#n=new y.Z;#e=new y.Z;#i;constructor(e){S.info(`new ChartJSManager(id=${e.id})`),this.init(e)}async init({id:e,node:t,type:n,data:s,options:r,devicePixelRatio:l,fontLoaded:o}){const a=await o;if(S.debug(`ChartJSManager(${e}) init, default font "${a.family}" status=${a.status}`),s!=null)for(const h of s.datasets)h.segment={borderColor:C};const f={addEventListener:w(this.#n),removeEventListener:b(this.#n),ownerDocument:{addEventListener:w(this.#e),removeEventListener:b(this.#e)}},u=g.L.start?.bind(g.L);g.L.start=(h,T,X)=>{const U=h.ctx;h.ctx={canvas:f};const K=u?.(h,T,X);return h.ctx=U,K};const m={...this.#s(r),devicePixelRatio:l,font:{family:$.R.MONOSPACE},responsive:!1},v=new c.kL(t,{type:n,data:s,options:m,plugins:[N.Z,g.L]});g.L.start=u,this.#t=v}wheel(e){const t=e.target;return t.getBoundingClientRect=()=>t.boundingClientRect,this.#n.emit("wheel",e),this.getScales()}mousedown(e){const t=e.target;return t.getBoundingClientRect=()=>t.boundingClientRect,this.#n.emit("mousedown",e),this.getScales()}mousemove(e){const t=e.target;return t.getBoundingClientRect=()=>t.boundingClientRect,this.#n.emit("mousemove",e),this.getScales()}mouseup(e){const t=e.target;return t.getBoundingClientRect=()=>t.boundingClientRect,this.#e.emit("mouseup",e),this.getScales()}panstart(e){const t=e.target;return t.getBoundingClientRect=()=>t.boundingClientRect,(0,p.Y)(this.#t)?.$zoom.panStartHandler(e),this.getScales()}panmove(e){const t=e.target;return t.getBoundingClientRect=()=>t.boundingClientRect,(0,p.Y)(this.#t)?.$zoom.panHandler(e),this.getScales()}panend(e){const t=e.target;return t.getBoundingClientRect=()=>t.boundingClientRect,(0,p.Y)(this.#t)?.$zoom.panEndHandler(e),this.getScales()}update({options:e,width:t,height:n,isBoundsReset:s,data:r,typedData:l}){const o=this.#t;if(o==null)return{};for(const a of r?.datasets??[])a.segment={borderColor:C};if(e!=null){o.options.plugins=this.#s(e).plugins;const a=e.scales??{};(s||a.x?.min!=null&&a.x.max!=null)&&o.options.scales&&(o.options.scales.x=a.x),(s||a.y?.min!=null&&a.y.max!=null)&&o.options.scales&&(o.options.scales.y=a.y)}if(t!=null||n!=null){let a=!1;const f=Math.floor(t??o.width),u=Math.floor(n??o.height);t!=null&&Math.abs(o.width-f)>Number.EPSILON&&(o.canvas.width=f,a=!0),n!=null&&Math.abs(o.height-u)>Number.EPSILON&&(o.canvas.height=u,a=!0),a&&o.resize(f,u)}return r!=null&&(o.data=r),l!=null&&(o.data=Z(l)),o.update("none"),this.getScales()}destroy(){this.#t?.destroy()}getElementsAtEvent({event:e}){const t={native:!0,x:e.clientX,y:e.clientY},n=this.#t?.getElementsAtEventForMode(t,this.#t.options.interaction?.mode??"intersect",this.#t.options.interaction??{},!1)??[],s=new Array;for(const r of n){const l=this.#t?.data?.datasets[r.datasetIndex]?.data[r.index];l==null||typeof l=="number"||s.push({data:l,datasetIndex:r.datasetIndex,index:r.index,view:{x:r.element.x,y:r.element.y}})}return s.sort((r,l)=>{const o=e.clientX-r.view.x,a=e.clientY-r.view.y,f=e.clientX-l.view.x,u=e.clientY-l.view.y,m=o*o+a*a,v=f*f+u*u;return m-v}),s}getDatalabelAtEvent({event:e}){this.#t?.notifyPlugins("beforeEvent",{event:e});const t=this.#i;return this.#i=void 0,t?.dataset.data[t.dataIndex]}getScales(){const e={},t=this.#t?.scales.x;t&&(e.x={pixelMin:t.left,pixelMax:t.right,min:t.min,max:t.max});const n=this.#t?.scales.y;return n&&(e.y={pixelMin:n.bottom,pixelMax:n.top,min:n.min,max:n.max}),e}#s(e){const t=e.plugins?.datalabels;if(t){t.listeners={click:s=>{this.#i=s}},t.formatter=(s,r)=>s.label??null;const n=t.color??"white";t.color=s=>s.dataset.data[s.dataIndex]?.labelColor??n}return e}}async function W(){const i=new FontFace("IBM Plex Mono",`url(${R}) format('woff2')`);return typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope?self.fonts.add(i):document.fonts.add(i),await i.load()}const G=W();c.kL.register(c.jn,c.od,c.ST,c.ho,c.uw,c.f$,c.FB,c.RM,c.Gu,c.De,c.Dx,c.u,L.Z);const H=new Intl.NumberFormat(void 0,{minimumFractionDigits:2,maximumFractionDigits:2});function J(i){const e=i.options?.scales?.x;return e?.ticks&&(e.ticks.callback=function(t,n,s){return n===0||n===s.length-1?H.format(t):M.aL.formatters.numeric.apply(this,[t,n,s])}),i}class Y{#t;#n=new Map;constructor(e){this.#t=e,typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&A(this.#t),e.receive("initialize",t=>{t.fontLoaded=G;const n=new O(t);return this.#n.set(t.id,n),n.getScales()}),e.receive("wheel",t=>this.#e(t.id).wheel(t.event)),e.receive("mousedown",t=>this.#e(t.id).mousedown(t.event)),e.receive("mousemove",t=>this.#e(t.id).mousemove(t.event)),e.receive("mouseup",t=>this.#e(t.id).mouseup(t.event)),e.receive("panstart",t=>this.#e(t.id).panstart(t.event)),e.receive("panend",t=>this.#e(t.id).panend(t.event)),e.receive("panmove",t=>this.#e(t.id).panmove(t.event)),e.receive("update",t=>this.#e(t.id).update(J(t))),e.receive("destroy",t=>{const n=this.#n.get(t.id);n&&(n.destroy(),this.#n.delete(t.id))}),e.receive("getElementsAtEvent",t=>this.#e(t.id).getElementsAtEvent(t)),e.receive("getDatalabelAtEvent",t=>this.#e(t.id).getDatalabelAtEvent(t))}#e(e){const t=this.#n.get(e);if(!t)throw new Error(`Could not find chart with id ${e}`);return t}}}}]);

//# sourceMappingURL=6750.0eb1c983b63ffd81860d.js.map