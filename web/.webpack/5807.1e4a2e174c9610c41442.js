"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[5807],{14571:(D,h,l)=>{l.d(h,{o:()=>g});var s=l(52322),o=l(2784);class g extends o.Component{state={hadError:!1};componentDidCatch(b){this.setState({hadError:!0}),this.props.onError(b)}render(){return this.state.hadError?(0,s.jsx)(s.Fragment,{}):this.props.children}}},96133:(D,h,l)=>{l.d(h,{J:()=>s});function s(o,g){if(typeof o.value=="object")throw new Error("filterMatches only works on paths where global variables have been filled in");if(o.value==null)return!1;let u=g;for(const b of o.path)if(typeof u!="object"||u==null||(u=u[b],u==null))return!1;return u!=null&&u==o.value}},62273:(D,h,l)=>{l.d(h,{T:()=>g});var s=l(49302),o=l(96133);function g(u,b){if(u.topic!==b.topicName)return[];const A=[];function v(p,M){const c=b.messagePath[M];if(c==null){A.push(p);return}if(p!=null)switch(c.type){case"slice":{if(!Array.isArray(p)&&!(0,s.f)(p))return;if(typeof c.start=="object"||typeof c.end=="object")throw new Error("Variables in slices are not supported");const{start:I,end:j}=c;for(let m=I;m<p.length&&m<=j;m++)v(p[m],M+1);return}case"filter":if(!(0,o.J)(c,p))return;v(p,M+1);return;case"name":if(typeof p!="object")return;v(p[c.name],M+1);return}}return v(u.message,0),A}},15807:(D,h,l)=>{l.r(h),l.d(h,{default:()=>q});var s=l(52322),o=l(2784),g=l(28316),u=l(75845),b=l(14571),A=l(75017),v=l(14123),p=l(88724),M=l(68434),c=l(76635),I=l(72970),j=l(1012),m=l(62273),L=l(93812),Q=l(77075),U=l(10363);function V(e,a){const t=typeof e=="object"?e.data:e;if(t!=null)for(const r of a){let n;try{if(typeof t=="boolean"||typeof t=="number"){if(n=JSON.parse(r.rawValue),typeof n!="boolean"&&typeof n!="number")continue}else typeof t=="string"?n=r.rawValue:typeof t=="bigint"?n=BigInt(r.rawValue):(0,U.v)(t,"Unsupported rule value")}catch{continue}if(r.operator==="="&&t===n)return r;if(r.operator==="<"&&t<n)return r;if(r.operator==="<="&&t<=n)return r;if(r.operator===">"&&t>n)return r;if(r.operator===">="&&t>=n)return r}}var Z=l(67067),x=l(5817),F=l.n(x);function K(e){return`data ${{"=":"=","<":"<","<=":"\u2264",">":">",">=":"\u2265"}[e.operator]} ${e.rawValue}`}function W(e,a){return(0,Z.Uy)(e,t=>{switch(a.action){case"perform-node-action":if(a.payload.path[0]==="rules"){if(a.payload.id==="delete-rule"){const r=+a.payload.path[1];t.rules.splice(r,1)}else if(a.payload.id==="add-rule"||a.payload.id==="add-rule-above"||a.payload.id==="add-rule-below"){let r=t.rules.length;a.payload.id==="add-rule-above"&&a.payload.path[1]!=="default"?r=+a.payload.path[1]:a.payload.id==="add-rule-below"&&(r=+a.payload.path[1]+1),t.rules.splice(r,0,{operator:"=",rawValue:"true",color:`#${Math.floor(Math.random()*16777216).toString(16)}`,label:"Label"})}else if(a.payload.id==="move-up"){const r=+a.payload.path[1],[n]=t.rules.splice(r,1);t.rules.splice(r-1,0,n)}else if(a.payload.id==="move-down"){const r=+a.payload.path[1],[n]=t.rules.splice(r,1);t.rules.splice(r+1,0,n)}}break;case"update":switch(a.payload.path[0]){case"general":(0,c.set)(t,[a.payload.path[1]],a.payload.value);break;case"rules":if(a.payload.path[1]==="default")(0,c.set)(t,[a.payload.path[2]],a.payload.value);else{const r=+a.payload.path[1];(0,c.set)(t.rules[r],[a.payload.path[2]],a.payload.value)}break;default:throw new Error(`Unexpected payload.path[0]: ${a.payload.path[0]}`)}break}})}const G=F()((e,a,t)=>{const r=[{type:"action",id:"delete-rule",label:"Delete rule",icon:"Delete"},a>0&&{type:"action",id:"move-up",label:"Move up",icon:"MoveUp"},a<t.length-1&&{type:"action",id:"move-down",label:"Move down",icon:"MoveDown"},{type:"action",id:"add-rule-above",label:"Add rule above",icon:"Add"},{type:"action",id:"add-rule-below",label:"Add rule below",icon:"Add"}];return{label:K(e),actions:r.filter(n=>n!==!1),fields:{operator:{label:"Comparison",input:"select",value:e.operator,options:[{label:"Equal to",value:"="},{label:"Less than",value:"<"},{label:"Less than or equal to",value:"<="},{label:"Greater than",value:">"},{label:"Greater than or equal to",value:">="}]},rawValue:{label:"Compare with",input:"string",value:e.rawValue},color:{label:"Color",input:"rgb",value:e.color},label:{label:"Label",input:"string",value:e.label}}}});function $(e,a,t){const{path:r,style:n,rules:d}=e,f=(0,o.useMemo)(()=>({error:t,fields:{path:{label:"Message path",input:"messagepath",value:r,error:a},style:{label:"Style",input:"select",value:n,options:[{label:"Bulb",value:"bulb"},{label:"Background",value:"background"}]}}}),[t,r,a,n]),{fallbackColor:i,fallbackLabel:E}=e,w=(0,o.useMemo)(()=>({label:"Rules (first matching rule wins)",actions:[{type:"action",id:"add-rule",label:"Add rule",icon:"Add"}],children:Object.fromEntries(d.map((S,P)=>[P.toString(),G(S,P,d)]).concat([["default",{label:"Otherwise",fields:{fallbackColor:{label:"Color",input:"rgb",value:i,help:"Color to use when no other rules match"},fallbackLabel:{label:"Label",input:"string",value:E,help:"Label to use when no other rules match"}},actions:[{type:"action",id:"add-rule-above",label:"Add rule above",icon:"Add"}]}]]))}),[i,E,d]);return(0,u.O4)({general:f,rules:w})}const z={path:"",style:"bulb",fallbackColor:"#a0a0a0",fallbackLabel:"False",rules:[{operator:"=",rawValue:"true",color:"#68e24a",label:"True"}]},H=(0,I.ZL)()({root:{width:40,height:40,borderRadius:"50%",position:"relative",backgroundImage:["radial-gradient(transparent, transparent 55%, rgba(255,255,255,0.4) 80%, rgba(255,255,255,0.4))","radial-gradient(circle at 38% 35%, rgba(255,255,255,0.8), transparent 30%, transparent)","radial-gradient(circle at 46% 44%, transparent, transparent 61%, rgba(0,0,0,0.7) 74%, rgba(0,0,0,0.7))"].join(",")}});function B(e){if(e.length<=1)return e[0];throw new Error("Message path produced multiple results")}function J(e,a){try{switch(a.type){case"frame":{if(e.pathParseError!=null)return{...e,latestMessage:(0,c.last)(a.messages),error:void 0};let t=e.latestMatchingQueriedData,r=e.latestMessage;if(e.parsedPath)for(const n of a.messages){if(n.topic!==e.parsedPath.topicName)continue;const d=B((0,m.T)(n,e.parsedPath));d!=null&&(t=d,r=n)}return{...e,latestMessage:r,latestMatchingQueriedData:t,error:void 0}}case"path":{const t=(0,j.ZP)(a.path);let r;t?.messagePath.some(f=>f.type==="filter"&&typeof f.value=="object"||f.type==="slice"&&(typeof f.start=="object"||typeof f.end=="object"))===!0&&(r="Message paths using variables are not currently supported");let n,d;try{n=t&&r==null&&e.latestMessage?B((0,m.T)(e.latestMessage,t)):void 0}catch(f){d=f}return{...e,path:a.path,parsedPath:t,latestMatchingQueriedData:n,error:d,pathParseError:r}}case"seek":return{...e,latestMessage:void 0,latestMatchingQueriedData:void 0,error:void 0}}}catch(t){return{...e,latestMatchingQueriedData:void 0,error:t}}}function Y({context:e}){const[a,t]=(0,o.useState)(()=>()=>{}),{classes:r,theme:{palette:{augmentColor:n}}}=H(),[d,f]=(0,o.useState)(()=>({...z,...e.initialState})),[i,E]=(0,o.useReducer)(J,d,({path:y})=>({path:y,parsedPath:(0,j.ZP)(y),latestMessage:void 0,latestMatchingQueriedData:void 0,pathParseError:void 0,error:void 0}));(0,o.useLayoutEffect)(()=>{E({type:"path",path:d.path})},[d.path]),(0,o.useEffect)(()=>{e.saveState(d),e.setDefaultPanelTitle(d.path===""?void 0:d.path)},[d,e]),(0,o.useEffect)(()=>(e.onRender=(y,k)=>{t(()=>k),y.didSeek===!0&&E({type:"seek"}),y.currentFrame&&E({type:"frame",messages:y.currentFrame})},e.watch("currentFrame"),e.watch("didSeek"),()=>{e.onRender=void 0}),[e]);const w=(0,o.useCallback)(y=>{f(k=>W(k,y))},[f]),S=$(d,i.pathParseError,i.error?.message);(0,o.useEffect)(()=>{e.updatePanelSettingsEditor({actionHandler:w,nodes:S})},[e,w,S]),(0,o.useEffect)(()=>(i.parsedPath?.topicName!=null&&e.subscribe([i.parsedPath.topicName]),()=>{e.unsubscribeAll()}),[e,i.parsedPath?.topicName]),(0,o.useEffect)(()=>{a()},[a]);const P=typeof i.latestMatchingQueriedData=="boolean"||typeof i.latestMatchingQueriedData=="bigint"||typeof i.latestMatchingQueriedData=="string"||typeof i.latestMatchingQueriedData=="number"?i.latestMatchingQueriedData:void 0,{style:R,rules:N,fallbackColor:T,fallbackLabel:_}=d,C=(0,o.useMemo)(()=>V(P,N),[P,N]);return(0,s.jsx)(L.Z,{fullHeight:!0,children:(0,s.jsx)(L.Z,{flexGrow:1,justifyContent:"space-around",alignItems:"center",overflow:"hidden",padding:1,style:{backgroundColor:R==="background"?C?.color??T:void 0},children:(0,s.jsxs)(L.Z,{direction:"row",alignItems:"center",gap:2,children:[R==="bulb"&&(0,s.jsx)("div",{className:r.root,style:{backgroundColor:C?.color??T}}),(0,s.jsx)(M.Z,{color:R==="background"?n({color:{main:C?.color??T}}).contrastText:C?.color??T,fontFamily:Q.R.MONOSPACE,variant:"h1",whiteSpace:"pre",children:C?.label??_})]})})})}function X(e,a){return g.render((0,s.jsx)(o.StrictMode,{children:(0,s.jsx)(b.o,{onError:e,children:(0,s.jsx)(p.Z,{isDark:!0,children:(0,s.jsx)(Y,{context:a})})})}),a.panelElement),()=>{g.unmountComponentAtNode(a.panelElement)}}function O(e){const a=(0,u.iY)(),t=(0,o.useMemo)(()=>X.bind(void 0,a),[a]);return(0,s.jsx)(v._,{config:e.config,saveConfig:e.saveConfig,initPanel:t,highestSupportedConfigVersion:1})}O.panelType="Indicator",O.defaultConfig={};const q=(0,A.Z)(O)},49302:(D,h,l)=>{l.d(h,{f:()=>g});var s=l(76635),o=l.n(s);function g(u){return(0,s.isTypedArray)(u)}}}]);

//# sourceMappingURL=5807.1e4a2e174c9610c41442.js.map